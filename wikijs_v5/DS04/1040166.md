## Basic Information

| Key           | Value                                                                                            |
| ------------- | ------------------------------------------------------------------------------------------------ |
| Table         | DS04 Schedule                                                                                    |
| Severity      | WARNING                                                                                          |
| Unique ID     | 1040166                                                                                          |
| Summary       | Does this FC task along the Driving Path have an Actual Finish earlier than the BL Early Finish? |
| Error message | FC AF_date < BL EF_date where driving_path = Y (compare by task_ID & subproject_ID).             |

## What causes this error?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
> {.is-warning}

The Data Integrity and Quality (DIQ) check titled "Actual Finish Prior to Early Finish Along the Driving Path" is designed to ensure the accuracy and consistency of the data in the DS04 Schedule table. This check specifically focuses on tasks along the driving path, which are critical tasks that directly impact the project timeline.

The DIQ check is looking for instances where the Actual Finish (AF) date of a task is earlier than the Baseline Early Finish (BL EF) date. In other words, it's checking if a task was completed before it was initially planned to be finished. This is identified by comparing the AF_date and EF_date fields for each task_ID in the DS04 Schedule table.

If the DIQ check identifies tasks where the AF_date is earlier than the EF_date, this could indicate a potential data entry error or a significant change in the project schedule that was not properly updated in the baseline schedule. The expected values for this check would be that the AF_date should be equal to or later than the EF_date for all tasks along the driving path.

Please review any tasks identified by this DIQ check to ensure the accuracy of the AF_date and EF_date values. If necessary, update the project schedule to reflect the correct dates.

## Why do we check this?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
> {.is-warning}

This test is being performed on the 'DS04 Schedule' table to check if any fully complete (FC) tasks along the driving path have an actual finish date that is earlier than the baseline early finish date. The driving path refers to the sequence of activities that determines the shortest time to complete the project.

The importance of this check is to ensure that the project schedule is being adhered to and that tasks are not being completed earlier than planned. This could potentially indicate issues with project planning or execution. For instance, tasks being completed too early might suggest that the initial time estimates were too conservative, or that resources are not being utilized efficiently.

The severity of this check is classified as a 'WARNING', which means that while it may not prevent the data from being reviewed, it could cause problems during analysis. For example, it could lead to inaccurate projections of project completion time or misallocation of resources. Therefore, it's important to address this issue to ensure accurate and reliable project management data.

## Code

```sql

CREATE FUNCTION [dbo].[fnDIQ_DS04_Sched_IsDPAFDateEarlierThanEFDate] (
	@upload_id int = 0
)
RETURNS TABLE
AS RETURN
(
	with BLDPTask as (
		SELECT task_ID, EF_Date, ISNULL(subproject_ID,'') SubP
		FROM DS04_schedule
		WHERE upload_ID = @upload_ID AND schedule_type = 'BL' AND driving_path = 'Y'
	)
	SELECT
		F.*
	FROM
		DS04_schedule F INNER JOIN BLDPTask B ON F.task_ID = B.task_ID
											 AND ISNULL(F.subproject_ID,'') = B.SubP
											 AND F.AF_date < B.EF_date
	WHERE
			F.upload_id = @upload_ID
		AND F.schedule_type = 'FC'
)
```

### Changelog

| Date       | Description of Changes                                               |
| ---------- | -------------------------------------------------------------------- |
| 2024-04-30 | Logic adjusted to account for the addition of 'subproject_id' field. |
