## Basic Information
| Key         | Value          |
|-------------|----------------|
| Table       | DS04 Schedule |
| Severity    | WARNING |
| Unique ID   | 9040224   |
| Summary     | Is this WBS Summary resource-loaded? |
| Error message | WBS Summary task (task_ID where type = WS) was found in the resources dataset (DS06.task_ID). |

## What causes this error?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
{.is-warning}

The Data Integrity and Quality (DIQ) check titled "WBS Summary With Resources" is designed to verify whether the Work Breakdown Structure (WBS) Summary task is resource-loaded. This check is performed on the DS04 Schedule table.

An error message will be generated if a WBS Summary task (identified by a task_ID where type = 'WS') is found in the DS06 Schedule Resources dataset. This is because a WBS Summary task should not be resource-loaded, as it is a high-level summary of work and not a specific task that requires resources.

The fields causing the issue are the 'task_ID' and 'type' fields in the DS04 Schedule table and the 'task_ID' field in the DS06 Schedule Resources table. The 'type' field in the DS04 Schedule table should not have a value of 'WS' (indicating a WBS Summary task) for any task_ID that is also found in the DS06 Schedule Resources table.

To resolve this issue, review the tasks in the DS04 Schedule table and ensure that any WBS Summary tasks are not also listed in the DS06 Schedule Resources table. If they are, remove the resources assigned to these tasks in the DS06 table.
## Why do we check this?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
{.is-warning}

This test is being performed to check if the Work Breakdown Structure (WBS) Summary task is resource-loaded. In project management, a WBS Summary task is a task that summarizes the progress of all its subtasks. It is not typically resource-loaded, meaning it doesn't have resources directly assigned to it. Instead, resources are assigned to the individual subtasks. 

The test is checking for instances where a WBS Summary task has been found in the resources dataset, which could indicate that resources have been directly assigned to the summary task. This is flagged as a WARNING because it could cause problems during analysis. For example, it could lead to double-counting of resources if both the summary task and its subtasks are included in resource calculations.

The importance of this check is to ensure the accuracy and integrity of resource allocation data in the EVMS construction project management data. It helps to prevent potential errors in resource planning and allocation, which could impact project timelines and budgets.
## Code

```sql
CREATE FUNCTION [dbo].[fnDIQ_DS04_Sched_IsWBSSummaryResourceLoaded] (
	@upload_id int = 0
)
RETURNS TABLE
AS RETURN
(
	with Rsrcs as (
		SELECT task_ID, schedule_type, ISNULL(subproject_ID,'') SubP
		FROM DS06_schedule_resources 
		WHERE upload_ID = @upload_ID
	)
	SELECT
		S.*
	FROM
		DS04_schedule S INNER JOIN Rsrcs R 	ON S.task_ID = R.task_ID 
											AND S.schedule_type = R.schedule_type
											AND ISNULL(S.subproject_ID,'') = R.SubP
	WHERE
			upload_id = @upload_ID
		AND type = 'WS'
)
```

### Changelog

| Date       | Description of Changes   |
| ---------- | ------------------------ |
| 2024-04-30 | Logic adjusted to account for the addition of subproject_id field. |
