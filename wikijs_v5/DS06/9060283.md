## Basic Information

| Key           | Value                                                                                                                     |
| ------------- | ------------------------------------------------------------------------------------------------------------------------- |
| Table         | DS06 Resources                                                                                                            |
| Severity      | WARNING                                                                                                                   |
| Unique ID     | 9060283                                                                                                                   |
| Summary       | Is this WBS of type CA or WBS resource loaded?                                                                            |
| Error message | WBS ID of type CA or WBS (DS01.type = CA or WBS) found with resources (task_ID found in DS06.task_ID list by subproject). |

## What causes this error?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
> {.is-warning}

The Data Integrity and Quality (DIQ) check titled "Resource Loaded CA or WBS" is designed to verify the integrity of the data in the DS06 Resources table. This check specifically focuses on whether the Work Breakdown Structure (WBS) of type Control Account (CA) or WBS is resource loaded.

An error message will be generated if a WBS ID of type CA or WBS is found with resources. This means that there are tasks associated with the WBS ID in the DS06 Resources table. The fields causing the issue are the WBS_ID and task_ID fields in the DS06 Resources table and the type field in the DS01 WBS table.

The expected values for the type field in the DS01 WBS table are either 'CA' or 'WBS'. If these values are found, the WBS ID should not have any associated tasks in the DS06 Resources table. If tasks are found, this indicates that the WBS ID is resource loaded, which is not expected for WBS IDs of type CA or WBS.

To resolve this issue, review the data in the DS06 Resources table and the DS01 WBS table. Ensure that WBS IDs of type CA or WBS do not have associated tasks in the DS06 Resources table.

## Why do we check this?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
> {.is-warning}

This test is being performed to ensure that the Work Breakdown Structure (WBS) of type Control Account (CA) or WBS is resource-loaded. In project management, resource loading refers to the allocation of resources (like labor, materials, etc.) to specific tasks or activities. The test checks if there are any resources assigned to the WBS ID of type CA or WBS.

The importance of this check is to ensure that resources are properly allocated to the tasks or activities in the project. If a WBS of type CA or WBS is not resource-loaded, it could lead to inefficiencies in project execution, as resources are a critical component of any project.

The severity of this check is marked as a WARNING. This means that while it may not prevent the data from being reviewed, it could potentially cause problems during the analysis of the project data. It is therefore important to address this issue to ensure accurate and efficient project management and analysis.

## Code

```sql

CREATE FUNCTION [dbo].[fnDIQ_DS06_Res_IsCAOrWBSResourceLoaded] (
	@upload_id int = 0
)
RETURNS TABLE
AS RETURN
(
	with Task as (
		SELECT WBS_ID, task_ID, schedule_type, ISNULL(subproject_ID,'') SubP
		FROM DS04_schedule
		WHERE upload_ID = @upload_ID AND WBS_ID IN (SELECT WBS_ID FROM DS01_WBS WHERE upload_ID = @upload_id AND type IN ('CA','WBS'))
	)
	SELECT R.*
	FROM DS06_schedule_resources R INNER JOIN Task T ON R.task_ID = T.task_ID AND R.schedule_type = T.schedule_type AND ISNULL(R.subproject_ID,'') = T.SubP
	WHERE upload_id = @upload_ID
)
```

### Changelog

| Date       | Description of Changes                                                                              |
| ---------- | --------------------------------------------------------------------------------------------------- |
| 2024-04-30 | 1. Logic adjusted to account for addition of subproject_id field. 2. Logic adjusted for simplicity. |
