## Basic Information

| Key           | Value                                                                            |
| ------------- | -------------------------------------------------------------------------------- |
| Table         | DS18 Sched EU                                                                    |
| Severity      | ALERT                                                                            |
| Unique ID     | 9180591                                                                          |
| Summary       | Is this schedule EU task missing in its respective schedule?                     |
| Error message | task_ID not in DS04.task_ID list (by schedule_type, task_ID, and subproject_ID). |

## What causes this error?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
> {.is-warning}

The Data Integrity and Quality (DIQ) check titled "Schedule EU Task Missing in Schedule" is designed to verify the consistency of task IDs between two datasets: DS18 Sched EU and DS04 Schedule.

The test is checking whether a task ID that is present in the DS18 Sched EU dataset is missing from the DS04 Schedule dataset. The test is performed by comparing the task IDs in both datasets for each schedule type.

If the test returns an error, it means that there are one or more task IDs in the DS18 Sched EU dataset that are not found in the DS04 Schedule dataset. This discrepancy could be due to a data entry error, a missing update in one of the datasets, or an issue with the data import process.

To resolve this issue, you should ensure that all task IDs in the DS18 Sched EU dataset have corresponding entries in the DS04 Schedule dataset. The task IDs should be consistent across all schedule types.

## Why do we check this?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
> {.is-warning}

This test is being performed to ensure that all tasks in the 'DS18 Sched EU' table are also present in the 'DS04' table. The test checks for data consistency across different tables, specifically between the 'DS18 Sched EU' and 'DS04' tables.

The importance of this check is to ensure that all tasks are properly tracked and accounted for in all relevant tables. If a task is missing in one table, it could lead to incomplete or inaccurate project management data, which could in turn affect project planning, tracking, and decision-making processes.

The severity of this test is marked as 'ALERT', which means that while it may not immediately prevent data from being reviewed, it could potentially cause minor problems or indicate that the data does not adhere to all best practices. Therefore, it is recommended to address this issue to maintain the integrity and quality of the EVMS construction project management data.

## Code

```sql
CREATE FUNCTION [dbo].[fnDIQ_DS18_Sched_EU_IsTaskIDMissingInDS04] (
	@upload_id int = 0
)
RETURNS TABLE
AS RETURN
(
	SELECT E.*
	FROM DS18_schedule_EU E LEFT OUTER JOIN DS04_schedule S ON E.task_ID = S.task_ID
															AND E.schedule_type = S.schedule_type
															AND ISNULL(E.subproject_ID,'') = ISNULL(S.subproject_ID,'')
	WHERE
			E.upload_ID = @upload_ID
		AND S.upload_ID = @upload_ID
		AND S.task_ID IS NULL
)
```

### Changelog

| Date       | Description of Changes                                             |
| ---------- | ------------------------------------------------------------------ |
| 2024-04-30 | Logic adjusted to account for the addition of subproject_id field. |
