## Basic Information
| Key         | Value          |
|-------------|----------------|
| Table       | DS07 IPMR Header |
| Severity    | WARNING |
| Unique ID   | 1070383   |
| Summary     | Are the UB dollars negative? |
| Error message | UB_bgt_dollars < 0. |

## What causes this error?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
{.is-warning}

The Data Integrity and Quality (DIQ) check titled "Negative UB (Dollars)" is designed to identify any instances where the Undistributed Budget (UB) in dollars is recorded as a negative value in the DS07 IPMR Header table. 

The UB in dollars should always be a positive value or zero, as it represents the amount of budget that has not yet been allocated to specific tasks or work packages. A negative value in this field could indicate an error in data entry or budget calculation.

If this DIQ check identifies any records where the UB in dollars is negative (i.e., UB_bgt_dollars < 0), it will flag these records for review. The likely cause of this error is incorrect data entry or calculation in the UB_bgt_dollars field. 

To resolve this issue, review the flagged records and correct the UB in dollars to ensure it is a positive value or zero.
## Why do we check this?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
{.is-warning}

This test is being performed on the 'DS07 IPMR Header' table to check if the Undistributed Budget (UB) in dollars is negative. The Undistributed Budget refers to the amount of budget that has not yet been allocated to specific tasks or work packages. It is crucial that this value is not negative, as it would imply that more budget has been allocated than is available, which is not a feasible scenario in project management.

The severity of this test is marked as 'WARNING', which means that while it may not prevent the data from being reviewed, it is likely to cause problems during analysis. Negative UB values could lead to inaccurate budget forecasts, incorrect financial reporting, and potential mismanagement of resources. Therefore, it is important to address this issue to ensure the accuracy and reliability of the project management data.
## Code

```sql

CREATE FUNCTION [dbo].[fnDIQ_DS07_IPMR_IsUBBgtDollarsNegative] (
	@upload_id int = 0
)
RETURNS TABLE
AS RETURN
(
	
	SELECT 
		*
	FROM
		DS07_IPMR_header
	WHERE
			upload_ID = @upload_ID
		AND UB_bgt_Dollars < 0
)
```
