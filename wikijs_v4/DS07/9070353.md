## Basic Information
| Key         | Value          |
|-------------|----------------|
| Table       | DS07 IPMR Header |
| Severity    | ALERT |
| Unique ID   | 9070353   |
| Summary     | Is the PM EAC Worst date later than the CD-4 milestone date? |
| Error message | EAC_PM_worst_date > DS04.EF_date where milestone_level = 190 (FC only). |

## What causes this error?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
{.is-warning}

The Data Integrity and Quality (DIQ) check titled "PM EAC Worst Date Later Than CD-4" is designed to ensure that the Project Manager's Estimated At Completion (EAC) worst date is not later than the CD-4 milestone date. This check is performed on the data in the DS07 IPMR Header table.

If an error is flagged by this DIQ check, it indicates that the EAC_PM_worst_date field in the DS07 IPMR Header table contains a date that is later than the earliest EF_date in the DS04 Schedule table where the milestone_level is 190 and the schedule_type is 'FC'. 

The EAC_PM_worst_date field should ideally contain a date that is earlier than or equal to the CD-4 milestone date. The CD-4 milestone, represented by milestone_level 190 in the DS04 Schedule table, is a critical project completion milestone, and the EAC_PM_worst_date should not exceed this date.

To resolve this issue, review the dates in the EAC_PM_worst_date field in the DS07 IPMR Header table and the EF_date field in the DS04 Schedule table. Ensure that the EAC_PM_worst_date is not later than the CD-4 milestone date.
## Why do we check this?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
{.is-warning}

This test is being performed to ensure that the Project Manager's (PM) Estimated At Completion (EAC) Worst date is not later than the Critical Decision-4 (CD-4) milestone date. The CD-4 milestone represents the project completion date, and the PM's EAC Worst date should ideally be before this date. If the EAC Worst date is later, it indicates that the project is expected to be completed later than planned, which could lead to potential delays and cost overruns.

The importance of this check is to alert the project management team about potential schedule slippages. It allows them to take corrective actions in a timely manner to ensure that the project is completed within the planned schedule. This check is classified as an ALERT, which means it is less severe but still indicates that there might be minor problems or that the data doesn't follow all best practices. It is crucial to address these alerts to maintain the integrity and quality of the project management data.
## Code

```sql

CREATE FUNCTION [dbo].[fnDIQ_DS07_IPMR_IsEACPMWorstDateAfterCD4] (
	@upload_id int = 0
)
RETURNS TABLE
AS RETURN
(
	
	SELECT 
		*
	FROM
		DS07_IPMR_header
	WHERE
			upload_ID = @upload_ID
		AND EAC_PM_worst_date > (
			SELECT MIN(EF_date)
			FROM DS04_schedule
			WHERE upload_ID = @upload_ID AND schedule_type = 'FC' and milestone_level = 190
		)
)
```
