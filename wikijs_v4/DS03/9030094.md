## Basic Information
| Key         | Value          |
|-------------|----------------|
| Table       | DS03 Cost |
| Severity    | WARNING |
| Unique ID   | 9030094   |
| Summary     | Does this SLPP, PP, or WP have only Overhead EOCs? |
| Error message | SLPP, PP, or WP with only Overhead. |

## What causes this error?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
{.is-warning}

The Data Integrity and Quality (DIQ) check titled "Overhead Not Mingled With Other EOCs" is designed to ensure that each SLPP, PP, or WP (Work Breakdown Structure identifiers) only contains Overhead EOCs (Element of Cost). This check is performed on the DS03 Cost table.

If an error is flagged by this DIQ check, it indicates that there are SLPP, PP, or WP entries that contain EOCs other than 'Overhead'. This is not expected as per the defined rules for the DS03 Cost table. 

The fields causing this issue are 'WBS_ID_CA', 'WBS_ID_WP', and 'EOC'. The 'WBS_ID_CA' and 'WBS_ID_WP' fields represent the Work Breakdown Structure identifiers for Cost Account and Work Package respectively. The 'EOC' field represents the Element of Cost. 

The expected values for these fields are as follows: 
- For 'WBS_ID_CA' and 'WBS_ID_WP', the values should correspond to valid identifiers for Cost Account and Work Package respectively. 
- For 'EOC', the value should be 'Overhead' for all entries associated with a given 'WBS_ID_CA' or 'WBS_ID_WP'. 

If the DIQ check flags an error, it suggests that there are entries in the 'EOC' field that are not 'Overhead' for a given 'WBS_ID_CA' or 'WBS_ID_WP'. This needs to be corrected to maintain data integrity and quality.
## Why do we check this?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
{.is-warning}

This test is being performed on the 'DS03 Cost' table to ensure that the specific SLPP, PP, or WP (work packages) only contain Overhead EOCs (Elements of Cost). The purpose of this check is to maintain the integrity of the cost data by ensuring that overhead costs are not mixed with other types of costs within the same work package. This is important because mixing different types of costs can lead to inaccurate cost reporting and analysis, which can in turn affect project management decisions and the overall success of the project.

The severity of this test is marked as 'WARNING', which means that while it may not prevent the data from being reviewed, it is likely to cause problems during analysis if not addressed. Therefore, it is crucial to correct this issue to ensure accurate and reliable cost analysis and reporting.
## Code

```sql

CREATE FUNCTION [dbo].[fnDIQ_DS03_Cost_IsOverheadWorkMissingOtherEOCTypes] (
	@upload_id int = 0
)
RETURNS TABLE
AS RETURN
(
	
	with NonOverhead AS (
		SELECT WBS_ID_CA CAID, ISNULL(WBS_ID_WP,'') WPID
		FROM DS03_cost
		WHERE upload_ID = @upload_ID AND EOC <> 'Overhead'
		GROUP BY WBS_ID_CA, WBS_ID_WP
	), WBS as (
		SELECT WBS_ID, type
		FROM DS01_WBS
		WHERE upload_ID = @upload_ID
	)
	
	SELECT 
		C.* 
	FROM 
		DS03_Cost C LEFT OUTER JOIN NonOverhead N 	ON C.WBS_ID_CA = N.CAID 
													AND ISNULL(C.WBS_ID_WP,'') = N.WPID
	WHERE
			upload_ID = @upload_ID
		AND EOC = 'Overhead'
		AND N.CAID IS NULL
		AND (
			WBS_ID_WP IN (SELECT WBS_ID FROM WBS WHERE type IN ('WP','PP')) OR
			WBS_ID_CA IN (SELECT WBS_ID FROM WBS WHERE type = 'SLPP')
		)
)
```
