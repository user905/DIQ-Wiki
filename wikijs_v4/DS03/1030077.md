## Basic Information
| Key         | Value          |
|-------------|----------------|
| Table       | DS03 Cost |
| Severity    | ERROR |
| Unique ID   | 1030077   |
| Summary     | Is the WBS ID to which this work is apportioned missing? |
| Error message | EVT = J or M but EVT_J_to_WBS_ID is missing. |

## What causes this error?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
{.is-warning}

The Data Integrity and Quality (DIQ) check titled "Apportioned To WBS ID Missing" is designed to verify the presence of a Work Breakdown Structure (WBS) ID in the DS03 Cost table. This check is particularly important when the Event Type (EVT) is either 'J' or 'M'. 

The WBS ID is a crucial piece of information that identifies the specific work package to which costs are apportioned. If the WBS ID is missing, it can lead to inaccuracies in cost allocation and tracking, which can in turn affect the overall project management and financial reporting.

The error message "EVT = J or M but EVT_J_to_WBS_ID is missing" indicates that there are records in the DS03 Cost table where the EVT is either 'J' or 'M', but the corresponding WBS ID (EVT_J_to_WBS_ID) is missing. This is likely due to incomplete data entry or a data import error.

To resolve this issue, ensure that every record in the DS03 Cost table with an EVT of 'J' or 'M' also includes a valid WBS ID in the EVT_J_to_WBS_ID field.
## Why do we check this?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
{.is-warning}

This test is being performed to ensure that the Work Breakdown Structure (WBS) ID, which is crucial for tracking and managing the cost of individual tasks in the EVMS construction project, is not missing in the 'DS03 Cost' table. The test checks if the Event Type (EVT) is either 'J' or 'M', but the corresponding WBS ID to which the work is apportioned is missing. 

The importance of this check lies in the fact that without the WBS ID, it would be impossible to accurately track, manage, and apportion costs to specific tasks within the project. This could lead to mismanagement of resources, inaccurate cost reporting, and potential project overruns. 

The severity of this issue is marked as 'ERROR', which is the highest level of severity. This means that this issue must be fixed before the data can be reviewed or used for further analysis. If not addressed, it could lead to significant problems in project management and financial reporting.
## Code

```sql

CREATE FUNCTION [dbo].[fnDIQ_DS03_Cost_IsApportionedToIDMissing] (
	@upload_id int = 0
)
RETURNS TABLE
AS RETURN
(
	SELECT 
		* 
	FROM 
		DS03_Cost
	WHERE
			upload_ID = @upload_ID
		AND	EVT IN ('J','M')
		AND TRIM(ISNULL(EVT_J_to_WBS_ID,''))=''
)
```
