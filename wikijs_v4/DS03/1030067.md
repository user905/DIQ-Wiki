## Basic Information
| Key         | Value          |
|-------------|----------------|
| Table       | DS03 Cost |
| Severity    | WARNING |
| Unique ID   | 1030067   |
| Summary     | Is there a delta between BCWS and BCWP for this LOE work? |
| Error message | BCWSi <> BCWPi for LOE work (Dollar, Hours, or FTEs). |

## What causes this error?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
{.is-warning}

The Data Integrity and Quality (DIQ) check titled "BCWSi <> BCWPi for LOE" is designed to identify any discrepancies between the Budgeted Cost of Work Scheduled (BCWSi) and the Budgeted Cost of Work Performed (BCWPi) for Level of Effort (LOE) work in the DS03 Cost table. 

The check is performed at the End of Contract (EOC) level and looks for differences in dollars, hours, or Full-Time Equivalents (FTEs). The thresholds for triggering an error are a difference of $100 or 1 hour. There is no threshold for FTEs, meaning any discrepancy will trigger an error.

If an error is triggered, it means there is a discrepancy between the planned and actual costs for LOE work. This could be due to incorrect data entry, changes in the work schedule, or changes in the cost of work. 

The fields causing the issue are BCWSi (Budgeted Cost of Work Scheduled) and BCWPi (Budgeted Cost of Work Performed). The expected values for these fields should be equal for LOE work. If they are not, it indicates a discrepancy between the planned and actual costs. 

Please review the data in these fields and correct any discrepancies to ensure data integrity and quality.
## Why do we check this?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
{.is-warning}

This test is being performed to check for discrepancies between the Budgeted Cost of Work Scheduled (BCWS) and the Budgeted Cost of Work Performed (BCWP) for Level of Effort (LOE) work in the DS03 Cost table. The BCWS and BCWP should ideally be equal for LOE work, as this type of work is typically budgeted and performed at a constant rate. 

The importance of this check is to ensure that the project is on track financially and that the budgeted cost aligns with the actual work performed. If there is a significant difference between BCWS and BCWP, it could indicate that the project is either over budget or under budget, which could lead to financial mismanagement and inaccurate project forecasting.

The severity of this check is marked as a WARNING, which means that while it may not prevent the data from being reviewed, it could potentially cause problems during analysis. It is crucial to address this issue to ensure accurate financial tracking and project management.
## Code

```sql

CREATE FUNCTION [dbo].[fnDIQ_DS03_Cost_DoesPneqSForLOE] (
	@upload_id int = 0
)
RETURNS TABLE
AS RETURN
(
	--DIQ checks for deltas between S & P hours/ftes/dollars at the EOC level.
	--Thresholds: $100 or 1 hour. No threshold for FTEs
	--DIQ uses CostRollupByEOC_Get to analyze at the EOC level, rather than at EVT.
	SELECT 
		C.* 
	FROM 
		DS03_Cost C INNER JOIN CostRollupByEOC_Get(@upload_ID) R ON C.period_date = R.period_date 
																 AND C.WBS_ID_CA = R.WBS_ID_CA
																 AND ISNULL(C.WBS_ID_WP,'') = R.WBS_ID_WP
																 AND C.EOC = R.EOC
	WHERE 
			upload_ID = @upload_ID
		AND C.period_date < CPP_status_date
		AND EVT = 'A'
		AND (
			ABS(R.BCWSi_dollars - R.BCWPi_dollars) > 100 OR
			R.BCWSi_FTEs <> R.BCWPi_FTEs OR
			ABS(R.BCWSi_hours - R.BCWPi_hours) > 1
		)
)
```
