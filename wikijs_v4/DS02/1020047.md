## Basic Information
| Key         | Value          |
|-------------|----------------|
| Table       | DS02 OBS |
| Severity    | ERROR |
| Unique ID   | 1020047   |
| Summary     | Is the root of the OBS hierarchy (Level 1) unique? |
| Error message | OBS hierarchy contains more than one Level 1 OBS element. |

## What causes this error?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
{.is-warning}

The Data Integrity and Quality (DIQ) check titled "Root of OBS Not Unique" is designed to ensure that the root of the Organizational Breakdown Structure (OBS) hierarchy, also known as Level 1, is unique within the DS02 OBS table. 

The error message "OBS hierarchy contains more than one Level 1 OBS element" indicates that there is more than one entry at Level 1 in the OBS hierarchy. This is likely caused by an error in data entry or import, where multiple elements have been incorrectly assigned to Level 1.

The fields causing this issue are the 'Level' field, which should only contain a single entry at Level 1, and the 'OBS' field, which should contain unique entries for each level of the hierarchy.

To resolve this issue, review the data in the DS02 OBS table to ensure that only one element is assigned to Level 1 and that each OBS element is unique.
## Why do we check this?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
{.is-warning}

This test is being performed to ensure that the root of the Organizational Breakdown Structure (OBS) hierarchy is unique. The OBS is a hierarchical arrangement of a project's management structure, and it is crucial for it to have a unique root (Level 1) to avoid confusion and maintain a clear chain of command and responsibility. 

The severity of this test is marked as 'ERROR', which is the highest level of severity. This means that if the OBS hierarchy contains more than one Level 1 OBS element, it is a critical issue that must be fixed before the data can be reviewed. 

The importance of this check lies in maintaining the integrity and clarity of the project's management structure. Having more than one root in the OBS hierarchy could lead to confusion, miscommunication, and inefficiency in project management. It could also cause problems during data analysis, as it might not be clear which root element should be used for certain calculations or decisions. Therefore, ensuring the uniqueness of the OBS root is crucial for the successful management and analysis of the project.
## Code

```sql

CREATE FUNCTION [dbo].[fnDIQ_DS02_OBS_IsOBSRootRepeated] (
	@upload_id int = 0
)
RETURNS TABLE
AS RETURN
(
    SELECT	*
    FROM	DS02_OBS
    WHERE	upload_ID = @upload_id
			AND [Level] = 1
			AND (
					SELECT	COUNT(*)
					FROM	DS02_OBS
					WHERE	upload_ID = @upload_id
							AND [Level] = 1
				) > 1
)
```
