## Basic Information
| Key         | Value          |
|-------------|----------------|
| Table       | DS06 Resources |
| Severity    | WARNING |
| Unique ID   | 9060300   |
| Summary     | Is this resource scheduled to start before its parent task? |
| Error message | Start_date < DS04.ES_date (by task_ID; BL schedule only). |

## What causes this error?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
{.is-warning}

The Data Integrity and Quality (DIQ) check titled "Resource Starting Earlier Than Task" is designed to ensure that no resource in the DS06 Resources table is scheduled to start before its associated task in the DS04 Schedule table. 

The error is likely to occur when the 'start_date' of a resource in the DS06 Resources table is earlier than the 'ES_date' (Earliest Start date) of its corresponding task in the DS04 Schedule table. This is checked by comparing the 'start_date' of each resource with the 'ES_date' of its parent task, identified by the 'task_ID'. This check is only applicable to the baseline (BL) schedule.

If this error occurs, it suggests that there may be a scheduling issue, as resources should not be scheduled to start before the tasks they are assigned to. The expected values for the 'start_date' in the DS06 Resources table should be the same or later than the 'ES_date' in the DS04 Schedule table for the corresponding 'task_ID'. 

To resolve this issue, review the scheduling of resources and tasks in the DS06 Resources and DS04 Schedule tables respectively, ensuring that no resource is scheduled to start before its parent task.
## Why do we check this?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
{.is-warning}

This test is being performed to ensure that the scheduling of resources aligns with the scheduling of tasks in the DS06 Resources table. Specifically, it checks if a resource is scheduled to start before its parent task, which could lead to inefficiencies or misallocation of resources. 

The importance of this check lies in the proper management and utilization of resources. If a resource is scheduled to start before its parent task, it could lead to unnecessary costs or idle resources. This could also disrupt the overall project timeline and lead to delays in other tasks. 

The severity of this check is marked as a WARNING. This means that while it may not prevent the data from being reviewed, it is likely to cause problems during analysis. It is crucial to address this issue to ensure accurate project management and efficient resource allocation.
## Code

```sql

CREATE FUNCTION [dbo].[fnDIQ_DS06_Res_IsStartDateEarlierThanDS04ESDate] (
	@upload_id int = 0
)
RETURNS TABLE
AS RETURN
(
	
	with BLTasks as (
		SELECT task_ID, ES_date 
		FROM DS04_schedule 
		WHERE upload_ID = @upload_ID AND schedule_type = 'BL'
	)
	SELECT
		R.*
	FROM
		DS06_schedule_resources R INNER JOIN BLTasks S ON R.task_ID = S.task_ID
	WHERE
			R.upload_id = @upload_ID
		AND R.schedule_type = 'BL'
		AND R.start_date < S.ES_date
)
```
