## Basic Information
| Key         | Value          |
|-------------|----------------|
| Table       | DS01 WBS |
| Severity    | WARNING |
| Unique ID   | 1010006   |
| Summary     | Was more than one unique OBS_ID used across the WBS? |
| Error message | Only a single OBS_ID found for all WBS Elements; more than one OBS ID is required across the WBS hierarchy |

## What causes this error?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
{.is-warning}

The Data Integrity and Quality (DIQ) check titled "Single OBS Across WBS Hierarchy" is designed to ensure that there is more than one unique OBS_ID used across the Work Breakdown Structure (WBS) in the DS01 WBS table. 

The error message "Only a single OBS_ID found for all WBS Elements; more than one OBS ID is required across the WBS hierarchy" indicates that the DIQ check has found only one unique OBS_ID across all WBS elements. This is not expected as the WBS hierarchy should ideally have more than one unique OBS_ID.

The issue is likely caused by the OBS_ID field in the DS01 WBS table. This field should contain distinct values to represent different organizational breakdown structures. If only one unique OBS_ID is found, it suggests that the data may not have been entered correctly or that there is a lack of diversity in the organizational breakdown structures represented in the data.

To resolve this issue, ensure that the OBS_ID field in the DS01 WBS table contains more than one unique value. This will help to accurately represent the variety of organizational breakdown structures in the project management data.
## Why do we check this?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
{.is-warning}

This test is being performed to ensure that there is more than one unique OBS_ID used across the Work Breakdown Structure (WBS) in the DS01 WBS table. The test is checking for data integrity and quality by verifying that there is not just a single OBS_ID for all WBS elements. 

The importance of this check is to ensure that the data is correctly distributed across the WBS hierarchy. If only one OBS_ID is used for all WBS elements, it could indicate a problem with the data input or structure, which could lead to inaccurate project management data and potentially flawed decision-making. 

The severity of this test is marked as a WARNING. This means that while it may not prevent the data from being reviewed, it is likely to cause problems during analysis. It is crucial to address this issue to ensure accurate and reliable data analysis and project management.
## Code

```sql

CREATE FUNCTION [dbo].[fnDIQ_DS01_WBS_DoesOnlyOneOBSIdExistAcrossWBS] (
	@upload_id int = 0
)
RETURNS TABLE
AS RETURN
(
	--tests for a distinct count of all OBS_IDs 
	--test treats nulls the same as blanks and excludes both (a separate test exists for OBS_ID = null/blank)
	--returns only one error at the Level 1 WBS, instead of an error on each line.
    SELECT	
        *
    FROM	
        DummyRow_Get(@upload_id)
    WHERE (SELECT COUNT(DISTINCT OBS_ID) FROM DS01_WBS WHERE upload_ID = @upload_id AND TRIM(ISNULL(OBS_ID, '')) <> '') = 1
)
```
