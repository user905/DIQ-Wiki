## Basic Information
| Key         | Value          |
|-------------|----------------|
| Table       | DS01 WBS |
| Severity    | WARNING |
| Unique ID   | 9010002   |
| Summary     | Is this WP / PP missing a WAD? |
| Error message | WBS_ID not in DS08.WBS_ID_WP list. |

## What causes this error?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
{.is-warning}

The Data Integrity and Quality (DIQ) check titled "WP / PP Missing WAD" is designed to identify any Work Packages (WP) or Planning Packages (PP) in the DS01 WBS table that are missing a Work Authorization Document (WAD). 

The error message "WBS_ID not in DS08.WBS_ID_WP list" indicates that there are entries in the DS01 WBS table where the WBS_ID is not found in the list of WBS_ID_WP in the DS08 WAD table. This suggests that there are WP or PP that do not have an associated WAD, which is a requirement for proper project management.

The fields causing this issue are the 'type' and 'WBS_ID' fields in the DS01 WBS table and the 'WBS_ID_WP' field in the DS08 WAD table. The 'type' field in the DS01 WBS table should contain either 'WP' or 'PP' to indicate whether the entry is a Work Package or Planning Package. The 'WBS_ID' field in the DS01 WBS table and the 'WBS_ID_WP' field in the DS08 WAD table should contain matching entries to indicate that a WAD is associated with each WP or PP.

If you encounter this error, you should review the entries in the DS01 WBS table and the DS08 WAD table to ensure that each WP or PP has an associated WAD.
## Why do we check this?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
{.is-warning}

This test is being performed to check if there are any Work Packages (WP) or Planning Packages (PP) in the 'DS01 WBS' table that are missing a Work Authorization Document (WAD). The test is checking if the 'WBS_ID' from the 'DS01 WBS' table is present in the 'DS08.WBS_ID_WP' list. 

The importance of this check is to ensure that all work packages and planning packages have an associated work authorization document. This is crucial for maintaining data integrity and ensuring proper project management, as a WAD provides the authorization to perform work and is a key component in tracking and managing project progress.

The severity of this check is marked as 'WARNING', which means that while it may not prevent the data from being reviewed, it is likely to cause problems during analysis. This could potentially lead to inaccurate project tracking and management. Therefore, it is important to address this issue to ensure accurate and reliable project management data.
## Code

```sql

CREATE FUNCTION [dbo].[fnDIQ_DS01_WBS_IsWPOrPPMissingWAD] (
	@upload_id int = 0
)
RETURNS TABLE
AS RETURN
(
	
	SELECT	*
    FROM	DS01_WBS
    WHERE	upload_ID = @upload_id
			AND [external] = 'N'
			AND type IN ('PP','WP')
			AND EXISTS (
				SELECT	1
				FROM	DS08_WAD
				WHERE	upload_ID = @upload_id
						AND TRIM(ISNULL(WBS_ID_WP,'')) <> ''
			)
			AND WBS_ID NOT IN (
				SELECT	WBS_ID_WP
				FROM	DS08_WAD
				WHERE	upload_ID = @upload_id
			)
)
```
