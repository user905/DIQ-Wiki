## Basic Information
| Key         | Value          |
|-------------|----------------|
| Table       | DS17 WBS EU |
| Severity    | ALERT |
| Unique ID   | 9170584   |
| Summary     | Is this WBS of a type other than WP or PP? |
| Error message | WBS_ID not in DS01.WBS_ID where type = WP or PP. |

## What causes this error?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
{.is-warning}

The Data Integrity and Quality (DIQ) check titled "WBS Of Non-WP or PP Type" is designed to verify the type of Work Breakdown Structure (WBS) in the DS17 WBS EU table. The WBS should be of either 'WP' (Work Package) or 'PP' (Planning Package) type. 

If an error is flagged by this DIQ check, it indicates that there are entries in the DS17 WBS EU table with a WBS type that is neither 'WP' nor 'PP'. This discrepancy is identified by comparing the 'WBS_ID' field in the DS17 WBS EU table with the corresponding 'WBS_ID' in the DS01 WBS table. 

To resolve this issue, review the 'type' field in the DS01 WBS table for the flagged 'WBS_ID'. Ensure that the 'type' field is either 'WP' or 'PP'. If it is not, you will need to correct the data entry error in the DS01 WBS table. 

Remember, maintaining data integrity and quality is crucial for accurate and reliable project management data.
## Why do we check this?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
{.is-warning}

This test is being performed to check the Work Breakdown Structure (WBS) type in the 'DS17 WBS EU' table. Specifically, it is verifying whether the WBS is of a type other than Work Package (WP) or Planning Package (PP). The test raises an alert if a WBS_ID is found that is not present in the 'DS01' table where the type is either WP or PP.

The importance of this check is to ensure consistency and accuracy in the classification of WBS types. If a WBS is not classified as either a WP or PP, it may indicate an error in data entry or a deviation from standard project management practices. This could potentially lead to issues in project planning, tracking, and resource allocation. 

Although the severity of this check is classified as an 'ALERT', which is less severe, it is still important to address this issue to maintain the integrity of the project management data and to ensure accurate and efficient project execution.
## Code

```sql

CREATE FUNCTION [dbo].[fnDIQ_DS17_WBS_EU_IsWBSNotWPOrPP] (
	@upload_id int = 0
)
RETURNS TABLE
AS RETURN
(
	
	SELECT 
		E.*
	FROM 
		DS17_WBS_EU E INNER JOIN DS01_WBS W ON E.WBS_ID = W.WBS_ID
	WHERE 
			E.upload_ID = @upload_ID
		AND W.upload_ID = @upload_ID
		AND W.[type] NOT IN ('WP','PP')
)
```
