## Basic Information
| Key         | Value          |
|-------------|----------------|
| Table       | DS09 CC Log |
| Severity    | ERROR |
| Unique ID   | 1090440   |
| Summary     | Is this CC Log entry duplicated by CC Log ID & Supplement ID? |
| Error message | Count of CC_log_ID & CC_log_ID_supplement combo > 1. |

## What causes this error?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
{.is-warning}

The Data Integrity and Quality (DIQ) check titled "Duplicate CC Log Entry" is designed to identify any potential duplicate entries in the DS09 CC Log. This check specifically looks for any instances where the combination of the CC Log ID and the Supplement ID are identical for more than one entry.

If the DIQ check identifies a count greater than 1 for the same combination of CC Log ID and Supplement ID, this indicates a duplicate entry. Duplicate entries can occur due to a variety of reasons such as data entry errors, system glitches, or data import issues.

The fields causing the issue in this case are the CC Log ID and the Supplement ID. The expected values for these fields should be unique for each entry. If the same combination of CC Log ID and Supplement ID appears more than once, it is considered a duplicate and flagged by this DIQ check.

To resolve this issue, it is recommended to review the entries in the DS09 CC Log for any duplicates and correct them as necessary. This could involve removing the duplicate entries or updating the Supplement ID to ensure each combination of CC Log ID and Supplement ID is unique.
## Why do we check this?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
{.is-warning}

This test is being performed on the 'DS09 CC Log' table to check for duplicate entries in the CC Log. Specifically, it is looking for instances where the combination of 'CC_log_ID' and 'CC_log_ID_supplement' appears more than once, which would indicate a duplicate entry. 

The importance of this check is to ensure the accuracy and reliability of the data. Duplicate entries can distort the data and lead to incorrect conclusions or decisions based on that data. For example, it could lead to overestimating the cost or duration of a project, or underestimating the resources needed. 

The severity of this check is marked as 'ERROR', which is the highest level of severity. This means that if duplicate entries are found, they must be corrected before the data can be reviewed or used for further analysis. This underscores the critical importance of data integrity and quality in project management data.
## Code

```sql

CREATE FUNCTION [dbo].[fnDIQ_DS09_CCLog_PK] (
	@upload_id int = 0
)
RETURNS TABLE
AS RETURN
(
	
	with Dupes as (
		SELECT CC_log_ID LogID, ISNULL(CC_log_ID_supplement,'') Supp
		FROM DS09_CC_log
		WHERE upload_ID = @upload_ID
		GROUP BY CC_log_ID, ISNULL(CC_log_ID_supplement,'')
		HAVING COUNT(*) > 1
	)
	SELECT 
		L.*
	FROM
		DS09_CC_log L INNER JOIN Dupes D ON L.CC_log_ID = D.LogID 
										AND ISNULL(L.CC_log_ID_supplement,'') = D.Supp
	WHERE
		upload_ID = @upload_ID  
)
```
