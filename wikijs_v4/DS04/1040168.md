## Basic Information
| Key         | Value          |
|-------------|----------------|
| Table       | DS04 Schedule |
| Severity    | WARNING |
| Unique ID   | 1040168   |
| Summary     | Is this non-LOE task using a Duration % Complete type? |
| Error message | Duration % Complete type (PC_type = Duration) on non-LOE task (EVT = A and type = LOE). |

## What causes this error?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
{.is-warning}

The Data Integrity and Quality (DIQ) check for the DS04 Schedule table, titled "Duration % Complete Type On Non-LOE Task", is designed to verify whether non-LOE tasks are using a Duration % Complete type. 

An error message will be triggered if a non-LOE task is found to be using a Duration % Complete type. This is identified by the PC_type field being set to 'Duration', and both the EVT field not being 'A' and the type field not being 'LOE'. 

The likely cause of this error is an incorrect data entry. Non-LOE tasks should not be using a Duration % Complete type. Therefore, the expected values for a non-LOE task would be any value other than 'Duration' in the PC_type field. 

To resolve this issue, review the data entries in the DS04 Schedule table, specifically the PC_type, EVT, and type fields, and correct any discrepancies.
## Why do we check this?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
{.is-warning}

This test is being performed on the 'DS04 Schedule' table to check if non-LOE (Level of Effort) tasks are using a 'Duration % Complete' type. The test is designed to identify any instances where the 'Duration % Complete' type (PC_type = Duration) is being used on non-LOE tasks (EVT = A and type = LOE). 

The importance of this check is to ensure that the correct completion type is being used for each task. Using the wrong completion type could lead to inaccurate tracking of task progress, which could in turn impact project timelines and resource allocation. 

The severity of this check is classified as a 'WARNING', which means that while it may not prevent the data from being reviewed, it is likely to cause problems during analysis. Therefore, it is recommended that any issues identified by this test are addressed to ensure the accuracy and reliability of the project management data.
## Code

```sql

CREATE FUNCTION [dbo].[fnDIQ_DS04_Sched_IsDurationPCTypeOnNonLOETask] (
	@upload_id int = 0
)
RETURNS TABLE
AS RETURN
(
	
	SELECT
		*
	FROM
		DS04_schedule
	WHERE
			upload_id = @upload_ID
		AND PC_type = 'Duration'
		AND EVT <> 'A'
		AND type <> 'LOE'
)
```
