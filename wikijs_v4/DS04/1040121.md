## Basic Information
| Key         | Value          |
|-------------|----------------|
| Table       | DS04 Schedule |
| Severity    | WARNING |
| Unique ID   | 1040121   |
| Summary     | Does this completed task have remaining duration? |
| Error message | Task has an AF_Date and duration_remaining_days > 0. |

## What causes this error?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
{.is-warning}

The Data Integrity and Quality (DIQ) check titled "Completed Task with Remaining Duration" is designed to ensure the accuracy and consistency of data in the DS04 Schedule table. This check specifically looks for instances where a task is marked as completed (indicated by the presence of an Actual Finish date, or AF_Date), but still has a remaining duration (duration_remaining_days > 0).

If this DIQ check flags an issue, it means that there is a discrepancy in the data. A task that is completed should not have any remaining duration. The fields causing this issue are the AF_Date and duration_remaining_days fields. 

The expected values for a completed task would be an AF_Date (indicating the task is completed) and a duration_remaining_days value of 0 (indicating there is no remaining duration for the task). If a task is marked as completed but still shows remaining duration, it may indicate an error in data entry or task tracking. 

To resolve this issue, review the tasks flagged by this DIQ check and correct the data as necessary, ensuring that completed tasks have a duration_remaining_days value of 0.
## Why do we check this?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
{.is-warning}

This test is being performed on the 'DS04 Schedule' table to check for any completed tasks that still have a remaining duration. The test is checking if a task has an Actual Finish Date (AF_Date) but still has a value greater than 0 for 'duration_remaining_days'. This could indicate an inconsistency in the data, as a completed task should not have any remaining duration.

The importance of this check is to ensure the accuracy and consistency of the project schedule data. If a task is marked as completed but still has remaining duration, it could lead to incorrect calculations or misinterpretations of the project's progress and completion status. This could potentially cause problems during the analysis of the project data, hence the severity level is set as 'WARNING'. It's crucial to address this issue to maintain the integrity and quality of the project management data.
## Code

```sql

CREATE FUNCTION [dbo].[fnDIQ_DS04_Sched_DoesCompletedTaskHaveRemDur] (
	@upload_id int = 0
)
RETURNS TABLE
AS RETURN
(
	
	SELECT
		*
	FROM
		DS04_schedule
	WHERE
			upload_id = @upload_ID
		AND AF_date IS NOT NULL
		AND duration_remaining_days <> 0
)
```
