## Basic Information
| Key         | Value          |
|-------------|----------------|
| Table       | DS04 Schedule |
| Severity    | WARNING |
| Unique ID   | 1040188   |
| Summary     | Is this LOE or WBS summary task on the driving path? |
| Error message | LOE task (EVT = A or type = LOE) or WBS summary task (type = WS) found on the driving path (driving_path = Y). |

## What causes this error?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
{.is-warning}

The Data Integrity and Quality (DIQ) check titled "LOE or WBS Summary Task On Driving Path" is designed to verify the integrity of data in the DS04 Schedule table. This check specifically looks for instances where a Level of Effort (LOE) task or a Work Breakdown Structure (WBS) summary task is found on the driving path of the project.

An LOE task is identified by an EVT value of 'A' or a type value of 'LOE'. A WBS summary task is identified by a type value of 'WS'. The driving path of the project is indicated by a 'Y' in the driving_path field.

If the DIQ check finds an LOE task or a WBS summary task on the driving path, it will flag this as an error. This is because LOE tasks and WBS summary tasks should not be on the driving path of the project. The driving path should only contain tasks that directly affect the project's completion date. LOE tasks and WBS summary tasks are typically used for planning and tracking purposes and do not directly drive the project's completion.

If you encounter this error, you should review the tasks on the driving path of your project. Ensure that any tasks with an EVT value of 'A' or a type value of 'LOE' or 'WS' are not marked as being on the driving path. Correcting these values should resolve the error.
## Why do we check this?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
{.is-warning}

This test is being performed to check if there are any Level of Effort (LOE) tasks or Work Breakdown Structure (WBS) summary tasks on the driving path of the DS04 Schedule table. The driving path is the sequence of activities that determines the shortest time to complete the project. LOE tasks or WBS summary tasks on the driving path could potentially distort the project timeline and misrepresent the critical path.

The importance of this check is to ensure the accuracy and reliability of the project schedule. LOE tasks, which are ongoing tasks that do not have a definite beginning or end, and WBS summary tasks, which are aggregate tasks that summarize the status of their subtasks, should not be on the driving path as they can skew the project's critical path analysis. 

The severity of this check is marked as a WARNING, which means that while it may not prevent the data from being reviewed, it is likely to cause problems during the analysis of the project schedule. It is crucial to address this issue to maintain the integrity and quality of the project management data.
## Code

```sql

CREATE FUNCTION [dbo].[fnDIQ_DS04_Sched_IsLOEOrWBSSummaryOnDrivingPath] (
	@upload_id int = 0
)
RETURNS TABLE
AS RETURN
(
	SELECT
		*
	FROM
		DS04_schedule
	WHERE
			upload_id = @upload_ID
		AND [driving_path] = 'y'
		AND (EVT = 'A' OR type IN ('WS', 'LOE'))
)
```
