## Basic Information
| Key         | Value          |
|-------------|----------------|
| Table       | DS08 WAD |
| Severity    | WARNING |
| Unique ID   | 9080436   |
| Summary     | Are the subcontract budget dollars for this CA WAD missing in cost? |
| Error message | budget_subcontract_dollars > 0 & DS03.BCWSi_dollars = 0 where EOC = subcontract (by WBS_ID_CA). |

## What causes this error?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
{.is-warning}

The Data Integrity and Quality (DIQ) check for the DS08 WAD table, titled "CA Subcontract Dollars Missing In Cost", is designed to identify instances where the subcontract budget dollars for a Control Account (CA) Work Authorization Document (WAD) are not reflected in the cost data.

This issue arises when the 'budget_subcontract_dollars' field in the DS08 WAD table has a value greater than zero, indicating that there is a budget allocated for subcontracting, but the corresponding 'BCWSi_dollars' field in the DS03 cost table is zero. This discrepancy suggests that the budgeted subcontract dollars are not accounted for in the cost data. 

The check specifically looks for these discrepancies in records where the 'EOC' (Element of Cost) field is marked as 'subcontract' and the 'WBS_ID_CA' (Work Breakdown Structure ID for Control Account) field matches between the DS08 WAD and DS03 cost tables. 

If the DIQ check identifies such records, it means that there are subcontract budget dollars allocated in the WAD that are not reflected in the cost data. This could be due to a data entry error, a delay in updating the cost data, or a misalignment between the budget and cost tracking processes. 

To resolve this issue, you should review the identified records and ensure that the subcontract budget dollars are correctly reflected in the cost data.
## Why do we check this?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
{.is-warning}

This test is being performed to ensure that the subcontract budget dollars for a particular Work Authorization Directive (WAD) in the DS08 WAD table are not missing in the cost. The test checks if there are any instances where the budget for subcontract dollars is greater than zero, but the Budgeted Cost for Work Scheduled (BCWSi) dollars is zero for subcontracts. 

The importance of this check is to ensure that all subcontract costs are accurately reflected in the project's budget. If subcontract costs are not included, it could lead to underestimation of the project's total cost, which could in turn lead to budget overruns and project delays. 

The severity of this check is marked as a WARNING. This means that while the issue is not critical enough to halt the review of the data, it is likely to cause problems during the analysis of the project's cost and budget. Therefore, it is recommended that this issue be addressed to ensure accurate and reliable project cost management.
## Code

```sql

CREATE FUNCTION [dbo].[fnDIQ_DS08_WAD_IsSubKBudgetMissingInDS03CA] (
	@upload_id int = 0
)
RETURNS TABLE
AS RETURN
(
	
	with NonSubcontractCA as (
		SELECT DISTINCT WBS_ID_CA
		FROM DS03_cost
		WHERE 
				upload_ID = @upload_ID 
			AND WBS_ID_WP NOT IN (
				SELECT WBS_ID_WP
				FROM DS03_cost
				WHERE upload_ID = @upload_ID AND EOC = 'Subcontract' AND BCWSi_dollars <> 0
			)
	)
	SELECT 
		W.*
	FROM
		DS08_WAD W INNER JOIN NonSubcontractCA C ON W.WBS_ID = C.WBS_ID_CA
	WHERE
			upload_ID = @upload_ID  
		AND TRIM(ISNULL(W.WBS_ID_WP,'')) = ''
		AND budget_subcontract_dollars <> 0
)
```
