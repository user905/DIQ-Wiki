## Basic Information
| Key         | Value          |
|-------------|----------------|
| Table       | DS08 WAD |
| Severity    | WARNING |
| Unique ID   | 9080386   |
| Summary     | Are the labor budget dollars for this CA WAD misaligned with what is in cost? |
| Error message | budget_labor_dollars <> SUM(DS03.BCWSi_dollars) where EOC = labor (by WBS_ID_CA). |

## What causes this error?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
{.is-warning}

The Data Integrity and Quality (DIQ) check titled "CA Labor Dollars Misaligned With Cost" is designed to ensure that the labor budget dollars for a Control Account (CA) Work Authorization Document (WAD) align with the cost data in the DS03 cost table. 

This check is performed on the DS08 WAD table. It compares the 'budget_labor_dollars' field in the DS08 WAD table with the sum of 'BCWSi_dollars' in the DS03 cost table for each Control Account where the Element of Cost (EOC) is 'Labor'. 

If the 'budget_labor_dollars' field in the DS08 WAD table does not match the sum of 'BCWSi_dollars' for the corresponding Control Account in the DS03 cost table, the DIQ check will flag this as an error. 

This discrepancy could be caused by incorrect data entry in either the 'budget_labor_dollars' field in the DS08 WAD table or the 'BCWSi_dollars' field in the DS03 cost table. It could also be due to a mismatch in the Control Account identifiers ('WBS_ID_CA') between the two tables. 

To resolve this issue, ensure that the labor budget dollars for each Control Account in the DS08 WAD table match the sum of 'BCWSi_dollars' for the same Control Account in the DS03 cost table. Also, verify that the Control Account identifiers match between the two tables.
## Why do we check this?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
{.is-warning}

This test is being performed to ensure that the labor budget dollars for a particular Control Account Work Authorization Document (CA WAD) align with the cost data. The test is comparing the budgeted labor dollars to the sum of the Budgeted Cost of Work Scheduled (BCWS) for labor, grouped by the Work Breakdown Structure ID for the Control Account (WBS_ID_CA). 

The importance of this check is to ensure that the budgeted labor costs match the scheduled labor costs. If there is a discrepancy, it could indicate an error in budgeting or scheduling, which could lead to financial mismanagement or project delays. 

The severity of this check is a WARNING, which means that while it may not prevent the data from being reviewed, it is likely to cause problems during analysis. It is crucial to address this issue to ensure accurate financial planning and project management.
## Code

```sql

CREATE FUNCTION [dbo].[fnDIQ_DS08_WAD_AreLaborDollarsMisalignedWithDS03CA] (
	@upload_id int = 0
)
RETURNS TABLE
AS RETURN
(
	
	with LaborCA as (
		SELECT WBS_ID_CA, SUM(BCWSi_dollars) BCWSc
		FROM DS03_cost
		WHERE upload_ID = @upload_ID AND EOC = 'Labor'
		GROUP BY WBS_ID_CA
	)
	SELECT 
		W.*
	FROM
		DS08_WAD W INNER JOIN LaborCA C ON W.WBS_ID = C.WBS_ID_CA 
										AND budget_labor_dollars <> C.BCWSc
	WHERE
			upload_ID = @upload_ID  
		AND TRIM(ISNULL(W.WBS_ID_WP,'')) = ''
)
```
