## Basic Information
| Key         | Value          |
|-------------|----------------|
| Table       | DS08 WAD |
| Severity    | WARNING |
| Unique ID   | 9080389   |
| Summary     | Are the labor budget hours for this WP/PP WAD misaligned with what is in cost? |
| Error message | budget_labor_hours <> SUM(DS03.BCWSi_hours) where EOC = labor (by WBS_ID_WP). |

## What causes this error?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
{.is-warning}

The Data Integrity and Quality (DIQ) check titled "WP Labor Hours Misaligned With Cost" is designed to identify any discrepancies between the labor budget hours for a given Work Package (WP) or Planning Package (PP) in the DS08 Work Authorization Document (WAD) table and the corresponding values in the DS03 Cost table. 

The error is likely to occur when the total budgeted labor hours for a WP/PP in the DS08 WAD table does not match the sum of the Budgeted Cost of Work Scheduled (BCWS) hours for the same WP/PP in the DS03 Cost table, specifically for labor costs. 

The fields causing the issue are 'budget_labor_hours' in the DS08 WAD table and 'BCWSi_hours' in the DS03 Cost table. The expected values for these fields should be equal for each WP/PP, indicating that the labor hours budgeted align with the labor costs scheduled. 

If the DIQ check identifies a discrepancy, it suggests that there may be an error in either the budgeted labor hours or the scheduled labor costs for the WP/PP. This should be investigated and corrected to ensure accurate project management data.
## Why do we check this?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
{.is-warning}

This test is being performed to ensure that the labor budget hours for a particular work package or planning package (WP/PP) within the DS08 WAD table align with the cost data. The test is checking if the budgeted labor hours are not equal to the sum of the Budgeted Cost of Work Scheduled (BCWS) hours for labor entries, grouped by the Work Breakdown Structure ID for the work package (WBS_ID_WP).

The importance of this check lies in maintaining the accuracy and consistency of the project's cost and labor data. If the labor hours are misaligned with the cost, it could lead to inaccurate cost projections, budgeting errors, and potential financial risks for the project. This could also affect the project's scheduling and resource allocation.

The severity of this check is marked as a WARNING. This means that while it may not immediately prevent the data from being reviewed, it is likely to cause problems during the analysis of the project's cost and labor data. Therefore, it is crucial to address this issue to ensure accurate and reliable project management data.
## Code

```sql

CREATE FUNCTION [dbo].[fnDIQ_DS08_WAD_AreLaborHoursMisalignedWithDS03WP] (
	@upload_id int = 0
)
RETURNS TABLE
AS RETURN
(
	
	with LaborWP as (
		SELECT WBS_ID_WP, SUM(BCWSi_hours) BCWSc
		FROM DS03_cost
		WHERE upload_ID = @upload_ID AND EOC = 'Labor'
		GROUP BY WBS_ID_WP
	)
	SELECT 
		W.*
	FROM
		DS08_WAD W INNER JOIN LaborWP C ON W.WBS_ID_WP = C.WBS_ID_WP
										AND budget_labor_hours <> C.BCWSc
	WHERE
		upload_ID = @upload_ID  
)
```
