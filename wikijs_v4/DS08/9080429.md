## Basic Information
| Key         | Value          |
|-------------|----------------|
| Table       | DS08 WAD |
| Severity    | ALERT |
| Unique ID   | 9080429   |
| Summary     | Is the POP finish later than the planned completion milestone in the forecast scheduel? |
| Error message | pop_finish > DS04.ES_date/EF_date where milestone_level = 170 & schedule_type = FC. |

## What causes this error?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
{.is-warning}

The Data Integrity and Quality (DIQ) check titled "POP Finish After Project Planned Completion Milestone (FC)" is designed to ensure that the Project Outturn Performance (POP) finish date is not later than the planned completion milestone in the forecast schedule. This check is performed on the DS08 Work Authorization Directive (WAD) table.

If an error is flagged by this DIQ check, it indicates that the POP finish date in the DS08 WAD table is later than the planned completion milestone date in the DS04 Schedule table. This discrepancy could be due to an error in data entry or a delay in the project that has not been properly accounted for in the forecast schedule.

The fields causing the issue are the 'POP_finish_date' field in the DS08 WAD table and the 'ES_Date' or 'EF_Date' fields in the DS04 Schedule table. The expected value is that the 'POP_finish_date' should be on or before the 'ES_Date' or 'EF_Date' when the 'milestone_level' is 170 and the 'schedule_type' is 'FC'. 

To resolve this issue, review the dates in question to ensure they have been entered correctly and that any project delays have been accurately reflected in the forecast schedule.
## Why do we check this?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
{.is-warning}

This test is being performed on the 'DS08 WAD' table to check if the Performance of Project (POP) finish date is later than the planned completion milestone in the forecast schedule. This is important because if the POP finish date is later than the planned completion date, it indicates that the project is not on track and may not meet its deadlines. 

The severity of this test is marked as 'ALERT', which is less severe but indicates that there might be minor problems or that the data doesn't follow all best practices. This could potentially cause issues during data analysis and may require attention to ensure the accuracy and reliability of the project management data. 

In essence, this check is crucial to maintain the integrity and quality of the EVMS construction project management data at the US Department of Energy. It helps in identifying potential issues in the project timeline and allows for timely corrective actions.
## Code

```sql

CREATE FUNCTION [dbo].[fnDIQ_DS08_WAD_IsPOPFinishAfterPlannedCompletionFC] (
	@upload_id int = 0
)
RETURNS TABLE
AS RETURN
(
	
	SELECT 
		*
	FROM
		DS08_WAD
	WHERE
			upload_ID = @upload_ID  
		AND POP_finish_date > (
			SELECT COALESCE(ES_Date, EF_Date)
			FROM DS04_schedule
			WHERE upload_ID = @upload_ID AND milestone_level = 170 AND schedule_type = 'FC'
		)
)
```
