## Basic Information
| Key         | Value          |
|-------------|----------------|
| Table       | DS08 WAD |
| Severity    | WARNING |
| Unique ID   | 9080408   |
| Summary     | Is the CAM on this WP/PP WAD misaligned with what is in the WBS hierarchy? |
| Error message | DS08.CAM <> DS01.CAM (by WBS_ID_WP). |

## What causes this error?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
{.is-warning}

The Data Integrity and Quality (DIQ) check titled "CAM Misaligned with WBS Hierarchy (WP)" is designed to ensure that the Control Account Manager (CAM) assigned to a Work Package (WP) or Planning Package (PP) in the DS08 Work Authorization Document (WAD) table aligns with the CAM assigned in the DS01 Work Breakdown Structure (WBS) table. 

The test is performed by comparing the CAM field in the DS08 WAD table with the CAM field in the DS01 WBS table for each Work Package. If there is a mismatch between the two, the test will flag an error. 

The likely cause of this error is an inconsistency in the assignment of the Control Account Manager between the DS08 WAD and DS01 WBS tables. This could occur if there has been a change in the CAM for a particular Work Package, and this change has not been consistently updated across both tables. 

To resolve this error, you should ensure that the CAM assigned to each Work Package in the DS08 WAD table matches the CAM assigned in the DS01 WBS table. The CAM field should not be left blank in either table.
## Why do we check this?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
{.is-warning}

This test is being performed to ensure that the Control Account Manager (CAM) assigned to a particular Work Package (WP) or Planning Package (PP) in the DS08 WAD table aligns with the CAM assigned in the Work Breakdown Structure (WBS) hierarchy. The test is checking for any discrepancies between the CAMs listed in the DS08 and DS01 tables for the same WBS_ID_WP.

The importance of this check lies in maintaining consistency and accuracy in project management data. If the CAMs are misaligned, it could lead to confusion, miscommunication, or errors in project management and execution. It could also impact the accuracy of project reports and analyses. 

The severity of this test is marked as a WARNING. This means that while it may not prevent the data from being reviewed, any discrepancies found could potentially cause problems during data analysis. Therefore, it is recommended to address and correct any misalignments found during this test to ensure the integrity and quality of the project management data.
## Code

```sql

CREATE FUNCTION [dbo].[fnDIQ_DS08_WAD_IsCAMMisalignedWithDS01WP] (
	@upload_id int = 0
)
RETURNS TABLE
AS RETURN
(
	
	SELECT 
		W.*
	FROM
		DS08_WAD W 	INNER JOIN LatestWPWADRev_Get(@upload_ID) LW ON W.WBS_ID_WP = LW.WBS_ID_WP AND W.auth_PM_date = LW.PMAuth
					INNER JOIN DS01_WBS WBS ON W.WBS_ID_WP = WBS.WBS_ID AND W.CAM <> WBS.CAM
	WHERE
			W.upload_ID = @upload_ID   
		AND WBS.upload_ID = @upload_ID
		AND TRIM(ISNULL(W.WBS_ID_WP,'')) <> ''
)
```
