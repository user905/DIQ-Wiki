## Basic Information
| Key         | Value          |
|-------------|----------------|
| Table       | DS08 WAD |
| Severity    | WARNING |
| Unique ID   | 9080613   |
| Summary     | Is the POP start for this Control Account WAD after the first recorded SPAE value in cost? |
| Error message | pop_start_date > min DS03.period_date where BCWS, BCWP, ACWP, or ETC <> 0 (by CA WBS ID). |

## What causes this error?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
{.is-warning}

The Data Integrity and Quality (DIQ) check titled "POP Start After Cost Start (CA)" is designed to ensure that the Period of Performance (POP) start date for a given Control Account Work Authorization Document (WAD) in DS08 WAD table does not occur after the first recorded Schedule Performance Account Element (SPAE) value in cost in DS03 cost table.

The error message "pop_start_date > min DS03.period_date where BCWS, BCWP, ACWP, or ETC <> 0 (by CA WBS ID)" indicates that the POP start date is later than the earliest period date in DS03 where any of the following fields are not zero: Budgeted Cost of Work Scheduled (BCWS), Budgeted Cost of Work Performed (BCWP), Actual Cost of Work Performed (ACWP), or Estimate to Complete (ETC). This is checked for each Control Account Work Breakdown Structure (WBS) ID.

This error is likely caused by incorrect data entry in either the POP start date in the DS08 WAD table or the period date in the DS03 cost table. The expected values should be such that the POP start date is not later than the earliest period date where BCWS, BCWP, ACWP, or ETC are not zero. 

Please ensure that the POP start date for each Control Account WAD is correctly entered and is not later than the first recorded SPAE value in cost. Also, verify that the period dates in DS03 are correctly entered and correspond to the actual start of cost activities.
## Why do we check this?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
{.is-warning}

This test is being performed to ensure that the Planned Order of Production (POP) start date for a specific Control Account Work Authorization Document (WAD) does not occur after the first recorded Schedule Performance Analysis Element (SPAE) value in cost. This is important because if the POP start date is after the first cost recording, it could indicate that costs are being incurred before the project has officially started, which could lead to budget overruns or misallocation of resources.

The severity of this test is marked as a WARNING. This means that while it may not immediately prevent the data from being reviewed, it is likely to cause problems during analysis. It could potentially skew the project's financial data and lead to inaccurate cost projections. Therefore, it's crucial to address this issue to ensure accurate and reliable project management data.
## Code

```sql

CREATE FUNCTION [dbo].[fnDIQ_DS08_WAD_IsPOPStartAfterDS03StartCA] (
	@upload_id int = 0
)
RETURNS TABLE
AS RETURN
(
	
	with CostStart as (
		SELECT WBS_ID_CA CAWBS, MIN(period_date) Period
		FROM DS03_cost
		WHERE upload_ID = @upload_ID AND (
			BCWSi_dollars <> 0 OR BCWSi_hours <> 0 OR BCWSi_FTEs <> 0 OR
			BCWPi_dollars <> 0 OR BCWPi_hours <> 0 OR BCWPi_FTEs <> 0 OR
			ACWPi_dollars <> 0 OR ACWPi_hours <> 0 OR ACWPi_FTEs <> 0 OR
			ETCi_dollars <> 0 OR ETCi_hours <> 0 OR ETCi_FTEs <> 0
		)
		GROUP BY WBS_ID_CA
	)
	SELECT 
		W.*
	FROM 
		DS08_WAD W 	INNER JOIN LatestCAWADRev_Get(@upload_ID) R ON W.WBS_ID = R.WBS_ID 
																AND W.auth_PM_date = R.PMAuth
					INNER JOIN CostStart C 	ON W.WBS_ID = C.CAWBS 
											AND POP_start_date > C.[Period]
	WHERE 
			upload_ID = @upload_ID
		AND TRIM(ISNULL(WBS_ID_WP,'')) = '' -- exclude all WP/PP level WADs
)
```
