## Basic Information
| Key         | Value          |
|-------------|----------------|
| Table       | DS08 WAD |
| Severity    | ALERT |
| Unique ID   | 1080399   |
| Summary     | Is there an EVT for this CA-level WAD? |
| Error message | EVT <> blank or NA & WBS_ID_WP <> blank. |

## What causes this error?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
{.is-warning}

The Data Integrity and Quality (DIQ) check titled "EVT on CA-Level WAD" is designed to ensure that each Control Account (CA) level Work Authorization Document (WAD) in the DS08 WAD table has an associated Earned Value Technique (EVT). 

The test checks for two conditions: 

1. The WBS_ID_WP field in the DS08 WAD table should not be blank. This field represents the Work Breakdown Structure ID for the Work Package and is crucial for identifying the specific work package associated with the WAD. 

2. The EVT field in the same table should not be blank or contain the value 'NA'. This field represents the Earned Value Technique associated with the WAD. 

If either of these conditions is not met, the test will flag an error. 

The likely cause of this error is missing or incorrect data entry. For example, if the WBS_ID_WP field is left blank, it would be impossible to link the WAD to a specific work package. Similarly, if the EVT field is blank or contains 'NA', it would indicate that the Earned Value Technique for the WAD is missing or not applicable, which is not acceptable. 

To resolve this error, ensure that each CA-level WAD has a valid WBS_ID_WP and an associated EVT. The WBS_ID_WP should correspond to a valid Work Breakdown Structure ID for a Work Package, and the EVT should be a valid Earned Value Technique.
## Why do we check this?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
{.is-warning}

This test is being performed to check if there is an Earned Value Technique (EVT) for the Control Account (CA) level Work Authorization Document (WAD) in the DS08 WAD table. The test is checking if the EVT field is not blank or not marked as 'NA', and if the Work Breakdown Structure ID Work Package (WBS_ID_WP) field is not blank. 

The importance of this check is to ensure that each CA-level WAD has an associated EVT and a WBS_ID_WP. This is crucial for project management as the EVT is used to measure the work performance against the plan, and the WBS_ID_WP is used to identify the specific work package. 

The severity of this check is marked as an ALERT, which means it is not critical but could cause minor problems or indicate that the data does not follow all best practices. It is important to address this to ensure the accuracy and completeness of the project management data.
## Code

```sql

CREATE FUNCTION [dbo].[fnDIQ_DS08_WAD_DoesEVTExistOnCAWAD] (
	@upload_id int = 0
)
RETURNS TABLE
AS RETURN
(
	
	SELECT 
		*
	FROM
		DS08_WAD
	WHERE
			upload_ID = @upload_ID   
		AND TRIM(ISNULL(WBS_ID_WP,'')) = ''
		AND WBS_ID IN (SELECT WBS_ID FROM DS01_WBS WHERE upload_ID = @upload_ID AND type = 'CA')
		AND ISNULL(EVT,'') NOT IN ('','NA')
)
```
