## Basic Information
| Key         | Value          |
|-------------|----------------|
| Table       | DS08 WAD |
| Severity    | WARNING |
| Unique ID   | 9080391   |
| Summary     | Are the material budget dollars for this WP WAD misaligned with what is in cost? |
| Error message | budget_material_dollars <> SUM(DS03.BCWSi_dollars) where EOC = material (by WBS_ID_WP). |

## What causes this error?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
{.is-warning}

The Data Integrity and Quality (DIQ) check titled "WP Material Dollars Misaligned With Cost" is designed to ensure that the material budget dollars for a given Work Package (WP) in the DS08 WAD table align with the corresponding cost data in the DS03 cost table. 

The test is comparing the 'budget_material_dollars' field in the DS08 WAD table with the sum of 'BCWSi_dollars' in the DS03 cost table for each Work Package (WP), specifically where the 'EOC' (Element of Cost) is marked as 'Material'. 

If an error is flagged by this DIQ check, it indicates a discrepancy between the budgeted material dollars for a WP and the actual cost data. This could be due to a data entry error, a calculation error, or a change in the budget or cost that has not been accurately reflected in both tables. 

To resolve this issue, you should review the 'budget_material_dollars' field in the DS08 WAD table and the 'BCWSi_dollars' field in the DS03 cost table for the relevant WP. Ensure that the budgeted material dollars align with the sum of the cost data where the EOC is 'Material'. If they do not align, you will need to investigate further to identify the source of the discrepancy and correct the data as necessary.
## Why do we check this?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
{.is-warning}

This test is being performed to ensure that the budgeted material dollars for a particular work package (WP) within the Work Authorization Document (WAD) aligns with the cost data. The test is comparing the budgeted material dollars with the sum of the Budgeted Cost of Work Scheduled (BCWS) for items where the Element of Cost (EOC) is material, grouped by the Work Breakdown Structure ID for the work package (WBS_ID_WP).

The importance of this check is to ensure that the budgeted costs for materials in a work package match the scheduled costs. If these values are misaligned, it could lead to inaccurate cost projections, budget overruns, or insufficient resource allocation. This could potentially disrupt the project timeline and overall project success.

The severity of this check is marked as a WARNING. This means that while the data can still be reviewed, any discrepancies found could cause significant problems during analysis. It is crucial to address these issues to ensure accurate and reliable project cost management and forecasting.
## Code

```sql

CREATE FUNCTION [dbo].[fnDIQ_DS08_WAD_AreMatDollarsMisalignedWithDS03WP] (
	@upload_id int = 0
)
RETURNS TABLE
AS RETURN
(
	
	with MaterialWP as (
		SELECT WBS_ID_WP, SUM(BCWSi_dollars) BCWSc
		FROM DS03_cost
		WHERE upload_ID = @upload_ID AND EOC = 'Material'
		GROUP BY WBS_ID_WP
	)
	SELECT 
		W.*
	FROM
		DS08_WAD W INNER JOIN MaterialWP C 	ON W.WBS_ID_WP = C.WBS_ID_WP
											AND budget_material_dollars <> C.BCWSc
	WHERE
		upload_ID = @upload_ID  
)
```
