## Basic Information
| Key         | Value          |
|-------------|----------------|
| Table       | DS08 WAD |
| Severity    | ALERT |
| Unique ID   | 1080398   |
| Summary     | Does this WP/PP WAD have comingled EOCs? |
| Error message | EOC budget dollars > 0 for at least two non-Overhead EOC types, e.g. budget_labor_dollars <> 0 & budget_material_dollar <> 0. |

## What causes this error?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
{.is-warning}

The Data Integrity and Quality (DIQ) check for the DS08 Work Authorization Directive (WAD) table, titled "WP/PP EOC Comingled (Dollars)", is designed to identify any instances where budget dollars for different types of Estimated at Completion (EOC) are comingled within the same Work Breakdown Structure (WBS) ID. 

The error is likely to occur when there are positive budget values for at least two different non-overhead EOC types within the same WBS ID. The EOC types considered in this check are labor, material, Other Direct Costs (ODC), and subcontract. For example, an error would be flagged if both 'budget_labor_dollars' and 'budget_material_dollars' fields have values greater than zero for the same WBS ID.

The expected values for each EOC type should be zero or positive. However, to avoid this error, each WBS ID should only have a positive budget value for one EOC type. If there are positive budget values for more than one EOC type within the same WBS ID, it indicates that the EOCs are comingled, which is not the desired state for the data. 

Please review the data in the DS08 WAD table and ensure that each WBS ID only contains a positive budget value for one EOC type to maintain data integrity and quality.
## Why do we check this?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
{.is-warning}

This test is being performed on the 'DS08 WAD' table to check if there are any work packages or planning packages (WP/PP) that have comingled Estimate at Completion (EOC) values. The test is checking if there are budget dollars allocated for at least two non-overhead EOC types, such as labor and material, in the same work package or planning package.

The importance of this check is to ensure that the budget allocation for different EOC types is clearly separated and not mixed within the same work package or planning package. This is crucial for accurate budget tracking and financial management in the project. Comingled EOCs can lead to confusion, inaccuracies in budget tracking, and potential financial mismanagement.

The severity of this check is marked as an 'ALERT', which means it is not a critical issue that would prevent the data from being reviewed. However, it indicates that there might be minor problems or that the data does not follow all best practices. Therefore, it is recommended to address this issue to ensure the highest quality and integrity of the project management data.
## Code

```sql

CREATE FUNCTION [dbo].[fnDIQ_DS08_WAD_AreWADEOCsComingled] (
	@upload_id int = 0
)
RETURNS TABLE
AS RETURN
(
	
	SELECT 
		*
	FROM
		DS08_WAD
	WHERE
			upload_ID = @upload_ID  
		AND TRIM(ISNULL(WBS_ID_WP,'')) <> ''
		AND (
			(budget_labor_dollars <> 0 AND budget_material_dollars <> 0) OR --labor and another type
			(budget_labor_dollars <> 0 AND budget_ODC_dollars <> 0) OR
			(budget_labor_dollars <> 0 AND budget_subcontract_dollars <> 0) OR
			(budget_material_dollars <> 0 AND budget_ODC_dollars <> 0) OR -- material and another type
			(budget_material_dollars <> 0 AND budget_subcontract_dollars <> 0) OR
			(budget_ODC_dollars <> 0 AND budget_subcontract_dollars <> 0) --ODC and subcontract
		)
)
```
