## Basic Information
| Key         | Value          |
|-------------|----------------|
| Table       | DS08 WAD |
| Severity    | WARNING |
| Unique ID   | 9080437   |
| Summary     | Are the subcontract budget dollars for this WP/PP WAD missing in cost? |
| Error message | budget_subcontract_dollars > 0 & DS03.BCWSi_dollars = 0 where EOC = subcontract (by WBS_ID_WP). |

## What causes this error?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
{.is-warning}

The Data Integrity and Quality (DIQ) check for the DS08 WAD table, titled "WP Subcontract Dollars Missing In Cost", is designed to identify any discrepancies in the subcontract budget dollars for a given Work Package (WP) or Planning Package (PP) Work Authorization Document (WAD). 

The error message "budget_subcontract_dollars > 0 & DS03.BCWSi_dollars = 0 where EOC = subcontract (by WBS_ID_WP)" indicates that there are instances where the budgeted subcontract dollars for a WP/PP WAD are greater than zero, but the Budgeted Cost of Work Scheduled (BCWSi_dollars) in the DS03 cost table is zero. This discrepancy occurs when the Element of Cost (EOC) is marked as 'subcontract' for a given Work Breakdown Structure ID (WBS_ID_WP).

The likely cause of this error is a data entry or processing error, where the budgeted subcontract dollars for a WP/PP WAD have been entered in the DS08 WAD table, but the corresponding BCWSi_dollars in the DS03 cost table have not been updated. 

To resolve this issue, ensure that for every WP/PP WAD with budgeted subcontract dollars in the DS08 WAD table, there is a corresponding entry in the DS03 cost table with the EOC marked as 'subcontract' and the BCWSi_dollars field is not zero.
## Why do we check this?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
{.is-warning}

This test is being performed to ensure that the subcontract budget dollars for a particular Work Package/Planning Package (WP/PP) Work Authorization Document (WAD) are not missing in the cost. The test checks if there are any instances where the budget for subcontract dollars is greater than zero, but the Budgeted Cost for Work Scheduled (BCWSi) dollars is zero for subcontracts. 

The importance of this check is to ensure that all subcontract costs are accurately accounted for in the project's budget. If subcontract costs are not included, it could lead to underestimation of the project's total cost, which could in turn lead to budget overruns and project delays. 

The severity of this check is marked as a WARNING. This means that while it may not immediately prevent the data from being reviewed, it is likely to cause problems during analysis. It is crucial to address this issue to ensure accurate budgeting and cost management for the project.
## Code

```sql

CREATE FUNCTION [dbo].[fnDIQ_DS08_WAD_IsSubKBudgetMissingInDS03WP] (
	@upload_id int = 0
)
RETURNS TABLE
AS RETURN
(
	
	with NonSubcontractWP as (
		SELECT DISTINCT WBS_ID_WP
		FROM DS03_cost
		WHERE 
				upload_ID = @upload_ID 
			AND WBS_ID_WP NOT IN (
				SELECT WBS_ID_WP
				FROM DS03_cost
				WHERE upload_ID = @upload_ID AND EOC = 'Subcontract' AND BCWSi_dollars <> 0
			)
	)
	SELECT 
		W.*
	FROM
		DS08_WAD W INNER JOIN NonSubcontractWP C ON W.WBS_ID_WP = C.WBS_ID_WP
	WHERE
			upload_ID = @upload_ID  
		AND budget_subcontract_dollars <> 0
)
```
