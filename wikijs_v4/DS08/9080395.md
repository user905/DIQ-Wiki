## Basic Information
| Key         | Value          |
|-------------|----------------|
| Table       | DS08 WAD |
| Severity    | WARNING |
| Unique ID   | 9080395   |
| Summary     | Are the overhead budget dollars for this WP/PP WAD misaligned with what is in cost? |
| Error message | budget_overhead_dollars <> SUM(DS03.BCWSi_dollars) where EOC = overhead (by WBS_ID_WP). |

## What causes this error?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
{.is-warning}

The Data Integrity and Quality (DIQ) check titled "WP Overhead Dollars Misaligned With Cost" is designed to ensure that the overhead budget dollars for a given Work Package (WP) or Planning Package (PP) in the DS08 WAD table align with the corresponding cost data in the DS03 cost table.

The test is checking if the 'budget_overhead_dollars' field in the DS08 WAD table is not equal to the sum of 'BCWSi_dollars' for the same Work Package in the DS03 cost table, where the Element of Cost (EOC) is 'Overhead'. 

If an error is flagged by this DIQ check, it is likely due to a discrepancy between the overhead budget dollars recorded in the DS08 WAD table and the sum of overhead costs recorded in the DS03 cost table for the same Work Package. This could be caused by an error in data entry, a miscalculation, or a change in overhead costs that has not been reflected in the budget data.

To resolve this issue, you should review the overhead budget dollars and the overhead costs for the Work Package in question, and ensure that they are correctly aligned. If necessary, update the 'budget_overhead_dollars' field in the DS08 WAD table or the 'BCWSi_dollars' field in the DS03 cost table to correct the discrepancy.
## Why do we check this?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
{.is-warning}

This test is being performed to ensure that the overhead budget dollars for a particular work package or planning package (WP/PP) within the DS08 WAD table align with the cost data in the DS03 table. The test is checking if the budget overhead dollars are not equal to the sum of the BCWSi_dollars where EOC (element of cost) is overhead, grouped by the WBS_ID_WP (Work Breakdown Structure ID for Work Package).

The importance of this check is to ensure that the overhead costs are accurately represented and accounted for in the project's budget. Misalignment between the budgeted overhead dollars and the actual cost can lead to inaccurate financial reporting, budget overruns, or underutilization of resources. This could potentially cause problems during the analysis of the project's financial data, hence the severity level is set as a WARNING. It is crucial to rectify this issue to maintain the integrity and quality of the project's financial data.
## Code

```sql

CREATE FUNCTION [dbo].[fnDIQ_DS08_WAD_AreOverheadDollarsMisalignedWithDS03WP] (
	@upload_id int = 0
)
RETURNS TABLE
AS RETURN
(
	
	with OverheadWP as (
		SELECT WBS_ID_WP, SUM(BCWSi_dollars) BCWSc
		FROM DS03_cost
		WHERE upload_ID = @upload_ID AND EOC = 'Overhead'
		GROUP BY WBS_ID_WP
	)
	SELECT 
		W.*
	FROM
		DS08_WAD W INNER JOIN OverheadWP C 	ON W.WBS_ID_WP = C.WBS_ID_WP
											AND budget_overhead_dollars <> C.BCWSc
	WHERE
		upload_ID = @upload_ID  
)
```
