## Basic Information
| Key         | Value          |
|-------------|----------------|
| Table       | DS12 Variance CAL |
| Severity    | MAJOR |
| Unique ID   | 9120496   |
| Summary     | Is this CAL missing in the variance CAL list? |
| Error message | CAL_ID not in DS11.CAL_ID list. |

## What causes this error?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
{.is-warning}

The Data Integrity and Quality (DIQ) check titled "CAL ID Missing in Variance CAL ID List" is designed to ensure that all CAL IDs in the DS12 Variance CAL table are also present in the DS11 Variance table. 

If this DIQ check fails, it indicates that there are one or more CAL IDs in the DS12 Variance CAL table that are not found in the DS11 Variance table. This discrepancy could be due to a data entry error, a missing record, or a mismatch between the two tables.

The specific field causing the issue is the 'CAL_ID' field. The expected value for this field is that every CAL ID in the DS12 Variance CAL table should also exist in the DS11 Variance table. If a CAL ID is found in DS12 Variance CAL but not in DS11 Variance, it will trigger this DIQ check.

To resolve this issue, you should review the CAL IDs in both tables and ensure that they match. Any discrepancies should be corrected to ensure data integrity and quality.
## Why do we check this?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
{.is-warning}

This test is being performed to ensure that all CAL IDs in the 'DS12 Variance CAL' table are also present in the 'DS11.CAL_ID' list. The purpose of this check is to maintain data integrity and consistency across different data sets. If a CAL ID is missing in the variance CAL list, it could lead to incomplete or inaccurate analysis results, as the data from the 'DS12 Variance CAL' table might not be fully represented in the 'DS11.CAL_ID' list.

The severity of this test is marked as 'MAJOR', which means that while it may not immediately prevent the data from being reviewed, it is likely to cause problems during analysis. This could include issues such as skewed results, incomplete data representation, or inaccurate conclusions. Therefore, it is important to address this issue to ensure the quality and reliability of the data analysis.
## Code

```sql

CREATE FUNCTION [dbo].[fnDIQ_DS12_VAR_CAL_IsCALIDMissingInDS11] (
	@upload_id int = 0
)
RETURNS TABLE
AS RETURN
(
	
	SELECT
		*
	FROM 
		DS12_variance_CAL
	WHERE 
			upload_ID = @upload_ID
		AND CAL_ID NOT IN (
			SELECT CAL_ID
			FROM DS11_variance
			WHERE upload_ID = @upload_ID
		)
)
```
