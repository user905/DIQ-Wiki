## Basic Information
| Key         | Value          |
|-------------|----------------|
| Table       | DS13 Subcontract |
| Severity    | MINOR |
| Unique ID   | 9130533   |
| Summary     | Is the forecast start date misaligned with the early start in the forecast schedule? |
| Error message | FC_start_date <> DS04.ES_date where schedule_type = FC (by task_ID). |

## What causes this error?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
{.is-warning}

The Data Integrity and Quality (DIQ) check titled "FC Start Misaligned with Forecast Schedule" is designed to identify any discrepancies between the forecast start date and the early start date in the forecast schedule for the DS13 Subcontract table. 

The error is likely to occur when the forecast start date (FC_start_date) in the DS13 Subcontract table does not match the early start date (ES_date) in the DS04 Schedule table for the same task. This discrepancy can occur due to data entry errors or changes in the project schedule that are not reflected in both tables.

The expected values for this DIQ check are that the FC_start_date in the DS13 Subcontract table should be equal to the ES_date in the DS04 Schedule table for each task where the schedule type is 'FC'. If these values are not equal, the DIQ check will flag the discrepancy for further investigation. 

Please ensure that the forecast start dates in the DS13 Subcontract table are correctly aligned with the early start dates in the DS04 Schedule table to maintain data integrity and quality.
## Why do we check this?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
{.is-warning}

This test is being performed to check if the forecast start date aligns with the early start date in the forecast schedule for the DS13 Subcontract table. The test is important because any misalignment between these two dates could lead to inaccurate forecasting and planning, which could potentially impact the project timeline and budget.

The severity of this test is marked as an MINOR. This means that while it may not immediately prevent data from being reviewed or analyzed, it could cause minor problems or indicate that the data does not adhere to best practices. It's crucial to address these alerts to ensure the accuracy and reliability of the data, and to maintain the integrity of the project management process.
## Code

```sql

CREATE FUNCTION [dbo].[fnDIQ_DS13_SubK_IsFCStartMisalignedWithDS04FCES] (
	@upload_id int = 0
)
RETURNS TABLE
AS RETURN
(
	
	SELECT
		SK.*
	FROM 
		DS13_subK SK INNER JOIN DS04_schedule S ON SK.task_ID = S.task_ID
	WHERE 
			SK.upload_ID = @upload_ID 
		AND S.upload_ID = @upload_ID
		AND SK.FC_start_date <> S.ES_date
		AND schedule_type = 'FC'
)
```
