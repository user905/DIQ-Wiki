## Basic Information
| Key         | Value          |
|-------------|----------------|
| Table       | DS13 Subcontract |
| Severity    | MAJOR |
| Unique ID   | 9130537   |
| Summary     | Is this task id missing in the forecast schedule? |
| Error message | task_ID not in DS04.task_ID where schedule_type = FC. |

## What causes this error?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
{.is-warning}

The Data Integrity and Quality (DIQ) check titled "Task ID Missing in Forecast Schedule" is designed to verify the consistency of task IDs between two datasets: DS13 Subcontract and DS04 Schedule. 

This check is performed to ensure that every task ID present in the DS13 Subcontract dataset also exists in the DS04 Schedule dataset, specifically where the schedule type is 'FC' (Forecast Schedule). 

If an error message "task_ID not in DS04.task_ID where schedule_type = FC" is received, it indicates that there are one or more task IDs in the DS13 Subcontract dataset that are not found in the DS04 Schedule dataset under the 'FC' schedule type. 

This discrepancy could be due to a variety of reasons such as data entry errors, missing entries in the DS04 Schedule dataset, or inconsistencies in the task ID naming conventions between the two datasets. 

To resolve this issue, it is recommended to cross-verify the task IDs in both datasets and ensure that they are consistent and correctly entered. All task IDs in the DS13 Subcontract dataset should have corresponding entries in the DS04 Schedule dataset under the 'FC' schedule type.
## Why do we check this?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
{.is-warning}

This test is being performed to ensure that all task IDs in the 'DS13 Subcontract' table are also present in the 'DS04' table where the schedule type is 'Forecast'. The importance of this check is to maintain data consistency across different tables. If a task ID is missing in the forecast schedule, it could lead to inaccurate forecasting and planning, which could potentially disrupt the project timeline and budget.

The severity of this test is marked as 'MAJOR', which means that while it may not immediately prevent the data from being reviewed, it is likely to cause problems during analysis. This could include issues such as incorrect calculations or misleading reports. Therefore, it is crucial to address this issue to ensure accurate and reliable project management data.
## Code

```sql

CREATE FUNCTION [dbo].[fnDIQ_DS13_SubK_IsTaskIDMissingInDS04FC] (
	@upload_id int = 0
)
RETURNS TABLE
AS RETURN
(
	
	SELECT
		*
	FROM 
		DS13_subK
	WHERE 
			upload_ID = @upload_ID 
		AND task_ID NOT IN  (
			SELECT task_ID
			FROM DS04_schedule
			WHERE upload_ID = @upload_ID AND schedule_type = 'FC'
		)
)
```
