## Basic Information
| Key         | Value          |
|-------------|----------------|
| Table       | DS11 Variance |
| Severity    | MAJOR |
| Unique ID   | 9110486   |
| Summary     | Is this CA-level VAR type as something other than CA in the WBS Dictionary? |
| Error message | narrative_type = 300 & DS01.type <> CA (by WBS_ID). |

## What causes this error?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
{.is-warning}

The DIQ check titled "CA-Level VAR Mistype In WBS Dictionary" is designed to ensure that the Control Account (CA) level Variance at Completion (VAR) type is correctly classified in the Work Breakdown Structure (WBS) Dictionary. This check is performed on the DS11 Variance table.

The error is likely to occur when the VAR type, which should be 'CA' at the CA level, is classified as something other than 'CA' in the WBS Dictionary. This discrepancy is identified by comparing the 'type' field in the DS01 WBS table with the 'narrative_type' field in the DS11 Variance table. 

The 'narrative_type' field should have a value of '300', which indicates a CA level VAR. If the 'type' field in the DS01 WBS table does not match 'CA', this indicates a misalignment between the VAR type and the WBS Dictionary.

To resolve this issue, ensure that the 'type' field in the DS01 WBS table is correctly classified as 'CA' for all CA level VARs. This will ensure data integrity and quality in the EVMS construction project management data.
## Why do we check this?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
{.is-warning}

This test is being performed on the 'DS11 Variance' table to check for any discrepancies in the Control Account (CA) level Variance at Completion (VAR) type in the Work Breakdown Structure (WBS) Dictionary. The test is checking if the CA-level VAR type is classified as something other than 'CA' in the WBS Dictionary. 

The importance of this check is to ensure that the VAR type is correctly classified in the WBS Dictionary. Misclassification can lead to incorrect data interpretation and analysis, which can subsequently impact project management decisions. 

The severity of this test is marked as 'MAJOR', which means that while it may not prevent the data from being reviewed, it is likely to cause problems during data analysis. Therefore, it is crucial to address this issue to ensure accurate and reliable data analysis.
## Code

```sql

CREATE FUNCTION [dbo].[fnDIQ_DS11_VAR_IsCAVARMisalignedWithDS01Type] (
	@upload_id int = 0
)
RETURNS TABLE
AS RETURN
(
	
	SELECT
		V.*
	FROM 
		DS11_variance V INNER JOIN DS01_WBS W ON V.WBS_ID = W.WBS_ID
	WHERE 
			V.upload_ID = @upload_ID
		AND W.upload_ID = @upload_ID
		AND narrative_type = '300'
		AND W.[type] <> 'CA'
)
```
