## Basic Information
| Key         | Value          |
|-------------|----------------|
| Table       | DS03 Cost |
| Severity    | MAJOR |
| Unique ID   | 1030109   |
| Summary     | Has EVT of type NA been selected for non-Control Account data? |
| Error message | EVT = NA on WP row or CA row not marked as type 'CA' in DS01 (WBS). |

## What causes this error?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
{.is-warning}

The Data Integrity and Quality (DIQ) check titled "Invalid Use of NA EVT" is designed to ensure that the Earned Value Technique (EVT) of type 'NA' is not being improperly used for non-Control Account data in the DS03 Cost table. 

The error message "EVT = NA on WP row or CA row not marked as type 'CA' in DS01 (WBS)" indicates that the EVT field in the DS03 Cost table has been set to 'NA' for a Work Package (WP) row or a Control Account (CA) row that is not marked as type 'CA' in the DS01 (WBS) table. 

This error is likely caused by incorrect data entry. The EVT field should not be set to 'NA' for WP rows or for CA rows that are not marked as type 'CA'. The expected value for the EVT field in these cases would be a valid EVT type other than 'NA'. 

To resolve this issue, review the data entries in the DS03 Cost table and the DS01 (WBS) table. Ensure that the EVT field is correctly set for each row, and that CA rows are properly marked as type 'CA' in the DS01 (WBS) table.
## Why do we check this?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
{.is-warning}

This test is being performed to ensure that the Earned Value Technique (EVT) of type 'NA' is not being used incorrectly in the DS03 Cost table. Specifically, it checks if 'NA' EVT has been selected for data that is not associated with a Control Account. The warning message indicates that there is an 'NA' EVT on a Work Package (WP) row or a Control Account (CA) row that is not marked as type 'CA' in the DS01 (WBS) table.

The importance of this check lies in maintaining the accuracy and consistency of the data. Using 'NA' EVT for non-Control Account data could lead to incorrect data interpretation and analysis, potentially causing issues in project management and decision-making processes. As this test has a severity of 'MAJOR', it implies that this issue, if not addressed, is likely to cause problems during data analysis.
## Code

```sql

CREATE FUNCTION [dbo].[fnDIQ_DS03_Cost_IsNAEVTBeingUsedImproperly] (
	@upload_id int = 0
)
RETURNS TABLE
AS RETURN
(
	
	SELECT 
		* 
	FROM 
		DS03_Cost
	WHERE
			upload_ID = @upload_ID
		AND EVT = 'NA'
		AND TRIM(ISNULL(WBS_ID_WP,'')) <> ''
)
```
