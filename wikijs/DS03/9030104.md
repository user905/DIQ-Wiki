## Basic Information
| Key         | Value          |
|-------------|----------------|
| Table       | DS03 Cost |
| Severity    | MAJOR |
| Unique ID   | 9030104   |
| Summary     | Is this Work Package or Package typed as something other than WP or PP in the WBS Dictionary? |
| Error message | WBS_ID_WP found DS01.WBS_ID where type <> PP or WP. |

## What causes this error?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
{.is-warning}

The Data Integrity and Quality (DIQ) check titled "WP or PP Type Mismatch with Type in WBS Dictionary" is designed to ensure that the Work Package (WP) or Planning Package (PP) types in the DS03 Cost table match the corresponding types in the DS01 WBS Dictionary. 

If an error is flagged by this DIQ check, it means that there is a mismatch between the WP or PP type in the DS03 Cost table and the DS01 WBS Dictionary. Specifically, the error is caused by the 'type' field in the DS01 WBS Dictionary containing a value other than 'WP' or 'PP'. 

The DIQ check identifies these mismatches by comparing the 'WBS_ID_WP' field in the DS03 Cost table with the 'WBS_ID' field in the DS01 WBS Dictionary. If the 'type' associated with a given 'WBS_ID' in the DS01 WBS Dictionary is neither 'WP' nor 'PP', the DIQ check will flag an error.

To resolve this issue, ensure that the 'type' field in the DS01 WBS Dictionary only contains 'WP' or 'PP' for each 'WBS_ID' that is also present in the DS03 Cost table. Any other values in the 'type' field will cause a mismatch and result in an error.
## Why do we check this?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
{.is-warning}

This test is being performed to ensure that the Work Package (WP) or Planning Package (PP) types in the DS03 Cost table match with the types specified in the WBS (Work Breakdown Structure) Dictionary. The test checks if there are any instances where the WP or PP type is something other than what is specified in the WBS Dictionary. 

The importance of this check is to maintain consistency and accuracy in the data. If the WP or PP types do not match with the WBS Dictionary, it could lead to confusion and errors in project management and cost analysis. This could potentially impact the overall project planning and execution. 

The severity of this test is marked as 'MAJOR', which means that while it may not prevent the data from being reviewed, it is likely to cause problems during analysis. Therefore, it is crucial to address this issue to ensure accurate and reliable data analysis.
## Code

```sql

CREATE FUNCTION [dbo].[fnDIQ_DS03_Cost_IsWPOrPPMistypedInDS01] (
	@upload_id int = 0
)
RETURNS TABLE
AS RETURN
(
    -- Insert statements for procedure here
	
	with NonWPPP as (
		SELECT WBS_ID 
		FROM DS01_WBS 
		WHERE upload_ID = @upload_ID AND [type] NOT IN ('WP','PP')
	)
	SELECT 
		* 
	FROM 
		DS03_Cost C INNER JOIN NonWPPP N ON C.WBS_ID_WP = N.WBS_ID
	WHERE 
		upload_ID = @upload_ID
)
```
