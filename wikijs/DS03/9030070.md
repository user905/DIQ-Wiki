## Basic Information
| Key         | Value          |
|-------------|----------------|
| Table       | DS03 Cost |
| Severity    | MINOR |
| Unique ID   | 9030070   |
| Summary     | Is there BAC, CV, or SV repgrogramming but not OTB/OTS Date? |
| Error message | BAC_rpg, CV_rpg, or SV_rpg <> 0 but without OTB_OTS_Date in DS07 (IPMR Header). |

## What causes this error?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
{.is-warning}

The Data Integrity and Quality (DIQ) check titled "Reprogramming Without OTB/OTS Date" is designed to identify potential issues in the DS03 Cost and DS07 IPMR Header tables. This check is specifically looking for instances where there is Budget at Completion (BAC), Cost Variance (CV), or Schedule Variance (SV) reprogramming (indicated by non-zero values in the BAC_rpg, CV_rpg, or SV_rpg fields in the DS03 Cost table) but there is no corresponding Over Target Baseline or Over Target Schedule (OTB/OTS) date in the DS07 IPMR Header table.

The error is likely caused by incomplete data entry or data processing errors. If there is reprogramming activity (BAC, CV, or SV), it is expected that an OTB/OTS date should be provided in the DS07 IPMR Header table. The absence of this date while there is reprogramming activity indicates a potential data integrity issue. 

To resolve this error, ensure that for every instance of reprogramming in the DS03 Cost table, there is a corresponding OTB/OTS date in the DS07 IPMR Header table.
## Why do we check this?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
{.is-warning}

This test is being performed to check for instances where there is Budget at Completion (BAC), Cost Variance (CV), or Schedule Variance (SV) reprogramming, but no corresponding Over Target Baseline (OTB) or Over Target Schedule (OTS) date. The test is looking for non-zero values in the BAC, CV, or SV reprogramming fields, but without a corresponding OTB/OTS date in the IPMR Header.

The importance of this check is to ensure that any changes to the budget or schedule are properly documented with an OTB/OTS date. This is crucial for maintaining accurate and reliable project management data. If changes are made to the budget or schedule without this documentation, it could lead to confusion, misinterpretation of data, and potential issues in project management and financial analysis.

The severity of this check is marked as an MINOR. This means that while it may not immediately prevent data from being reviewed, it could potentially cause minor problems or indicate that the data does not fully adhere to best practices. It's a signal that there may be room for improvement in the data entry or management process.
## Code

```sql

CREATE FUNCTION [dbo].[fnDIQ_DS03_Cost_DoesRPGExistWithoutDS07OTBOTSDate] (
	@upload_id int = 0
)
RETURNS TABLE
AS RETURN
(
	
    SELECT	*
    FROM	DS03_Cost
    WHERE	upload_ID = @upload_id
			AND (BAC_rpg <> 0 OR CV_rpg <> 0 OR SV_rpg <> 0)
			AND EXISTS(
				SELECT	*
				FROM	DS07_IPMR_header
				WHERE	upload_ID = @upload_id
						AND OTB_OTS_Date IS NULL
			)
)
```
