## Basic Information
| Key         | Value          |
|-------------|----------------|
| Table       | DS03 Cost |
| Severity    | MAJOR |
| Unique ID   | 9030083   |
| Summary     | Is this Control Account WBS ID typed as something other than CA in the WBS Dictionary? |
| Error message | WBS_ID_CA not in DS01.WBS_ID list where DS01.type = CA. |

## What causes this error?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
{.is-warning}

The Data Integrity and Quality (DIQ) check titled "CA Type Mismatched With WBS Dictionary" is designed to ensure that the Control Account Work Breakdown Structure (WBS) ID is correctly classified in the WBS Dictionary (DS01). 

This check is performed on the Cost table (DS03) and it verifies that each Control Account WBS ID (WBS_ID_CA) in DS03 is also listed in DS01 with the type 'CA'. If a WBS ID is found in DS03 that is not listed as 'CA' in DS01, this indicates a mismatch and the DIQ check will flag this as an error.

The likely cause of this error is an incorrect entry in the WBS Dictionary (DS01). This could be due to a typographical error when entering the data, or it could be that the WBS ID was incorrectly classified. The expected value for the 'type' field in DS01 for any WBS ID listed in DS03 as a Control Account should be 'CA'.

To resolve this issue, review the flagged WBS IDs in DS03 and cross-check them with the entries in DS01. Ensure that each WBS ID in DS03 is correctly listed as 'CA' in DS01. If any mismatches are found, correct the 'type' field in DS01 to 'CA'.
## Why do we check this?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
{.is-warning}

This test is being performed to ensure that the Control Account Work Breakdown Structure (WBS) ID is correctly classified as 'CA' in the WBS Dictionary. The test is checking if there are any instances where the WBS ID associated with a Control Account is not listed as 'CA' in the WBS Dictionary. 

The importance of this check is to maintain consistency and accuracy in the classification of WBS IDs. If a Control Account WBS ID is not correctly classified, it could lead to confusion and errors in project management and data analysis. 

The severity of this test is classified as a 'MAJOR', which means that while it may not prevent the data from being reviewed, it is likely to cause problems during analysis if not addressed. Therefore, it is crucial to correct any mismatches found during this test to ensure the integrity and quality of the EVMS construction project management data.
## Code

```sql

CREATE FUNCTION [dbo].[fnDIQ_DS03_Cost_IsCAMistypedInDS01] (
	@upload_id int = 0
)
RETURNS TABLE
AS RETURN
(
	
	SELECT 
		C.* 
	FROM 
		DS03_Cost C INNER JOIN DS01_WBS W ON C.WBS_ID_CA = W.WBS_ID
	WHERE 
			C.upload_ID = @upload_ID
		AND	W.upload_ID = @upload_ID
		AND W.[type] <> 'CA'
		AND ISNULL(EVT,'') <> 'K'
)
```
