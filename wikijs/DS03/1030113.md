## Basic Information
| Key         | Value          |
|-------------|----------------|
| Table       | DS03 Cost |
| Severity    | WARNING |
| Unique ID   | 1030113   |
| Summary     | Does this WP/PP mingle ODC with other EOC types (excluding Indirect)? |
| Error message | EOC = ODC & Material, Subcontract, or Labor by WBS_ID_WP. |

## What causes this error?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
{.is-warning}

This Data Integrity and Quality (DIQ) check is designed to identify instances within the DS03 Cost table where Other Direct Costs (ODC) are found alongside Non-Indirect Elements of Cost (EOC) types within the same Work Breakdown Structure (WBS) Work Package (WP) or Planning Package (PP). Specifically, it checks for the mingling of ODC with Material, Subcontract, or Labor costs by their WBS_ID_WP.

An error flagged by this DIQ check suggests that within a single WBS Work Package or Planning Package, costs categorized as ODC are being reported together with costs categorized under other direct cost types such as Material, Subcontract, or Labor. This is not standard practice as ODC should be distinctly categorized and not mixed with these other types of direct costs within the same WBS_ID_WP.

The likely cause of the error is incorrect categorization or entry of cost types within the DS03 Cost table. Each entry in the table should have a correct Element of Cost (EOC) designation that accurately reflects the nature of the cost. For example, costs should be distinctly categorized as either ODC, Material, Subcontract, Labor, or Indirect. The presence of ODC alongside other direct cost types within the same WBS_ID_WP indicates a potential misclassification or data entry error.

To resolve this issue, review the affected WBS Work Packages or Planning Packages to ensure that costs are correctly categorized. ODC should not be combined with Material, Subcontract, or Labor costs under the same WBS_ID_WP. Correcting the EOC categorization for each cost entry will help maintain the integrity and quality of the project management data.
## Why do we check this?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
{.is-warning}

This DIQ test is being performed on the 'DS03 Cost' table to ensure that Other Direct Costs (ODC) are not improperly combined with other types of Element of Costs (EOC), such as Material, Subcontract, or Labor, within the same Work Breakdown Structure ID for Work Packages (WBS_ID_WP). The purpose of this check is to maintain the integrity and clarity of cost reporting within the project management system. Mixing ODC with other EOC types (excluding Indirect costs) within the same work package or planning package can lead to confusion, misallocation of costs, and challenges in tracking and managing project finances effectively. The severity level of WARNING indicates that while this issue may not immediately invalidate the data, it is likely to cause problems during financial analysis, budgeting, and cost control processes. It is important to address this issue to ensure accurate and transparent financial reporting and to facilitate effective project management and oversight.
## Code

```sql

CREATE FUNCTION [dbo].[fnDIQ_DS03_Cost_IsODCComingledWithNonIndirectEOCs] (
	@upload_id int = 0
)
RETURNS TABLE
AS RETURN
(
	with NonODC AS (
		SELECT WBS_ID_WP WPID
		FROM DS03_cost
		WHERE upload_ID = @upload_ID AND EOC NOT IN ('ODC','Indirect') AND TRIM(ISNULL(WBS_ID_WP,'')) <> ''
		GROUP BY WBS_ID_WP
	)
	SELECT C.* 
	FROM DS03_Cost C LEFT OUTER JOIN NonODC N ON C.WBS_ID_WP = N.WPID
	WHERE	upload_ID = @upload_ID AND EOC = 'ODC' AND N.WPID IS NOT NULL
)
```
