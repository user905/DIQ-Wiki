## Basic Information
| Key         | Value          |
|-------------|----------------|
| Table       | DS03 Cost |
| Severity    | MAJOR |
| Unique ID   | 1030117   |
| Summary     | Does this WP/PP mingle Labor with other EOC types (excluding Indirect)? |
| Error message | EOC = Labor & Material, Subcontract, or ODC by WBS_ID_WP. |

## What causes this error?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
{.is-warning}

This Data Integrity and Quality (DIQ) check is designed to ensure that within the DS03 Cost table, work packages or planning packages (WP/PP) are not improperly combining labor costs with other types of expenses, excluding indirect costs. Specifically, it verifies that labor is not being reported alongside material, subcontract, or other direct costs (ODC) under the same WBS (Work Breakdown Structure) ID for work packages or planning packages.

The error highlighted by this check suggests that there are instances where labor expenses are being mixed with other direct expenses such as materials, subcontracts, or ODCs within the same work package or planning package. This is not in alignment with proper cost reporting practices, as labor and these other types of expenses should be tracked separately to maintain clear visibility into the different kinds of costs incurred on a project.

The fields involved in this issue are primarily the `WBS_ID_WP` which identifies the work package or planning package, and the `EOC` (Element of Cost) which categorizes the type of expense (e.g., Labor, Material, Subcontract, ODC). The expected behavior is that for any given `WBS_ID_WP`, costs categorized under `EOC` as 'Labor' should not be combined with costs categorized as 'Material', 'Subcontract', or 'ODC'. Indirect costs are excluded from this check and thus do not contribute to the issue.

To resolve this error, review the cost entries in the DS03 Cost table to ensure that labor costs are segregated from material, subcontract, and ODC costs within each work package or planning package. This may involve adjusting the categorization of costs or splitting costs into separate work packages or planning packages to accurately reflect the nature of the expenses.
## Why do we check this?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
{.is-warning}

This DIQ test, titled "Labor Found Alongside Non-Indirect EOC," is performed on the "DS03 Cost" table to ensure that work packages (WP) or planning packages (PP) do not improperly combine labor costs with other types of Elements of Cost (EOC), excluding indirect costs, within the same Work Breakdown Structure ID (WBS_ID_WP). The test is flagged with a severity of MAJOR, indicating that while the issue does not make the data unusable, it is likely to cause problems during analysis if not addressed.

The importance of this check lies in maintaining the integrity and clarity of cost reporting and management within the project. Proper segregation of labor from other direct costs like materials, subcontracts, or Other Direct Costs (ODC) is crucial for accurate cost tracking, budgeting, and financial analysis. Mixing labor with other EOC types could lead to misinterpretation of cost data, hinder accurate performance measurement, and potentially affect decision-making processes. By identifying and correcting instances where labor is improperly combined with other direct costs, the project can ensure more reliable and transparent financial reporting, which is essential for effective project management and compliance with financial standards and regulations.
## Code

```sql

CREATE FUNCTION [dbo].[fnDIQ_DS03_Cost_IsLaborComingledWithNonIndirectEOCs] (
	@upload_id int = 0
)
RETURNS TABLE
AS RETURN
(
	with NonLbr AS (
		SELECT WBS_ID_WP WPID
		FROM DS03_cost
		WHERE upload_ID = @upload_ID AND EOC NOT IN ('Labor','Indirect') AND TRIM(ISNULL(WBS_ID_WP,'')) <> ''
		GROUP BY WBS_ID_WP
	)
	SELECT C.* 
	FROM DS03_Cost C LEFT OUTER JOIN NonLbr N ON C.WBS_ID_WP = N.WPID
	WHERE	upload_ID = @upload_ID AND EOC = 'Labor' AND N.WPID IS NOT NULL
)
```
