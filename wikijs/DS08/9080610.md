## Basic Information
| Key         | Value          |
|-------------|----------------|
| Table       | DS08 WAD |
| Severity    | MAJOR |
| Unique ID   | 9080610   |
| Summary     | Is this PM-authorized WAD missing in the WBS Dictionary (by either WP WBS ID if it exists, or the CA WBS ID)? |
| Error message | WBS_ID_CA or WBS_ID_WP missing from DS01.WBS_ID list (where DS08.auth_PM_date is populated). |

## What causes this error?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
{.is-warning}

The Data Integrity and Quality (DIQ) check titled "WAD Missing In WBS Dictionary" is designed to ensure that all Project Manager (PM)-authorized Work Authorization Documents (WADs) are correctly listed in the Work Breakdown Structure (WBS) Dictionary. This check is performed on the DS08 WAD table.

The error message "WBS_ID_CA or WBS_ID_WP missing from DS01.WBS_ID list (where DS08.auth_PM_date is populated)" indicates that there is a WAD that has been authorized by a PM (as indicated by a populated auth_PM_date field in DS08), but the corresponding WBS ID is not found in the WBS Dictionary (DS01).

The fields causing the issue are the WBS_ID_CA and WBS_ID_WP fields in the DS08 WAD table. These fields should contain the WBS IDs that correspond to the WADs. The expected values for these fields are the WBS IDs that exist in the DS01 WBS Dictionary.

If this error occurs, it suggests that there is a discrepancy between the WADs that have been authorized by the PM and the WBS IDs listed in the WBS Dictionary. This could be due to a data entry error, or it could indicate that the WBS Dictionary needs to be updated to include the WBS IDs for the PM-authorized WADs.
## Why do we check this?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
{.is-warning}

This test is being performed to ensure that the Work Authorization Document (WAD) is correctly referenced in the Work Breakdown Structure (WBS) Dictionary. The WAD is a crucial document in project management that authorizes the work to be done. It is identified by either the Work Package (WP) WBS ID or the Control Account (CA) WBS ID. The test checks if these IDs are missing from the WBS ID list in the DS01 table, specifically where the PM-authorized date in the DS08 table is populated.

The importance of this check is to ensure that all authorized work is properly documented and traceable in the WBS Dictionary. This is crucial for project management, as it helps in tracking project progress, costs, and performance. If the WAD is missing from the WBS Dictionary, it could lead to issues in project tracking and management, potentially causing delays, cost overruns, or performance issues. 

The severity of this check is marked as a MAJOR, which means that while it may not immediately prevent the data from being reviewed, it is likely to cause problems during analysis. It is therefore important to address this issue to ensure accurate and efficient project management.
## Code

```sql

CREATE FUNCTION [dbo].[fnDIQ_DS08_WAD_IsPMAuthorizedWADMissingInDS01] (
	@upload_id int = 0
)
RETURNS TABLE
AS RETURN
(
	
	with WBSDict as (
		SELECT WBS_ID
		FROM DS01_WBS
		WHERE upload_ID = @upload_ID
	)
	SELECT 
		*
	FROM
		DS08_WAD
	WHERE
			upload_ID = @upload_ID  
		AND auth_PM_date IS NOT NULL
		AND (
				TRIM(ISNULL(WBS_ID_WP,'')) <> '' AND WBS_ID_WP NOT IN (SELECT WBS_ID FROM WBSDict) 
			OR 	WBS_ID NOT IN (SELECT WBS_ID FROM WBSDict)
		)
)
```
