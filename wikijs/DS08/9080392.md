## Basic Information
| Key         | Value          |
|-------------|----------------|
| Table       | DS08 WAD |
| Severity    | MAJOR |
| Unique ID   | 9080392   |
| Summary     | Are the ODC budget dollars for this CA WAD misaligned with what is in cost? |
| Error message | budget_ODC_dollars <> SUM(DS03.BCWSi_dollars) where EOC = ODC (by WBS_ID_CA). |

## What causes this error?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
{.is-warning}

The Data Integrity and Quality (DIQ) check titled "CA ODC Dollars Misaligned With Cost" is designed to ensure that the Other Direct Costs (ODC) budget dollars for a Control Account (CA) Work Authorization Document (WAD) in DS08 WAD table align with the corresponding costs in the DS03 Cost table.

The test checks for discrepancies between the 'budget_ODC_dollars' field in the DS08 WAD table and the sum of 'BCWSi_dollars' in the DS03 Cost table for each Control Account (CA), where the Element of Cost (EOC) is 'ODC'. The test is performed by grouping the data by 'WBS_ID_CA' (Work Breakdown Structure ID for Control Account).

If the test fails, it indicates that the ODC budget dollars for a particular CA WAD do not match the corresponding costs in the DS03 Cost table. This could be due to data entry errors, incorrect cost calculations, or misalignment between budget and actual costs. 

To resolve this issue, you should review the budget and cost data for the affected Control Account, ensuring that the ODC budget dollars in the DS08 WAD table match the sum of 'BCWSi_dollars' in the DS03 Cost table where the EOC is 'ODC'.
## Why do we check this?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
{.is-warning}

This test is being performed to ensure that the Other Direct Costs (ODC) budget dollars for a particular Control Account (CA) Work Authorization Document (WAD) align with the costs recorded in the system. The test is comparing the budgeted ODC dollars to the sum of the Budgeted Cost of Work Scheduled (BCWS) dollars where the Element of Cost (EOC) is ODC, grouped by the Work Breakdown Structure ID for the Control Account (WBS_ID_CA).

The importance of this check is to ensure that the budgeted and actual costs are in alignment. If they are not, it could indicate a problem with budgeting or cost recording, which could lead to financial discrepancies and mismanagement. This could potentially cause problems during analysis, hence the severity is marked as a MAJOR. It's crucial to address this issue to maintain accurate financial tracking and project management.
## Code

```sql

CREATE FUNCTION [dbo].[fnDIQ_DS08_WAD_AreODCDollarsMisalignedWithDS03CA] (
	@upload_id int = 0
)
RETURNS TABLE
AS RETURN
(
	
	with ODCCA as (
		SELECT WBS_ID_CA, SUM(BCWSi_dollars) BCWSc
		FROM DS03_cost
		WHERE upload_ID = @upload_ID AND EOC = 'ODC'
		GROUP BY WBS_ID_CA
	)
	SELECT 
		W.*
	FROM
		DS08_WAD W INNER JOIN ODCCA C 	ON W.WBS_ID = C.WBS_ID_CA
										AND budget_ODC_dollars <> C.BCWSc			
	WHERE
			upload_ID = @upload_ID  
		AND TRIM(ISNULL(W.WBS_ID_WP,'')) = ''
)
```
