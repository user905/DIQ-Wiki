## Basic Information
| Key         | Value          |
|-------------|----------------|
| Table       | DS08 WAD |
| Severity    | MAJOR |
| Unique ID   | 9080620   |
| Summary     | Is this WAD a WBS type WBS element in the WBS dictionary? |
| Error message | WBS_ID or WBS_ID_WP in DS01.WBS_ID list where DS01.type = WBS. |

## What causes this error?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
{.is-warning}

The Data Integrity and Quality (DIQ) check titled "WBS Type WAD" is designed to verify the consistency of the Work Breakdown Structure (WBS) identifiers in the DS08 WAD table. This check ensures that each WBS identifier in the DS08 WAD table is also listed as a WBS type in the DS01 WBS dictionary.

The fields under scrutiny in this check are 'WBS_ID' and 'WBS_ID_WP' in the DS08 WAD table. The expected values for these fields are any WBS identifiers that are listed in the DS01 WBS dictionary where the type is 'WBS'. 

If an error is flagged by this DIQ check, it is likely due to a mismatch between the WBS identifiers in the DS08 WAD table and the DS01 WBS dictionary. This could occur if a new WBS identifier is added to the DS08 WAD table but not updated in the DS01 WBS dictionary, or if a WBS identifier is incorrectly typed in the DS08 WAD table. 

To resolve this issue, ensure that all WBS identifiers in the DS08 WAD table are correctly listed as a WBS type in the DS01 WBS dictionary.
## Why do we check this?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
{.is-warning}

This test is being performed on the 'DS08 WAD' table to verify if the Work Authorization Document (WAD) is a Work Breakdown Structure (WBS) type WBS element as per the WBS dictionary. The test checks if the WBS_ID or WBS_ID_WP in the DS01.WBS_ID list is of the type 'WBS'. 

The importance of this check is to ensure that the WADs are correctly classified as per the WBS dictionary. This is crucial for maintaining the integrity of the project management data, as misclassification can lead to incorrect data analysis and project management decisions. 

The severity of this check is marked as 'MAJOR', which means that if this issue is not addressed, it is likely to cause problems during data analysis. It may not stop the data from being reviewed, but it can potentially lead to inaccurate results and interpretations. Therefore, it is recommended to address this issue to ensure the accuracy and reliability of the project management data.
## Code

```sql

CREATE FUNCTION [dbo].[fnDIQ_DS08_WAD_IsWADOfDS01TypeWBS] (
	@upload_id int = 0
)
RETURNS TABLE
AS RETURN
(
	
	with WBSTypes as (
		SELECT WBS_ID 
		FROM DS01_WBS 
		WHERE upload_ID = @upload_ID AND type = 'WBS'
	)
	SELECT 
		*
	FROM
		DS08_WAD
	WHERE
			upload_ID = @upload_ID
		AND (
				WBS_ID_WP IN (SELECT WBS_ID FROM WBSTypes) OR
				WBS_ID IN (SELECT WBS_ID FROM WBSTypes)
		)
)
```
