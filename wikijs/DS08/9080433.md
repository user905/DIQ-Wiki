## Basic Information
| Key         | Value          |
|-------------|----------------|
| Table       | DS08 WAD |
| Severity    | WARNING |
| Unique ID   | 9080433   |
| Summary     | Are the indirect budget dollars for this WP/PP WAD missing in cost? |
| Error message | budget_indirect_dollars > 0 & DS03.BCWSi_dollars = 0 where EOC = indirect (by WBS_ID_WP). |

## What causes this error?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
{.is-warning}

This Data Integrity and Quality (DIQ) check is designed to ensure that all Work Packages (WPs) or Planning Packages (PPs) within the Work Authorization Document (DS08 WAD) that are allocated indirect budget dollars actually have corresponding indirect cost data in the cost table (DS03 Cost). Specifically, the check identifies instances where a WP or PP has been assigned indirect budget dollars (budget_indirect_dollars > 0) but does not have any indirect cost planned (BCWSi_dollars = 0) for those indirect activities, as indicated by the Element of Cost (EOC) being classified as 'Indirect'.

The likely cause of errors flagged by this check could be due to discrepancies in the planning or recording of indirect costs. This might happen if indirect costs were budgeted for a WP or PP but were not properly planned or recorded in the cost table, or if there was a misclassification of the EOC as direct instead of indirect. The fields causing the issue are primarily `budget_indirect_dollars` in DS08 WAD, which should not be greater than zero when `BCWSi_dollars` in DS03 Cost is zero for WPs or PPs classified as indirect (either by EOC being 'Indirect' or the `is_indirect` flag being 'Y').

To resolve these errors, users should review and ensure that all indirect costs are accurately planned and recorded in the cost table for all WPs or PPs with allocated indirect budget dollars. This may involve correcting the classification of costs as indirect where necessary, and ensuring that all planned indirect costs are reflected in the BCWSi_dollars field for the relevant WPs or PPs.
## Why do we check this?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
{.is-warning}

This DIQ test, titled "WP Indirect Dollars Missing In Cost," is being performed on the DS08 WAD table to check for the presence of indirect budget dollars for Work Packages (WP) or Planning Packages (PP) within the Work Authorization Document (WAD). The test is specifically looking for instances where there is a recorded indirect budget (budget_indirect_dollars > 0) but no corresponding indirect budgeted cost of work scheduled (BCWSi_dollars = 0) for the same WP/PP, identified by WBS_ID_WP, where the end of cost (EOC) type is indirect.

The importance of this check lies in ensuring that all indirect costs associated with a WP or PP are accurately captured and reflected in the project's cost management system. Indirect costs, such as overheads and administrative expenses, are crucial for a comprehensive understanding of the total project costs. Missing indirect cost data can lead to underestimation of the project budget, misallocation of resources, and potential project overruns. This test is flagged with a severity of WARNING, indicating that while the issue does not immediately invalidate the data, it is likely to cause problems during project cost analysis and management. Addressing this issue is important for maintaining the accuracy and reliability of the project's financial data, which in turn supports effective project management and decision-making.
## Code

```sql

CREATE FUNCTION [dbo].[fnDIQ_DS08_WAD_IsIndirectBudgetMissingInDS03WP] (
	@upload_id int = 0
)
RETURNS TABLE
AS RETURN
(
	with IndirectWPs as (
		SELECT WBS_ID_WP
		FROM DS03_cost
		WHERE upload_ID = @upload_ID AND (EOC = 'Indirect' OR is_indirect = 'Y') AND BCWSi_dollars <> 0 AND TRIM(ISNULL(WBS_ID_WP,'')) <> ''
	), NonIndirectWP as (
		SELECT DISTINCT WBS_ID_WP
		FROM DS03_cost
		WHERE upload_ID = @upload_ID AND WBS_ID_WP NOT IN (SELECT WBS_ID_WP FROM IndirectWPs)
	)
	SELECT 
		W.*
	FROM
		DS08_WAD W INNER JOIN NonIndirectWP C ON W.WBS_ID_WP = C.WBS_ID_WP
	WHERE
			upload_ID = @upload_ID  
		AND budget_indirect_dollars <> 0
		AND TRIM(ISNULL(W.WBS_ID_WP,'')) <> ''
)
```
