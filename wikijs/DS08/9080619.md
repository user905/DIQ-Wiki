## Basic Information
| Key         | Value          |
|-------------|----------------|
| Table       | DS08 WAD |
| Severity    | MAJOR |
| Unique ID   | 9080619   |
| Summary     | Is the POP Start for this Work Package WAD after the schedule forecast start? |
| Error message | POP_start_date > DS04.ES_date where schedule_type = BL (compare by DS08.WBS_ID_WP & DS04.WBS_ID). |

## What causes this error?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
{.is-warning}

The Data Integrity and Quality (DIQ) check titled "POP Start After Schedule Forecast Start (WP)" is designed to ensure that the Planned Operation Period (POP) start date for a Work Package (WP) in the DS08 Work Authorization Document (WAD) table does not occur after the schedule forecast start date in the DS04 Schedule table.

The error message "POP_start_date > DS04.ES_date where schedule_type = BL" indicates that the POP start date for a WP is later than the earliest schedule (ES) date for the same WP in the DS04 Schedule table, where the schedule type is 'BL' (Baseline).

The fields causing the issue are the 'POP_start_date' in the DS08 WAD table and the 'ES_date' in the DS04 Schedule table. The expected values should be such that the 'POP_start_date' for a WP should not be later than the 'ES_date' for the same WP in the DS04 Schedule table.

If this error occurs, it suggests that there may be a discrepancy in the planning of the work package, as the planned operation period should not start after the forecasted start date. This could be due to a data entry error or a misalignment in project scheduling. It is recommended to review and correct the dates in the DS08 WAD and DS04 Schedule tables to ensure accurate project management data.
## Why do we check this?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
{.is-warning}

This test is being performed to ensure that the Planned Operation Period (POP) start date for a particular Work Package (WP) in the DS08 WAD table does not occur after the schedule forecast start date. The test compares the POP start date with the DS04.ES_date where the schedule type is BL, using the DS08.WBS_ID_WP & DS04.WBS_ID for comparison.

The importance of this check is to maintain the integrity and accuracy of the project schedule. If the POP start date is after the forecasted start date, it could indicate a delay in the project schedule or an error in data entry. This could potentially lead to issues in project management and decision-making processes. 

The severity of this check is marked as a MAJOR. This means that while it may not prevent the data from being reviewed, it is likely to cause problems during analysis. It is crucial to address this issue to ensure accurate project scheduling and effective project management.
## Code

```sql

CREATE FUNCTION [dbo].[fnDIQ_DS08_WAD_IsPOPStartAfterDS04ESDateWP] (
	@upload_id int = 0
)
RETURNS TABLE
AS RETURN
(
	
	with SchedStart as (
		--Get the first BL ES date by WP/PP ID from DS04 joined to AncestryTree.
		SELECT WBS_ID, MIN(ES_date) ES
		FROM DS04_schedule
		WHERE upload_ID = @upload_ID AND schedule_type = 'BL'
		GROUP BY WBS_ID
	)
	SELECT 
		W.*
	FROM
		DS08_WAD W 	INNER JOIN LatestWPWADRev_Get(@upload_ID) R ON W.WBS_ID_WP = R.WBS_ID_WP 
																AND W.auth_PM_date = R.PMauth
					INNER JOIN SchedStart S ON W.WBS_ID_WP = S.WBS_ID
											AND W.POP_start_date > S.ES
	WHERE
		upload_ID = @upload_ID
)
```
