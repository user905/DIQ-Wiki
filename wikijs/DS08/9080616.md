## Basic Information
| Key         | Value          |
|-------------|----------------|
| Table       | DS08 WAD |
| Severity    | MAJOR |
| Unique ID   | 9080616   |
| Summary     | Is the POP Start for this CA WAD after the schedule actual start? |
| Error message | POP_start_date > DS04.AS_date where schedule_type = FC (compare by DS08.WBS_ID, DS01.WBS_ID, DS01.parent_WBS_ID, & DS04.WBS_ID). |

## What causes this error?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
{.is-warning}

The Data Integrity and Quality (DIQ) check titled "POP Start After Schedule Actual Start (CA)" is designed to ensure that the Period of Performance (POP) start date for a Control Account (CA) Work Authorization Document (WAD) in DS08 WAD table does not occur after the actual start date of the schedule in DS04 Schedule table.

The test compares the POP start date (POP_start_date) in DS08 WAD table with the actual start date (AS_date) in DS04 Schedule table for each Control Account (CA) or Sub-Level Project Plan (SLPP) where the schedule type is 'FC'. The comparison is done based on the Work Breakdown Structure (WBS) ID in DS08 WAD, DS01 WBS, DS01 parent WBS, and DS04 Schedule tables.

If the test finds any instances where the POP start date is later than the actual start date of the schedule, it will flag these as errors. This could be caused by incorrect data entry in either the DS08 WAD or DS04 Schedule tables. The expected values should be such that the POP start date is either the same or earlier than the actual start date of the schedule.

Please note that this test excludes Work Package (WP) level WADs. Therefore, any errors flagged by this test will be related to CA or SLPP level data.
## Why do we check this?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
{.is-warning}

This test is being performed to ensure that the Period of Performance (POP) start date for a given Control Account Work Authorization Document (CA WAD) does not occur after the actual start date of the schedule. The test is comparing the POP start date with the actual start date from the DS04 table, specifically for schedules of type FC. The comparison is made by matching the Work Breakdown Structure (WBS) IDs across the DS08, DS01, and DS04 tables.

The importance of this check lies in maintaining the accuracy and consistency of project scheduling data. If the POP start date is after the actual start date, it could indicate a discrepancy in the project timeline, which could lead to potential issues in project management and execution. This could also affect the accuracy of project performance analysis and forecasting.

The severity of this check is marked as a MAJOR. This means that while it may not prevent the data from being reviewed, such an issue is likely to cause problems during the analysis of the data. Therefore, it is recommended to address this issue to ensure the reliability and accuracy of the project management data.
## Code

```sql

CREATE FUNCTION [dbo].[fnDIQ_DS08_WAD_IsPOPStartAfterDS04ASDateCA] (
	@upload_id int = 0
)
RETURNS TABLE
AS RETURN
(
	
	with SchedStart as (
		--Get the first BL ES date by CA/SLPP ID from DS04 joined to AncestryTree.
		SELECT A.Ancestor_WBS_ID CAWBS, MIN(AS_date) ActS
		FROM 
			DS04_schedule S INNER JOIN AncestryTree_Get(@upload_ID) A ON S.WBS_ID = A.WBS_ID
		WHERE
				S.upload_ID = @upload_ID
			AND A.[Type] IN ('WP','PP')
			AND A.Ancestor_Type IN ('CA','SLPP')
			AND S.schedule_type = 'FC'
		GROUP BY A.Ancestor_WBS_ID
	)
	SELECT 
		W.*
	FROM
		DS08_WAD W 	INNER JOIN LatestCAWADRev_Get(@upload_ID) R ON W.WBS_ID = R.WBS_ID AND W.auth_PM_date = R.PMauth
					INNER JOIN SchedStart S ON W.WBS_ID = S.CAWBS
	WHERE
			W.upload_ID = @upload_ID
		AND TRIM(ISNULL(W.WBS_ID_WP,'')) = '' -- filter out WP-level WADs
		AND W.POP_start_date > S.ActS
)
```
