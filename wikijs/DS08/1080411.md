## Basic Information
| Key         | Value          |
|-------------|----------------|
| Table       | DS08 WAD |
| Severity    | MINOR |
| Unique ID   | 1080411   |
| Summary     | Is the initial authorization date for this WAD after the PM date? |
| Error message | initial_auth_date > auth_PM_date (for earliest WAD revision). |

## What causes this error?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
{.is-warning}

The Data Integrity and Quality (DIQ) check titled "Initial Authorization After PM Authorization" is performed on the DS08 WAD table. This check is designed to ensure that the initial authorization date for a Work Authorization Document (WAD) is not set after the Project Manager's (PM) authorization date.

If this DIQ check fails, it indicates that there are instances where the initial authorization date for a WAD is later than the PM's authorization date. This is not expected as the initial authorization should ideally occur before or at the same time as the PM's authorization.

The fields causing this issue are 'initial_auth_date' and 'auth_PM_date'. The 'initial_auth_date' should be a date that is either the same or earlier than the 'auth_PM_date'. If the 'initial_auth_date' is later than the 'auth_PM_date', this will trigger the DIQ check error.

To resolve this issue, review the dates in the 'initial_auth_date' and 'auth_PM_date' fields for the earliest WAD revision. Ensure that the initial authorization date is not set after the PM's authorization date.
## Why do we check this?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
{.is-warning}

This test is being performed to ensure that the initial authorization date for a Work Authorization Document (WAD) in the DS08 WAD table is not set after the Project Manager's (PM) authorization date. The test checks if the 'initial_auth_date' is greater than the 'auth_PM_date' for the earliest WAD revision. 

The importance of this check is to maintain the chronological order of authorizations in the project management process. It ensures that the initial authorization for any work is not given after the PM has already authorized it, which could lead to confusion or mismanagement in the project timeline. 

The severity of this test is marked as an MINOR. This means that while it's not a critical error that would prevent data from being reviewed, it could potentially cause minor problems or indicate that the data doesn't follow all best practices. It's a signal to review the authorization dates and correct any discrepancies to ensure the integrity and quality of the project management data.
## Code

```sql

CREATE FUNCTION [dbo].[fnDIQ_DS08_WAD_IsInitialAuthGtPMAuth] (
	@upload_id int = 0
)
RETURNS TABLE
AS RETURN
(
	
	SELECT 
		W.*
	FROM
		DS08_WAD W INNER JOIN EarliestWPWADRev_Get(@upload_ID) R ON W.WBS_ID = R.WBS_ID
																 AND ISNULL(W.WBS_ID_WP,'') = R.WBS_ID_WP
																 AND W.auth_PM_date = R.PMAuth
																 AND W.initial_auth_date > R.PMAuth
	WHERE
		upload_ID = @upload_ID  
)
```
