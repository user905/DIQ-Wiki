## Basic Information
| Key         | Value          |
|-------------|----------------|
| Table       | DS18 Sched EU |
| Severity    | CRITICAL |
| Unique ID   | 1180590   |
| Summary     | Is this schedule EU task duplicated by task ID & schedule type? |
| Error message | Count of task_ID & schedule_type combo > 1. |

## What causes this error?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
{.is-warning}

The Data Integrity and Quality (DIQ) check titled "Duplicate Schedule EU Task" is designed to identify any instances where the same task ID and schedule type combination appears more than once in the DS18 Sched EU table. This is important because each task ID and schedule type combination should be unique within the dataset.

If this DIQ check identifies an issue, it is likely because there are duplicate entries in the DS18 Sched EU table. This could be due to a data entry error, a system glitch, or a problem with the data import process. 

The fields causing the issue are the task_ID and schedule_type fields. The expected values for these fields are any valid task ID and schedule type, but each combination of these two fields should only appear once in the DS18 Sched EU table. 

If the DIQ check identifies duplicates, you will need to investigate the source of the duplication and correct it to ensure the integrity and quality of the project management data.
## Why do we check this?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
{.is-warning}

This test is being performed to check for duplicate entries in the 'DS18 Sched EU' table for the same task ID and schedule type. The presence of duplicate entries can lead to incorrect calculations, misinterpretations, and errors in the project management data. 

The severity of this test is marked as 'CRITICAL', which is the highest level of severity. This means that if this issue is not resolved, the data cannot be reviewed or used for further analysis. 

The importance of this check lies in maintaining the integrity and accuracy of the data. Duplicate entries can distort the true picture of the project's progress and status, leading to incorrect decisions and strategies. Therefore, it is crucial to identify and eliminate any duplicate entries to ensure the reliability and validity of the data.
## Code

```sql

CREATE FUNCTION [dbo].[fnDIQ_DS18_Sched_EU_PK] (
	@upload_id int = 0
)
RETURNS TABLE
AS RETURN
(
	
	with Dupes as (
		SELECT task_ID, schedule_type
		FROM DS18_schedule_EU
		WHERE upload_ID = @upload_ID
		GROUP BY task_ID, schedule_type
		HAVING COUNT(*) > 1
	)
	SELECT 
		E.*
	FROM 
		DS18_schedule_EU E INNER JOIN Dupes D ON E.task_ID = D.task_ID 
											 AND E.schedule_type = D.schedule_type
	WHERE 
		upload_ID = @upload_ID
)
```
