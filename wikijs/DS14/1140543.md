## Basic Information
| Key         | Value          |
|-------------|----------------|
| Table       | DS14 HDV-CI |
| Severity    | CRITICAL |
| Unique ID   | 1140543   |
| Summary     | Is the HDV-CI duplicated? |
| Error message | Count of HDV_CI_ID > 1. |

## What causes this error?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
{.is-warning}

The Data Integrity and Quality (DIQ) check titled "Duplicate HDV-CI ID" is designed to identify any instances where the HDV-CI ID in the DS14 HDV-CI table is duplicated. 

The HDV-CI ID is a unique identifier and should not be repeated within the dataset. If the DIQ check identifies a count of HDV_CI_ID greater than 1, this indicates that there are duplicate entries in the data.

The likely cause of this error is a data entry issue where the same HDV-CI ID has been used for more than one record. This could be due to a mistake during data input or a problem with the data import process.

To resolve this issue, each HDV-CI ID should be reviewed to ensure it is unique and correctly associated with a single record. Any duplicates should be corrected or removed to ensure the integrity and quality of the data.
## Why do we check this?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
{.is-warning}

This test is being performed to check for duplicate HDV-CI IDs in the 'DS14 HDV-CI' table. The presence of duplicate IDs can lead to confusion and errors in data analysis, as each ID should be unique and correspond to a single entry. This is a critical issue, hence the severity level is marked as 'CRITICAL'. This means that the issue must be resolved before the data can be reviewed. The importance of this check is to ensure the uniqueness of each HDV-CI ID, which is crucial for accurate data analysis and interpretation. If not addressed, it could lead to incorrect conclusions or decisions based on the data.
## Code

```sql

CREATE FUNCTION [dbo].[fnDIQ_DS14_HDV_CI_PK] (
	@upload_id int = 0
)
RETURNS TABLE
AS RETURN
(
	
	SELECT 
		*
	FROM 
		DS14_HDV_CI
	WHERE 
			upload_ID = @upload_ID 
		AND HDV_CI_ID IN (
			SELECT HDV_CI_ID 
			FROM DS14_HDV_CI 
			WHERE upload_ID = @upload_ID 
			GROUP BY HDV_CI_ID 
			HAVING COUNT(*) > 1
		)
)
```
