## Basic Information
| Key         | Value          |
|-------------|----------------|
| Table       | DS14 HDV-CI |
| Severity    | MAJOR |
| Unique ID   | 9140539   |
| Summary     | Is this combo subcontract PO & subcontract ID misaligned with what is in the subcontract data? |
| Error message | Combo of subK_PO_ID & subK_ID <> combo of DS13.subK_PO_ID & DS13.subK_ID. |

## What causes this error?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
{.is-warning}

The Data Integrity and Quality (DIQ) check titled "Subcontract PO & Subcontract ID Combo Misaligned with Subcontract Work Data" is designed to ensure that the combination of Subcontract Purchase Order (PO) ID and Subcontract ID in the DS14 HDV-CI table aligns with the same combination in the DS13 Subcontract Work Data table.

If an error is flagged by this DIQ check, it indicates that there is a mismatch between the Subcontract PO ID and Subcontract ID combination in the DS14 HDV-CI table and the DS13 Subcontract Work Data table. This could be due to a data entry error or a misalignment in the data update process between the two tables.

The fields causing the issue are the Subcontract PO ID (subK_PO_ID) and Subcontract ID (subK_ID) in both tables. The expected values for these fields in the DS14 HDV-CI table should match exactly with the corresponding fields in the DS13 Subcontract Work Data table. 

To resolve this issue, you should review the data entry process for these fields and ensure that the Subcontract PO ID and Subcontract ID are correctly and consistently entered in both tables.
## Why do we check this?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
{.is-warning}

This test is being performed to ensure that the combination of subcontract purchase order (PO) and subcontract ID in the 'DS14 HDV-CI' table aligns with the corresponding data in the 'DS13' table. The alignment of these data points is crucial for maintaining consistency and accuracy across different data sets. 

The importance of this check lies in its potential to identify discrepancies between related data sets. If the subcontract PO and subcontract ID do not match between the two tables, it could lead to confusion, misinterpretation of data, and potential errors in project management decisions. 

The severity of this issue is marked as a 'MAJOR', which means that while it may not immediately prevent the data from being reviewed, it is likely to cause problems during data analysis. Therefore, it is recommended to address this issue promptly to ensure the integrity and quality of the EVMS construction project management data.
## Code

```sql

CREATE FUNCTION [dbo].[fnDIQ_DS14_HDV_CI_AreSubKAndSubKPOIDComboMisalignedWithDS13] (
	@upload_id int = 0
)
RETURNS TABLE
AS RETURN
(
	
	SELECT 
		C.*
	FROM 
		DS14_HDV_CI C INNER JOIN DS13_subK S ON C.subK_ID = S.subK_ID AND C.subK_PO_ID <> S.subK_PO_ID
	WHERE 
			C.upload_ID = @upload_ID 
		AND S.upload_ID = @upload_ID
)
```
