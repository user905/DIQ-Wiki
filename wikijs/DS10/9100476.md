## Basic Information
| Key         | Value          |
|-------------|----------------|
| Table       | DS10 CC Log Detail |
| Severity    | MAJOR |
| Unique ID   | 9100476   |
| Summary     | Is the POP start for this Work Package misaligned with what is in the WAD? |
| Error message | POP_start_date <> DS08.POP_start_date (select latest revision; check is on WP/PP level). |

## What causes this error?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
{.is-warning}

The Data Integrity and Quality (DIQ) check titled "POP Start Misaligned with WAD (WP)" is designed to ensure that the Period of Performance (POP) start date for a given Work Package (WP) in the DS10 CC Log Detail table aligns with the corresponding POP start date in the DS08 WAD table. 

The test is performed at the WP/PP level and grouped by the Work Breakdown Structure ID (WBS_ID). The test compares the POP_start_date field in the DS10 CC Log Detail table with the POP_start_date field in the DS08 WAD table for the latest revision of the Work Authorization Document (WAD). 

If the test returns a result, it indicates that there is a misalignment between the POP start dates in the two tables. This could be due to an error in data entry, a delay in updating one of the tables, or a discrepancy in the dates authorized by the Project Manager. 

To resolve this issue, you should review the relevant entries in both tables and ensure that the POP start dates are correctly aligned. If necessary, update the POP start date in the DS10 CC Log Detail table or the DS08 WAD table to match the other.
## Why do we check this?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
{.is-warning}

This test is being performed to ensure that the Period of Performance (POP) start date for a particular Work Package (WP) aligns with the date recorded in the Work Authorization Document (WAD). The test is comparing the POP start date in the 'DS10 CC Log Detail' table with the POP start date in the 'DS08' table. The check is performed at the Work Package/Planning Package (WP/PP) level and the results are grouped by the Work Breakdown Structure ID (WBS_ID).

The importance of this check lies in maintaining consistency and accuracy of project timelines across different data sources. Misalignment of dates can lead to confusion, scheduling conflicts, and potential delays in project execution. It can also impact the accuracy of project status reports and forecasts. 

The severity of this check is marked as 'MAJOR', which means that while it may not prevent the data from being reviewed, it is likely to cause problems during analysis. Therefore, it is crucial to address this issue to ensure reliable project management and decision-making.
## Code

```sql

CREATE FUNCTION [dbo].[fnDIQ_DS10_CCLogDetails_IsPOPStartMisalignedWithDS08WP] (
	@upload_id int = 0
)
RETURNS TABLE
AS RETURN
(
	
	WITH WADStart AS (
		--Last WP WAD with POP Start
		SELECT 
			W.WBS_ID_WP, POP_start_date
		FROM 
			DS08_WAD W INNER JOIN (
					SELECT WBS_ID_WP, MAX(auth_PM_date) AS lastPMAuth
					FROM DS08_WAD
					WHERE upload_ID = @upload_ID
					GROUP BY WBS_ID_WP
				) LastRev 	ON W.WBS_ID_WP = LastRev.WBS_ID_WP 
							AND W.auth_PM_date = LastRev.lastPMAuth
	)
	SELECT 
		L.*
	FROM 
		DS10_CC_log_detail L INNER JOIN WADStart W ON L.WBS_ID = W.WBS_ID_WP
	WHERE 
		upload_ID = @upload_ID
	AND L.POP_start_date <> W.POP_start_date
)
```
