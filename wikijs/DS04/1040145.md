## Basic Information

| Key           | Value                                                                                                             |
| ------------- | ----------------------------------------------------------------------------------------------------------------- |
| Table         | DS04 Schedule                                                                                                     |
| Severity      | MAJOR                                                                                                           |
| Unique ID     | 1040145                                                                                                           |
| Summary       | Is this task missing in the forecast schedule?                                                                    |
| Error message | Task found in baseline schedule (schedule_type = BL) but not in forecast (schedule_type = FC) (by subproject_ID). |

## What causes this error?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
> {.is-warning}

The Data Integrity and Quality (DIQ) check titled "Baseline Task Missing In Forecast" is designed to identify any tasks that are present in the baseline schedule (DS04 Schedule) but are missing in the forecast schedule.

The error message "Task found in baseline schedule (schedule_type = BL) but not in forecast (schedule_type = FC)" indicates that there are tasks in the baseline schedule that are not found in the forecast schedule. This discrepancy could be due to a variety of reasons such as a task being accidentally omitted from the forecast schedule or a task being added to the baseline schedule after the forecast was created.

The fields causing this issue are the 'schedule_type' and 'task_ID'. The 'schedule_type' field should contain either 'BL' for baseline schedule or 'FC' for forecast schedule. The 'task_ID' field should contain the unique identifier for each task.

The expected values for these fields would be 'BL' for baseline schedule and 'FC' for forecast schedule in the 'schedule_type' field, and matching task identifiers in the 'task_ID' field for both the baseline and forecast schedules.

To resolve this issue, ensure that all tasks in the baseline schedule are also included in the forecast schedule.

## Why do we check this?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
> {.is-warning}

This test is being performed to ensure that all tasks listed in the baseline schedule are also included in the forecast schedule. The baseline schedule represents the original plan for the project, while the forecast schedule is an updated plan that reflects changes and progress made. If a task is missing in the forecast schedule, it could indicate an oversight or error in updating the schedule, which could lead to problems in project management and execution.

The importance of this check is to maintain the integrity and accuracy of the project schedule data. It ensures that all planned tasks are accounted for in the updated forecast, which is crucial for accurate project tracking, management, and reporting. The severity level is set to MAJOR, which means that while this issue may not immediately prevent the data from being reviewed, it is likely to cause problems during analysis and should be addressed promptly.

## Code

```sql

CREATE FUNCTION [dbo].[fnDIQ_DS04_Sched_IsBLTaskMissingInFC] (
	@upload_id int = 0
)
RETURNS TABLE
AS RETURN
(
	with FCTasks as (
		SELECT task_ID, ISNULL(subproject_ID,'') SubP
		FROM DS04_schedule
		WHERE upload_ID = @upload_ID AND schedule_type = 'FC'
	)
	SELECT
		B.*
	FROM
		DS04_schedule B LEFT OUTER JOIN FCTasks F ON B.task_ID = F.task_ID AND ISNULL(B.subproject_ID,'') = F.SubP
	WHERE
			upload_id = @upload_ID
		AND schedule_type = 'BL'
		AND F.task_ID IS NULL
)
```

### Changelog

| Date       | Description of Changes                                               |
| ---------- | -------------------------------------------------------------------- |
| 2024-04-30 | Logic adjusted to account for the addition of 'subproject_id' field. |
