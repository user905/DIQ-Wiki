## Basic Information
| Key         | Value          |
|-------------|----------------|
| Table       | DS04 Schedule |
| Severity    | MAJOR |
| Unique ID   | 1040171   |
| Summary     | Is your baseline schedule missing the End of PMB milestone? |
| Error message | No row found for End of PMB milestone (milestone_level = 175) in baseline schedule (schedule_type = BL). |

## What causes this error?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
{.is-warning}

The Data Integrity and Quality (DIQ) check titled "End of PMB Milestone Missing in Baseline" is designed to verify the presence of the "End of PMB" milestone in your baseline schedule within the DS04 Schedule table. 

The error message "No row found for End of PMB milestone (milestone_level = 175) in baseline schedule (schedule_type = BL)" indicates that the DIQ check did not find any record for the "End of PMB" milestone in your baseline schedule. 

This issue is likely caused by missing or incorrect data in the 'milestone_level' and 'schedule_type' fields of the DS04 Schedule table. The 'milestone_level' field should contain the value '175' to represent the "End of PMB" milestone, and the 'schedule_type' field should contain the value 'BL' to represent the baseline schedule. 

Please ensure that your baseline schedule includes the "End of PMB" milestone with the correct 'milestone_level' and 'schedule_type' values to pass this DIQ check.
## Why do we check this?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
{.is-warning}

This test is being performed to check if the baseline schedule in the DS04 Schedule table includes the 'End of PMB' milestone. The 'End of PMB' milestone is a critical point in the project that signifies the end of the Performance Measurement Baseline, a key component in project management that helps in tracking project performance against the plan.

The severity of this test is marked as a 'MAJOR', which means that while it may not prevent the data from being reviewed, it is likely to cause problems during analysis. The absence of this milestone could lead to inaccurate project tracking and performance measurement, potentially resulting in project delays or cost overruns.

Therefore, this check is important to ensure that all necessary milestones are included in the baseline schedule for accurate project management and performance measurement. It helps in maintaining the integrity and quality of the project management data, which is crucial for successful project execution and control.
## Code

```sql

CREATE FUNCTION [dbo].[fnDIQ_DS04_Sched_IsEndOfPMBMSMissingInBL] (
	@upload_id int = 0
)
RETURNS TABLE
AS RETURN
(
	
	SELECT 
    * 
  FROM 
    DummyRow_Get(@upload_ID)	
  WHERE
    (SELECT COUNT(*) FROM DS04_schedule WHERE upload_ID = @upload_ID AND schedule_type = 'BL' AND milestone_level = 175) = 0
)
```
