## Basic Information
| Key         | Value          |
|-------------|----------------|
| Table       | DS04 Schedule |
| Severity    | MINOR |
| Unique ID   | 9040146   |
| Summary     | Is this calendar name missing in DS19? |
| Error message | Calendar_name missing in DS19. |

## What causes this error?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
{.is-warning}

The Data Integrity and Quality (DIQ) check titled "Calendar Name Missing in DS19 (Schedule Calendar STD)" is designed to ensure that all calendar names listed in the DS04 Schedule table are also present in the DS19 Schedule Calendar STD table. 

If an error message "Calendar_name missing in DS19" is returned, it indicates that there is at least one calendar name in the DS04 Schedule table that is not found in the DS19 Schedule Calendar STD table. This discrepancy could be due to a data entry error, a missing entry in the DS19 table, or a mismatch in the calendar names between the two tables.

The fields causing this issue are the 'calendar_name' fields in both the DS04 Schedule and DS19 Schedule Calendar STD tables. The expected values for these fields are identical calendar names in both tables. 

Please ensure that all calendar names in the DS04 Schedule table are correctly entered and also exist in the DS19 Schedule Calendar STD table to maintain data integrity and quality.
## Why do we check this?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
{.is-warning}

This test is being performed to check if the 'Calendar_name' field in the DS19 (Schedule Calendar STD) table is missing. The 'Calendar_name' field is crucial as it provides information about the specific calendar used for scheduling in the EVMS construction project management data. 

The importance of this check is to ensure that all necessary data is present for accurate and efficient project management. If the 'Calendar_name' is missing, it could lead to confusion or misinterpretation of the schedule, potentially causing delays or mismanagement of resources.

The severity of this test is marked as 'MINOR', which means it's not a critical error that would prevent the data from being reviewed, but it's a deviation from best practices. If the 'Calendar_name' is missing, it might cause minor problems during data analysis or project management. Therefore, it's recommended to address this issue to maintain the integrity and quality of the data.
## Code

```sql

CREATE FUNCTION [dbo].[fnDIQ_DS04_Sched_IsCalendarNameMissingInDS19] (
	@upload_id int = 0
)
RETURNS TABLE
AS RETURN
(
	with CALs as (
		SELECT calendar_name 
		FROM DS19_schedule_calendar_std 
		WHERE upload_ID = @upload_ID
	)
	SELECT
		*
	FROM
		DS04_schedule
	WHERE
			upload_id = @upload_ID
		AND TRIM(ISNULL(calendar_name,'')) <> ''
		AND calendar_name NOT IN (SELECT calendar_name FROM CALs)
		AND (SELECT COUNT(*) FROM CALs) > 0 --run only if DS19 has data
)
```
