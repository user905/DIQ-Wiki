## Basic Information
| Key         | Value          |
|-------------|----------------|
| Table       | DS04 Schedule |
| Severity    | MINOR |
| Unique ID   | 9040129   |
| Summary     | Does this replanning or reprogramming milestone exist without an OTB/OTS Date? |
| Error message | Replan or repgroamming milestone found (milestone_level = 138 or 139) without an OTB/OTS Date (DS07 OTB_OTS_Date). |

## What causes this error?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
{.is-warning}

This Data Integrity and Quality (DIQ) check is designed to ensure that every replanning or reprogramming milestone in the DS04 Schedule table has an associated Over Target Baseline (OTB) or Over Target Schedule (OTS) date in the DS07 IPMR Header table. 

The error message "Replan or reprogramming milestone found (milestone_level = 138 or 139) without an OTB/OTS Date" indicates that there are records in the DS04 Schedule table with a milestone level of either 138 or 139 (representing replanning or reprogramming milestones) that do not have a corresponding OTB/OTS date in the DS07 IPMR Header table.

The fields causing this issue are the 'milestone_level' field in the DS04 Schedule table and the 'OTB_OTS_date' field in the DS07 IPMR Header table. The expected values for the 'milestone_level' field are either 138 or 139, and the 'OTB_OTS_date' field should contain a valid date.

To resolve this issue, ensure that every replanning or reprogramming milestone in the DS04 Schedule table has a corresponding OTB/OTS date in the DS07 IPMR Header table.
## Why do we check this?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
{.is-warning}

This test is being performed to ensure that all replanning or reprogramming milestones in the DS04 Schedule table have an associated Over Target Baseline (OTB) or Over Target Schedule (OTS) date. The OTB/OTS date is crucial as it provides a revised estimate of the project's completion, considering any overruns in cost or schedule. 

The importance of this check is to maintain the integrity and quality of the project management data. Without an OTB/OTS date, it would be challenging to accurately track the progress of the project and make necessary adjustments. This could lead to mismanagement of resources and delays in project completion. 

The severity of this test is marked as an MINOR. This means that while the absence of an OTB/OTS date for a replanning or reprogramming milestone may not immediately halt the review or analysis of the data, it could potentially cause minor problems or indicate that the data does not adhere to all best practices. Therefore, it is recommended to address this issue to ensure the accuracy and reliability of the project management data.
## Code

```sql

CREATE FUNCTION [dbo].[fnDIQ_DS04_Sched_DoesReplanOrReprogrammingMSExistWithoutOTBOTSDate] (
	@upload_id int = 0
)
RETURNS TABLE
AS RETURN
(
	
	SELECT
		*
	FROM
		DS04_schedule
	WHERE
			upload_ID = @upload_ID
		AND milestone_level IN (138,139)
		AND (SELECT OTB_OTS_date FROM DS07_IPMR_header WHERE upload_ID = @upload_ID) IS NULL
)
```
