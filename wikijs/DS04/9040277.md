## Basic Information
| Key         | Value          |
|-------------|----------------|
| Table       | DS04 Schedule |
| Severity    | MINOR |
| Unique ID   | 9040277   |
| Summary     | Is a similar justification for this EVT missing in cost? |
| Error message | EVT Justification found on FC task without a related justification in cost (by WBS_ID). |

## What causes this error?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
{.is-warning}

The Data Integrity and Quality (DIQ) check titled "EVT Justification Misaligned With Cost" is designed to ensure that justifications for Estimated Value of Task (EVT) in the DS04 Schedule table align with those in the DS03 Cost table. 

This check is performed on the DS04 Schedule table, specifically on tasks of the 'FC' schedule type. It verifies that for each task with an EVT code of 'B', 'G', 'H', 'J', 'L', 'M', 'N', 'O', or 'P', there is a corresponding justification in the DS03 Cost table. 

If an error is flagged by this check, it means that there is a justification for an EVT in the DS04 Schedule table that does not have a corresponding justification in the DS03 Cost table. This discrepancy is identified by comparing the WBS_ID field in both tables. 

To resolve this issue, ensure that for every EVT justification in the DS04 Schedule table, there is a matching justification in the DS03 Cost table for the same WBS_ID. The expected value for the justification_EVT field in the DS03 Cost table should not be blank if there is a corresponding EVT justification in the DS04 Schedule table.
## Why do we check this?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
{.is-warning}

This test is being performed to ensure that the justification for the Earned Value Technique (EVT) in the schedule data aligns with the justification in the cost data. The test checks if there is a similar justification for the EVT in the cost data for each task in the schedule data. 

The importance of this check is to maintain consistency between the schedule and cost data. Inconsistencies can lead to confusion and misinterpretation of data, which can affect the overall project management and decision-making process. 

The severity of this test is marked as an MINOR. This means that while it may not immediately prevent data from being reviewed, it could potentially cause minor problems or indicate that the data does not follow all best practices. Therefore, it is recommended to address this issue to ensure the highest quality and integrity of the data.
## Code

```sql

CREATE FUNCTION [dbo].[fnDIQ_DS04_Sched_IsEVTJustificationMisalignedWithDS03] (
	@upload_id int = 0
)
RETURNS TABLE
AS RETURN
(
	
	SELECT
		*
	FROM
		DS04_schedule
	WHERE
			upload_id = @upload_ID
		AND schedule_type = 'FC'
		AND EVT in ('B', 'G', 'H', 'J', 'L', 'M', 'N', 'O', 'P')
		AND TRIM(ISNULL(justification_EVT,'')) <> ''
		AND WBS_ID IN (
			SELECT WBS_ID_WP
			FROM DS03_cost
			WHERE upload_ID = @upload_ID AND TRIM(ISNULL(justification_EVT,''))=''
		)
)
```
