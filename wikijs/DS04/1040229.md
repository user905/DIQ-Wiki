## Basic Information
| Key         | Value          |
|-------------|----------------|
| Table       | DS04 Schedule |
| Severity    | MINOR |
| Unique ID   | 1040229   |
| Summary     | Has a BCP occurred without reprogramming tasks? (BL) |
| Error message | BCP milestone(s) found (milestone_level = 131 - 135) without accompanying RPG tasks (RPG = Y). (BL) |

## What causes this error?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
{.is-warning}

The Data Integrity and Quality (DIQ) check titled "BCP Milestones Without Reprogramming" is designed to ensure that every Baseline Change Proposal (BCP) milestone in the DS04 Schedule table is accompanied by a reprogramming task. 

A BCP milestone is identified by a milestone level between 131 and 135, and a reprogramming task is indicated by the RPG field being set to 'Y'. Both of these should be present in the baseline schedule, indicated by the schedule type 'BL'.

If the DIQ check finds BCP milestones without corresponding reprogramming tasks, it will trigger an error. This could be caused by missing or incorrect data in the RPG field or the milestone level field. 

For example, if a BCP milestone is entered with a milestone level between 131 and 135, but the RPG field is not set to 'Y', this would cause the error. Conversely, if a reprogramming task is entered with the RPG field set to 'Y', but the milestone level is not between 131 and 135, this would also trigger the error.

To avoid this error, ensure that every BCP milestone (milestone level 131-135) in the baseline schedule has a corresponding reprogramming task (RPG = 'Y').
## Why do we check this?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
{.is-warning}

This test is being performed on the 'DS04 Schedule' table to check for instances where a Baseline Change Proposal (BCP) has occurred without corresponding reprogramming tasks. The test is looking for BCP milestones (with milestone levels between 131 and 135) that do not have associated RPG tasks marked as 'Y' (Yes).

The importance of this check is to ensure that any changes to the baseline (BCP) are properly accounted for with corresponding reprogramming tasks. This is crucial for maintaining accurate and reliable project schedules. If a BCP occurs without reprogramming, it could lead to inconsistencies in the project schedule and potentially cause issues in project management and execution.

The severity of this check is marked as 'MINOR', which means it is not a critical error that would prevent data review, but it is a potential issue that could cause minor problems or indicate that the data does not follow all best practices. Therefore, while it may not immediately disrupt data analysis, it is a potential issue that should be addressed to ensure the highest quality and integrity of the project management data.
## Code

```sql

CREATE FUNCTION [dbo].[fnDIQ_DS04_Sched_DoesBCPExistWithoutRPGBL] (
	@upload_id int = 0
)
RETURNS TABLE
AS RETURN
(
	
	with BCPCount as (
		SELECT COUNT(*) BCPcnt
		FROM DS04_schedule 
		WHERE upload_ID = @upload_ID AND milestone_level BETWEEN 131 AND 135 AND schedule_type = 'BL'
	), RPGCount as (
		SELECT COUNT(*) RPGcnt
		FROM DS04_schedule 
		WHERE upload_ID = @upload_ID AND RPG = 'Y' AND schedule_type = 'BL'
	)
	SELECT
		*
	FROM
		DummyRow_Get(@upload_ID)
	WHERE
			(SELECT TOP 1 BCPcnt FROM BCPCount) > 0 
		AND (SELECT TOP 1 RPGcnt FROM RPGCount) = 0
)
```
