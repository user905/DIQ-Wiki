## Basic Information
| Key         | Value          |
|-------------|----------------|
| Table       | DS04 Schedule |
| Severity    | MAJOR |
| Unique ID   | 9040212   |
| Summary     | Is this subproject ID mismatched with what is in DS01 (WBS)? |
| Error message | Subproject_ID does not match with subproject_ID in DS01 (WBS) by WBS. |

## What causes this error?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
{.is-warning}

The Data Integrity and Quality (DIQ) check titled "Subproject Mismatch with WBS Dictionary" is designed to identify any discrepancies between the subproject IDs in the DS04 Schedule table and the DS01 WBS (Work Breakdown Structure) table. 

The error message "Subproject_ID does not match with subproject_ID in DS01 (WBS) by WBS" indicates that there is a mismatch between the subproject IDs in these two tables. This discrepancy could be due to a variety of reasons such as data entry errors, updates in one table not being reflected in the other, or inconsistencies in the way subproject IDs are assigned or recorded.

The fields causing the issue are the 'subproject_ID' fields in both the DS04 Schedule and DS01 WBS tables. The expected values for these fields should be identical across both tables for each corresponding WBS ID. 

To resolve this issue, it is recommended to review and correct the subproject IDs in both tables to ensure they match. This will help maintain the integrity and quality of the project management data.
## Why do we check this?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
{.is-warning}

This test is being performed to ensure that the subproject ID in the DS04 Schedule table matches with the subproject ID in the DS01 (WBS) table. The test is crucial because it helps maintain consistency and accuracy of data across different tables. If the subproject IDs do not match, it could lead to confusion and errors during data analysis, as the same subproject might be incorrectly represented or interpreted.

The severity of this check is marked as a MAJOR. This means that while the data can still be reviewed, the mismatched subproject IDs are likely to cause problems during analysis. It is important to address this issue to ensure accurate and reliable data analysis and reporting. The integrity and quality of the data are crucial for effective project management and decision-making.
## Code

```sql

CREATE FUNCTION [dbo].[fnDIQ_DS04_Sched_IsSubprojectIDMismatchedWithDS01] (
	@upload_id int = 0
)
RETURNS TABLE
AS RETURN
(
	
	SELECT
		S.*
	FROM
		DS04_schedule S INNER JOIN DS01_WBS W ON S.WBS_ID = W.WBS_ID
											 AND ISNULL(S.subproject_ID,'') <> ISNULL(W.subproject_ID,'')
	WHERE
			S.upload_id = @upload_ID
		AND W.upload_ID = @upload_ID
)
```
