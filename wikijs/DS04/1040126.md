## Basic Information
| Key         | Value          |
|-------------|----------------|
| Table       | DS04 Schedule |
| Severity    | MAJOR |
| Unique ID   | 1040126   |
| Summary     | Does this LOE task have a % Complete type other than Duration? |
| Error message | LOE Task (EVT = A or type = LOE) with % Complete type <> Duration (PC_type <> Duration). |

## What causes this error?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
{.is-warning}

The Data Integrity and Quality (DIQ) check for the DS04 Schedule table, titled "LOE Task without Duration % Complete", is designed to identify any Level of Effort (LOE) tasks that have a percent complete type that is not set to 'Duration'. 

LOE tasks are identified by an EVT value of 'A' or a type value of 'LOE'. The percent complete type for these tasks should always be set to 'Duration'. If the percent complete type (PC_type) is set to anything other than 'Duration', this indicates a potential data integrity issue.

The error message "LOE Task (EVT = A or type = LOE) with % Complete type <> Duration (PC_type <> Duration)" will be displayed if any LOE tasks are found with a percent complete type that is not 'Duration'. 

This error is likely caused by incorrect data entry when setting the percent complete type for LOE tasks. To resolve this issue, review the LOE tasks in the DS04 Schedule table and ensure that the percent complete type is correctly set to 'Duration'.
## Why do we check this?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
{.is-warning}

This test is being performed on the 'DS04 Schedule' table to check if there are any Level of Effort (LOE) tasks that have a % Complete type other than 'Duration'. The Level of Effort (LOE) tasks are typically measured by the duration of the task, so if there are any LOE tasks that are not using 'Duration' as the % Complete type, it could potentially cause issues during the analysis of the project schedule.

The severity of this test is marked as 'MAJOR', which means that while it may not prevent the data from being reviewed, it is likely to cause problems during the analysis. This is because the % Complete type is an important factor in determining the progress of a task, and using a type other than 'Duration' for LOE tasks could lead to inaccurate or misleading results.

Therefore, this check is important to ensure the integrity and quality of the project management data. It helps to ensure that the progress of LOE tasks is being measured correctly, which in turn helps to provide a more accurate picture of the overall project schedule.
## Code

```sql

CREATE FUNCTION [dbo].[fnDIQ_DS04_Sched_DoesLOETaskHaveNonDurationPCType] (
	@upload_id int = 0
)
RETURNS TABLE
AS RETURN
(
	
	SELECT
		*
	FROM
		DS04_schedule
	WHERE
			upload_id = @upload_ID
		AND PC_type <> 'Duration'
		AND (EVT = 'A' OR [type] = 'LOE')
)
```
