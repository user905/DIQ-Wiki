## Basic Information

| Key           | Value                                                                                                        |
| ------------- | ------------------------------------------------------------------------------------------------------------ |
| Table         | DS04 Schedule                                                                                                |
| Severity      | MAJOR                                                                                                      |
| Unique ID     | 1040176                                                                                                      |
| Summary       | Is this task missing a required justification for the selected EVT?                                          |
| Error message | Task found with EVT = B, G, H, J, L, M, N, O, or P but no justification (justification_EVT = null or blank). |

## What causes this error?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
> {.is-warning}

The Data Integrity and Quality (DIQ) check titled "EVT Missing Justification" is designed to ensure that each task in the DS04 Schedule table has a valid justification for the selected EVT.

The EVT field in the DS04 Schedule table should contain one of the following values: B, G, H, J, L, M, N, O, or P. If any of these values are present, a corresponding justification must be provided in the justification_EVT field.

If the DIQ check finds a task with one of the specified EVT values but no corresponding justification (i.e., the justification_EVT field is null or blank), it will flag this as an error.

The likely cause of this error is either a data entry oversight, where the justification was not entered when the EVT was selected, or a system error that failed to enforce the requirement for a justification when these EVT values are chosen.

To resolve this issue, review the flagged tasks and ensure that a valid justification is provided for each EVT value.

## Why do we check this?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
> {.is-warning}

This test is being performed on the 'DS04 Schedule' table to check if there are any tasks that have a selected Earned Value Technique (EVT) of B, G, H, J, L, M, N, O, or P but do not have a corresponding justification. The Earned Value Technique is a method used to measure project performance against the project plan. The justification for the selected EVT is important as it provides the reasoning behind the chosen method.

The severity of this test is marked as a 'MAJOR', which means that while it may not prevent the data from being reviewed, it is likely to cause problems during the analysis. The absence of a justification for the selected EVT could lead to misunderstandings or misinterpretations of the project's performance metrics. Therefore, it is crucial to ensure that all tasks with a selected EVT also have a corresponding justification to maintain the integrity and quality of the project management data.

## Code

```sql

CREATE FUNCTION [dbo].[fnDIQ_DS04_Sched_IsEVTJustificationMissing] (
	@upload_id int = 0
)
RETURNS TABLE
AS RETURN
(
	SELECT
		*
	FROM
		DS04_schedule
	WHERE
			upload_id = @upload_ID
		AND EVT in ('B', 'G', 'H', 'J', 'L', 'M', 'N', 'O', 'P')
		AND (TRIM(ISNULL(justification_EVT,'')) = '' OR CHARINDEX(' ',TRIM([justification_float_high])) = 0)
)
```

### Changelog

| Date       | Description of Changes                                                            |
| ---------- | --------------------------------------------------------------------------------- |
| 2024-04-30 | Logic adjusted to include records where 'justification_float_high' is inadequate. |
