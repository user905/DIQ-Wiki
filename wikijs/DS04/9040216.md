## Basic Information

| Key           | Value                              |
| ------------- | ---------------------------------- |
| Table         | DS04 Schedule                      |
| Severity      | WARNING                            |
| Unique ID     | 9040216                            |
| Summary       | Is this task missing logic?        |
| Error message | Task_ID missing from DS05.task_ID. |

## What causes this error?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
> {.is-warning}

The Data Integrity and Quality (DIQ) check titled "Missing Logic" is designed to identify any tasks in the DS04 Schedule table that are missing corresponding entries in the DS05 Schedule Logic table.

The error message "Task_ID missing from DS05.task_ID" indicates that there is a task in the DS04 Schedule table that does not have a matching task_ID in the DS05 Schedule Logic table. This could be due to an error in data entry or a problem with the data import process.

The fields involved in this DIQ check are the task_ID and schedule_type fields in both the DS04 Schedule and DS05 Schedule Logic tables. The expected values for these fields are that every task_ID in the DS04 Schedule table should have a corresponding task_ID in the DS05 Schedule Logic table.

Please note that this check excludes tasks in the DS04 Schedule table that have a milestone_level of 100, a subtype of 'SVT', or a type of 'WS'.

If this DIQ check fails, it is recommended to review the data entry or import process to ensure that all tasks in the DS04 Schedule table are correctly associated with entries in the DS05 Schedule Logic table.

## Why do we check this?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
> {.is-warning}

This test is being performed to ensure that all tasks in the 'DS04 Schedule' table have corresponding Task_IDs in the 'DS05' table. The test is checking for missing logic, which means it's looking for any instances where a Task_ID is not present in both tables.

The importance of this check is to ensure data consistency and completeness across different tables. In project management, each task should be properly identified and tracked across all relevant data tables. If a Task_ID is missing from the 'DS05' table, it could lead to incomplete or inaccurate analysis of the project's progress, potentially causing issues in project planning and execution.

The severity of this check is marked as 'WARNING', which means that while it's not an immediate threat to the data's usability, it's likely to cause problems during analysis if not addressed. It's crucial to fix this issue to ensure accurate and reliable project management data.

## Code

```sql

CREATE FUNCTION [dbo].[fnDIQ_DS04_Sched_IsTaskMissingLogic] (
	@upload_id int = 0
)
RETURNS TABLE
AS RETURN
(
    with Logic as (
        SELECT schedule_type, task_ID, subproject_ID
        FROM DS05_schedule_logic
        WHERE upload_ID = @upload_ID
    )
	SELECT
		S.*
	FROM
		DS04_schedule S LEFT OUTER JOIN Logic L ON S.schedule_type = L.schedule_type
                                                AND S.task_ID = L.task_ID
												AND ISNULL(S.subproject_ID,'') = ISNULL(L.subproject_ID,'')
	WHERE
			S.upload_id = @upload_ID
		AND ISNULL(S.milestone_level,0) <> 100
		AND ISNULL(S.subtype,'') <> 'SVT'
		AND S.type <> 'WS'
		AND L.task_ID IS NULL
)
```

### Changelog

| Date       | Description of Changes                                                   |
| ---------- | ------------------------------------------------------------------------ |
| 2024-04-30 | Logic adjusted to account for the addition of the 'subproject_id' field. |
