## Basic Information

| Key           | Value                                                              |
| ------------- | ------------------------------------------------------------------ |
| Table         | DS04 Schedule                                                      |
| Severity      | MAJOR                                                            |
| Unique ID     | 1040177                                                            |
| Summary       | Is the EVT for this task misaligned between BL & FC schedules?     |
| Error message | Task EVT where schedule_type = FC <> EVT where schedule_type = BL. |

## What causes this error?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
> {.is-warning}

The Data Integrity and Quality (DIQ) check titled "EVT Misaligned Between BL & FC" is designed to identify any discrepancies between the Earned Value Technique (EVT) for a task in the Baseline (BL) and Forecast (FC) schedules in the DS04 Schedule table.

The error message "Task EVT is misaligned between BL & FC schedules" indicates that the same task has different EVT values in the BL and FC schedules. This discrepancy could be due to data entry errors, changes in the task's execution that were not updated in both schedules, or inconsistencies in the calculation or application of the EVT.

The fields causing the issue are the 'schedule_type', 'task_ID', and 'EVT'. The 'schedule_type' field indicates whether the record pertains to the BL or FC schedule. The 'task_ID' field identifies the specific task, and the 'EVT' field contains the earned value technique for the task.

The expected values for the 'schedule_type' field are 'BL' for Baseline and 'FC' for Forecast. The 'task_ID' field should contain a unique identifier for each task. The 'EVT' field should contain the same value for a specific task in both the BL and FC schedules, reflecting the consistent application of the earned value technique across project management processes.

If this DIQ check identifies any tasks with misaligned EVT between the BL and FC schedules, it is recommended to review the data entry process for these tasks and ensure that any changes in the task's execution are consistently updated in both schedules.

## Why do we check this?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
> {.is-warning}

This test is being performed to check if the Earned Value Technique (EVT) for a particular task is misaligned between the Baseline (BL) and the Forecast (FC) schedules in the DS04 Schedule table. The Earned Value Technique is a project management method for measuring project performance and progress in an objective manner.

The importance of this check lies in ensuring that the project's progress is accurately tracked and forecasted. If the EVT is misaligned between the BL and FC schedules, it could lead to inaccurate project performance analysis and future forecasting. This could potentially cause problems during the analysis of the project's progress and performance, hence the severity level is set as a MAJOR.

The misalignment needs to be corrected to ensure accurate project management and forecasting. If left unaddressed, it could lead to incorrect decisions being made based on inaccurate data, potentially causing delays and cost overruns in the project.

## Code

```sql

CREATE FUNCTION [dbo].[fnDIQ_DS04_Sched_IsEVTMisalignedBtwBLAndFC] (
	@upload_id int = 0
)
RETURNS TABLE
AS RETURN
(
	with Tasks as (
		SELECT schedule_type, task_ID, ISNULL(EVT,'') EVT, ISNULL(subproject_ID,'') SubP
		FROM DS04_schedule
		WHERE upload_ID = @upload_ID
	), Trips as (
		SELECT F.Task_ID, F.SubP
		FROM Tasks F INNER JOIN Tasks B ON F.task_ID = B.task_ID AND F.SubP = B.SubP AND F.EVT <> B.EVT
		WHERE F.schedule_type = 'FC' AND B.schedule_type = 'BL'
	)
	SELECT
		S.*
	FROM
		DS04_schedule S INNER JOIN Trips T ON S.task_ID = T.task_ID AND ISNULL(S.subproject_ID,'') = T.SubP
	WHERE
		upload_id = @upload_ID
)
```

### Changelog

| Date       | Description of Changes                                               |
| ---------- | -------------------------------------------------------------------- |
| 2024-04-30 | Logic adjusted to account for the addition of 'subproject_ID' field. |
