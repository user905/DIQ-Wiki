## Basic Information
| Key         | Value          |
|-------------|----------------|
| Table       | DS04 Schedule |
| Severity    | MINOR |
| Unique ID   | 9040116   |
| Summary     | Is the quantitative risk analysis confidence level for cost below 95% following a BCP? |
| Error message | BCP found (milestone_level = 131 - 135) with quantitative risk analysis confidence level for cost below 95% (DS07.QRA_CL_cost_pct). |

## What causes this error?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
{.is-warning}

The Data Integrity and Quality (DIQ) check titled "Quantitative Risk Analysis Confidence Level for Cost Below 95% Following BCP" is designed to ensure that the confidence level for cost risk analysis is not below 95% after a Baseline Change Proposal (BCP) has been implemented. This check is performed on the DS04 Schedule table.

The error message "BCP found (milestone_level = 131 - 135) with quantitative risk analysis confidence level for cost below 95% (DS07.QRA_CL_cost_pct)" indicates that a BCP (identified by a milestone level between 131 and 135) has been found where the confidence level for cost risk analysis is below the required 95%. This confidence level is found in the DS07 IPMR Header table under the field QRA_CL_cost_pct.

The likely cause of this error is that the confidence level for cost risk analysis has not been properly updated or calculated after a BCP has been implemented. The expected value for the QRA_CL_cost_pct field should be 0.95 or higher to indicate a 95% or greater confidence level in the cost risk analysis following a BCP. 

To resolve this issue, review the BCPs identified by the milestone levels between 131 and 135 and ensure that the confidence level for cost risk analysis is correctly updated in the DS07 IPMR Header table.
## Why do we check this?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
{.is-warning}

This test is being performed to check if the quantitative risk analysis confidence level for cost is below 95% following a Baseline Change Proposal (BCP). The test is conducted on the 'DS04 Schedule' table. The importance of this check is to ensure that the risk analysis is being conducted properly and that the confidence level for cost is not unduly low after a BCP. This is crucial for maintaining the financial integrity of the project and ensuring that cost overruns are minimized. 

The severity of this test is marked as an 'MINOR', which means it is not a critical issue that would prevent the data from being reviewed, but it is a potential problem that could cause minor issues during analysis. It also indicates that the data may not be following all best practices. Therefore, while it is not an immediate threat to the project, it is a situation that should be monitored and corrected to ensure the accuracy and reliability of the project's financial data.
## Code

```sql

CREATE FUNCTION [dbo].[fnDIQ_DS04_Sched_DoesBCPExistWithCostRiskConfidenceLevelBelow95Percent] (
	@upload_id int = 0
)
RETURNS TABLE
AS RETURN
(
	
	with QRACL as (
		SELECT ISNULL(QRA_CL_cost_pct,0) QRACL 
		FROM DS07_IPMR_header 
		WHERE upload_ID = @upload_ID
	)
	SELECT
		*
	FROM
		DS04_schedule
	WHERE
			upload_ID = @upload_ID
		AND milestone_level BETWEEN 131 AND 135
		AND (SELECT QRACL FROM QRACL) < .95
)
```
