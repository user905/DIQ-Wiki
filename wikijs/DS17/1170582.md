## Basic Information
| Key         | Value          |
|-------------|----------------|
| Table       | DS17 WBS EU |
| Severity    | CRITICAL |
| Unique ID   | 1170582   |
| Summary     | Is this WBS / EOC combo duplicated? |
| Error message | Count of combo WBS & EOC combo > 1. |

## What causes this error?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
{.is-warning}

The Data Integrity and Quality (DIQ) check titled "Duplicate Estimate Uncertainty Entry" is designed to identify any instances where the combination of Work Breakdown Structure (WBS) and Estimate at Completion (EOC) is duplicated in the DS17 WBS EU table. 

The WBS and EOC fields should be unique for each entry in the table. If the count of any WBS and EOC combination is greater than 1, this indicates that there are duplicate entries in the table. 

The cause of this error is likely due to data entry issues, where the same WBS and EOC combination has been entered more than once. It's important to ensure that each WBS and EOC combination is unique to maintain the integrity and quality of the data in the DS17 WBS EU table. 

To resolve this issue, review the entries in the table and remove any duplicates. Ensure that each WBS and EOC combination is unique before entering it into the table.
## Why do we check this?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
{.is-warning}

This test is being performed to check for duplicate entries in the 'DS17 WBS EU' table for the combination of Work Breakdown Structure (WBS) and Estimate at Completion (EOC). The test is checking if the count of any WBS and EOC combination is greater than 1, which would indicate a duplicate entry.

The importance of this check is to ensure data integrity and accuracy in the project management data. Duplicate entries can lead to incorrect calculations or analyses, which can in turn lead to incorrect decision making. This could potentially lead to cost overruns, schedule delays, or other negative impacts on the project.

The severity of this check is marked as 'CRITICAL', which is the highest level of severity. This means that if any duplicate entries are found, they must be corrected before the data can be reviewed further. This underscores the critical importance of maintaining data integrity in the project management data.
## Code

```sql

CREATE FUNCTION [dbo].[fnDIQ_DS17_WBS_EU_PK] (
	@upload_id int = 0
)
RETURNS TABLE
AS RETURN
(
	
	with Dupes as (
		SELECT WBS_ID ,EOC
		FROM DS17_WBS_EU
		WHERE upload_id = @upload_ID
		GROUP BY WBS_ID, EOC
		HAVING COUNT(*) > 1
	)
	SELECT 
		E.*
	FROM 
		DS17_WBS_EU E INNER JOIN Dupes D ON E.WBS_ID = D.WBS_ID 
										AND E.EOC = D.EOC
	WHERE 
		upload_ID = @upload_ID
)
```
