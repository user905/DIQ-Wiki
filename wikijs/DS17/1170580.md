## Basic Information
| Key         | Value          |
|-------------|----------------|
| Table       | DS17 WBS EU |
| Severity    | MINOR |
| Unique ID   | 1170580   |
| Summary     | Is the time dependent flag inconsistent within this WBS? |
| Error message | time_dependent is not all Y or all N by WBS_ID. |

## What causes this error?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
{.is-warning}

The Data Integrity and Quality (DIQ) check titled "WBS Time Dependence Inconsistent" is designed to ensure that the time-dependent flag within the DS17 WBS EU table is consistent for each Work Breakdown Structure (WBS). 

The inconsistency error occurs when the 'time_dependent' field within a single WBS_ID does not contain all 'Y' or all 'N' values. The 'time_dependent' field should be consistent within each WBS_ID, meaning all entries for a specific WBS_ID should either be 'Y' or 'N', not a mix of both. 

If the DIQ check identifies an inconsistency, it suggests that there may be an error in the data entry or data import process. The expected values for the 'time_dependent' field are either 'Y' for Yes or 'N' for No. 

To resolve this issue, review the data entries for the 'time_dependent' field within each WBS_ID in the DS17 WBS EU table. Ensure that all entries within a single WBS_ID are consistent, either all 'Y' or all 'N'.
## Why do we check this?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
{.is-warning}

This test is being performed to check the consistency of the 'time_dependent' flag within the 'DS17 WBS EU' table for each Work Breakdown Structure ID (WBS_ID). The 'time_dependent' flag indicates whether a particular task or activity within the project is dependent on time or not. 

The importance of this check is to ensure that the data within each WBS_ID is consistent and accurate. If the 'time_dependent' flag is inconsistent (not all 'Y' or all 'N'), it could lead to confusion or misinterpretation of the data, potentially impacting project scheduling and management decisions. 

The severity of this issue is marked as an 'MINOR', which means it's not a critical error that would prevent data review, but it's a deviation from best practices. It might cause minor problems during data analysis or interpretation, so it's recommended to address this issue for optimal data integrity and quality.
## Code

```sql

CREATE FUNCTION [dbo].[fnDIQ_DS17_WBS_EU_IsTimeDepInconsistent] (
	@upload_id int = 0
)
RETURNS TABLE
AS RETURN
(
	
	SELECT 
		*
	FROM 
		DS17_WBS_EU
	WHERE 
			upload_ID = @upload_ID
		AND WBS_ID IN (
			SELECT WBS_ID
			FROM DS17_WBS_EU
			WHERE upload_ID = @upload_ID
			GROUP BY WBS_ID
			HAVING MIN(time_dependent) <> MAX(time_dependent)
		)
)
```
