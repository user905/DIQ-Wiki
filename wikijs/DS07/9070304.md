## Basic Information
| Key         | Value          |
|-------------|----------------|
| Table       | DS07 IPMR Header |
| Severity    | MINOR |
| Unique ID   | 9070304   |
| Summary     | Is the PM EAC Best date earlier than the End of PMB milestone? |
| Error message | EAC_PM_Best < minimum DS04.EF_date where milestone_level = 175 (BL or FC). |

## What causes this error?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
{.is-warning}

The Data Integrity and Quality (DIQ) check titled "PM EAC Best Date Prior to End of PMB Milestone" is designed to ensure that the Project Manager's (PM) Estimated At Completion (EAC) Best date is not earlier than the End of Performance Measurement Baseline (PMB) milestone. This check is performed on the DS07 IPMR Header table.

The error message "EAC_PM_Best < minimum DS04.EF_date where milestone_level = 175 (BL or FC)" indicates that the PM's EAC Best date is earlier than the earliest date in the DS04 Schedule table where the milestone level is 175 (Baseline or Forecast Complete). 

This error is likely caused by incorrect data entry in the EAC_PM_Best field in the DS07 IPMR Header table or the EF_date field in the DS04 Schedule table. The EAC_PM_Best date should not be earlier than the earliest EF_date where the milestone level is 175. 

To resolve this issue, please review the dates entered in these fields and ensure that they are accurate. The EAC_PM_Best date should be set to a date that is later than or equal to the earliest EF_date where the milestone level is 175.
## Why do we check this?

> :robot: The following text was generated by an AI tool and hasn't been reviewed for accuracy by a human! It might be useful, but it also might have errors. Are you a human? You can help by reviewing it for accuracy! Edit it as needed then remove this message.
{.is-warning}

This test is being performed on the 'DS07 IPMR Header' table to check if the Project Manager's (PM's) Estimate at Completion (EAC) Best date is earlier than the end of the Performance Measurement Baseline (PMB) milestone. The test is checking if the 'EAC_PM_Best' date is less than the minimum 'DS04.EF_date' where the milestone level is 175 (Baseline or Forecast).

The importance of this check is to ensure that the project's estimated completion date, as determined by the project manager, is not set before the end of the project's performance measurement baseline. This could indicate a potential scheduling issue or unrealistic expectations for project completion. 

The severity of this test is marked as an 'MINOR', which means it is not a critical issue that would prevent the data from being reviewed, but it could indicate minor problems or suggest that the data does not adhere to all best practices. It's a signal to review the project timeline and make sure the project's estimated completion date is realistic and aligns with the project's performance measurement baseline.
## Code

```sql

CREATE FUNCTION [dbo].[fnDIQ_DS07_IPMR_IsEACPMBestLtEndOfPMB] (
	@upload_id int = 0
)
RETURNS TABLE
AS RETURN
(
	
	with EndOfPMB as (
		SELECT MIN(EF_date) MinEF
		FROM DS04_schedule
		WHERE upload_ID = @upload_ID AND milestone_level = 175
	)
	SELECT 
		*
	FROM
		DS07_IPMR_header
	WHERE
			upload_ID = @upload_ID
		AND EAC_PM_best_date < (SELECT TOP 1 MinEF FROM EndOfPMB)
)
```
