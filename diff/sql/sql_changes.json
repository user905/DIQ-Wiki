[
  {
    "UID": "1030089",
    "Original DIQ Name": "fnDIQ_DS03_Cost_IsLaborMissingBCWPDollarsHoursOrFTEs",
    "Match Type": "Name matched",
    "Diff": [
      "--- \n",
      "+++ \n",
      "@@ -11,6 +11,7 @@\n",
      " WHERE",
      " upload_ID = @upload_ID",
      " AND EOC = 'Labor'",
      "+AND ISNULL(is_indirect,'') <> 'Y'",
      " AND (BCWPi_dollars <> 0 OR BCWPi_FTEs <> 0 OR BCWPi_hours <> 0)",
      " AND (BCWPi_dollars = 0 OR BCWPi_FTEs = 0 OR BCWPi_hours = 0)",
      " )"
    ]
  },
  {
    "UID": "1060249",
    "Original DIQ Name": "fnDIQ_DS06_Res_IsRoleEOCNonLabor",
    "Match Type": "Name matched",
    "Diff": [
      "--- \n",
      "+++ \n",
      "@@ -11,5 +11,6 @@\n",
      " WHERE",
      " upload_id = @upload_ID",
      " AND role_ID IS NOT NULL",
      "+AND EOC IS NOT NULL",
      " AND EOC <> 'Labor'",
      " )"
    ]
  },
  {
    "UID": "9060297",
    "Original DIQ Name": "fnDIQ_DS06_Res_AreRemDollarsMisalignedWithDS03BCWR",
    "Match Type": "Name matched",
    "Diff": [
      "--- \n",
      "+++ \n",
      "@@ -5,34 +5,35 @@\n",
      " AS RETURN",
      " (",
      " with CostWBS as (",
      "-SELECT WBS_ID_WP WBS, EOC, SUM(BCWSi_dollars) - SUM(BCWPi_dollars) BCWR",
      "+SELECT WBS_ID_WP WBS, CASE WHEN ISNULL(is_indirect,'') = 'Y' THEN 'Indirect' ELSE EOC END as EOC, SUM(BCWSi_dollars) - SUM(BCWPi_dollars) BCWR",
      " FROM DS03_cost",
      " WHERE upload_ID = @upload_ID",
      "-GROUP BY WBS_ID_WP, EOC",
      "+GROUP BY WBS_ID_WP, CASE WHEN ISNULL(is_indirect,'') = 'Y' THEN 'Indirect' ELSE EOC END",
      " ), Resources as (",
      "-SELECT task_ID, EOC, SUM(remaining_dollars) RemDollars",
      "+SELECT task_ID, EOC, ISNULL(subproject_ID,'') SubP, SUM(remaining_dollars) RemDollars",
      " FROM DS06_schedule_resources",
      " WHERE upload_ID = @upload_ID AND schedule_type = 'FC'",
      "-GROUP BY task_ID, EOC",
      "+GROUP BY task_ID, EOC, ISNULL(subproject_ID,'')",
      " ), ScheduleWBS as (",
      "-SELECT S.WBS_ID WBS, R.EOC, SUM(R.RemDollars) RemDollars",
      "-FROM DS04_schedule S INNER JOIN Resources R ON S.task_ID = R.task_ID",
      "+SELECT S.WBS_ID WBS, R.EOC, SubP, SUM(R.RemDollars) RemDollars",
      "+FROM DS04_schedule S INNER JOIN Resources R ON S.task_ID = R.task_ID AND ISNULL(S.subproject_ID,'') = R.SubP",
      " WHERE S.upload_ID = @upload_ID AND S.schedule_type = 'FC'",
      "-GROUP BY S.WBS_ID, R.EOC",
      "+GROUP BY S.WBS_ID, R.EOC, SubP",
      " ), FlagsByWBS as (",
      "-SELECT S.WBS,S.EOC",
      "+SELECT S.WBS, S.EOC, S.SubP",
      " FROM ScheduleWBS S INNER JOIN CostWBS C ON C.EOC = S.EOC",
      " AND C.WBS = S.WBS",
      " AND C.BCWR <> S.RemDollars",
      " ), FlagsByTask as (",
      "-SELECT S.task_ID, F.EOC",
      "-FROM DS04_schedule S INNER JOIN FlagsByWBS F ON S.WBS_ID = F.WBS",
      "+SELECT S.task_ID, F.EOC, F.SubP",
      "+FROM DS04_schedule S INNER JOIN FlagsByWBS F ON S.WBS_ID = F.WBS AND ISNULL(S.subproject_ID,'') = F.SubP",
      " WHERE upload_ID = @upload_ID AND schedule_type = 'FC'",
      " )",
      " SELECT",
      " R.*",
      " FROM",
      " DS06_schedule_resources R INNER JOIN FlagsByTask F \tON R.task_ID = F.task_ID",
      "+AND ISNULL(R.subproject_ID,'') = F.SubP",
      " AND R.EOC = F.EOC",
      " WHERE",
      " R.upload_id = @upload_ID"
    ]
  },
  {
    "UID": "9010016",
    "Original DIQ Name": "fnDIQ_DS01_WBS_IsWBSMissingInDS04BL",
    "Match Type": "Name matched",
    "Diff": [
      "--- \n",
      "+++ \n",
      "@@ -5,15 +5,11 @@\n",
      " AS RETURN",
      " (",
      " SELECT",
      "-*",
      "+W.*",
      " FROM",
      "-DS01_WBS",
      "+DS01_WBS W LEFT JOIN DS04_schedule S on W.WBS_ID = S.WBS_ID AND S.schedule_type = 'BL' AND S.upload_ID = @upload_ID",
      " WHERE",
      "-upload_ID = @upload_ID",
      "-AND type in ('WP', 'PP')",
      "-AND WBS_ID NOT IN (",
      "-SELECT WBS_ID",
      "-FROM DS04_schedule",
      "-WHERE upload_ID = @upload_ID AND schedule_type = 'BL'",
      "+W.upload_ID = @upload_ID",
      "+AND W.[type] in ('WP', 'PP')",
      "+AND S.WBS_ID IS NULL",
      " )",
      "-)"
    ]
  },
  {
    "UID": "1030058",
    "Original DIQ Name": "fnDIQ_DS03_Cost_DoesACWPExistAtCAAndWPLevels",
    "Match Type": "Name matched",
    "Diff": [
      "--- \n",
      "+++ \n",
      "@@ -23,7 +23,7 @@\n",
      " DS03_Cost",
      " WHERE",
      " upload_ID = @upload_ID",
      "-AND (ACWPi_dollars <> 0 OR ACWPi_FTEs <> 0 OR ACWPi_hours <> 0)",
      "-AND (SELECT COUNT(*) FROM AtCA) > 0",
      "-AND (SELECT COUNT(*) FROM AtWP) > 0",
      "+AND (ACWPi_dollars <> 0 OR ACWPi_FTEs <> 0 OR ACWPi_hours <> 0) -- Only rows with Actuals",
      "+AND (SELECT COUNT(*) FROM AtCA) > 0 -- Only if AtCA has rows",
      "+AND (SELECT COUNT(*) FROM AtWP) > 0 -- Only if AtWP has rows",
      " )"
    ]
  },
  {
    "UID": "9060296",
    "Original DIQ Name": "fnDIQ_DS06_Res_IsFinishDateLaterThanDS04EFDate",
    "Match Type": "Name matched",
    "Diff": [
      "--- \n",
      "+++ \n",
      "@@ -4,14 +4,15 @@\n",
      " RETURNS TABLE",
      " AS RETURN",
      " (",
      "-SELECT",
      "-R.*",
      "-FROM",
      "-DS06_schedule_resources R,",
      "-(SELECT task_ID, EF_date FROM DS04_schedule WHERE upload_ID = @upload_ID AND schedule_type = 'BL') S",
      "-WHERE",
      "-R.upload_id = @upload_ID",
      "-AND R.task_ID = S.task_ID",
      "+with BL as (",
      "+SELECT task_ID, ISNULL(subproject_ID,'') SubP, EF_date",
      "+FROM DS04_schedule",
      "+WHERE upload_ID = @upload_ID AND schedule_type = 'BL'",
      "+)",
      "+SELECT R.*",
      "+FROM DS06_schedule_resources R INNER JOIN BL B ON R.task_ID = B.task_ID",
      "+AND ISNULL(R.subproject_ID,'') = B.SubP",
      "+AND R.finish_date > B.EF_date",
      "+WHERE\tR.upload_id = @upload_ID",
      " AND R.schedule_type = 'BL'",
      "-AND R.finish_date > S.EF_date",
      " )"
    ]
  },
  {
    "UID": "9030102",
    "Original DIQ Name": "fnDIQ_DS03_Cost_IsWPOrPPMissingInDS04BL",
    "Match Type": "Name matched",
    "Diff": [
      "--- \n",
      "+++ \n",
      "@@ -4,14 +4,8 @@\n",
      " RETURNS TABLE",
      " AS RETURN",
      " (",
      "-SELECT",
      "-*",
      "-FROM",
      "-DS03_Cost C",
      "-WHERE",
      "-C.upload_ID = @upload_ID",
      "-AND C.WBS_ID_WP NOT IN (",
      "-SELECT WBS_ID",
      "-FROM DS04_schedule",
      "-WHERE upload_ID = @upload_ID AND schedule_type = 'BL')",
      "+SELECT C.*",
      "+FROM DS03_Cost C",
      "+LEFT JOIN DS04_schedule S ON C.WBS_ID_WP = S.WBS_ID AND S.upload_ID = @upload_ID AND S.schedule_type = 'BL'",
      "+WHERE C.upload_ID = @upload_ID AND S.WBS_ID IS NULL",
      " )"
    ]
  },
  {
    "UID": "9060286",
    "Original DIQ Name": "fnDIQ_DS06_Res_ArePDollarsMissingDS03ADollars",
    "Match Type": "Name matched",
    "Diff": [
      "--- \n",
      "+++ \n",
      "@@ -5,45 +5,40 @@\n",
      " AS RETURN",
      " (",
      " with CostWBS as (",
      "-SELECT WBS_ID_WP WBS, EOC",
      "+SELECT WBS_ID_WP WBS, CASE WHEN ISNULL(is_indirect,'') = 'Y' THEN 'Indirect' ELSE EOC END as EOC",
      " FROM DS03_cost",
      " WHERE upload_ID = @upload_ID",
      "-GROUP BY WBS_ID_WP, EOC",
      "+GROUP BY WBS_ID_WP, CASE WHEN ISNULL(is_indirect,'') = 'Y' THEN 'Indirect' ELSE EOC END",
      " HAVING SUM(ACWPi_dollars) = 0",
      " ), ScheduleWBS as (",
      "-SELECT",
      "-S.WBS_ID WBS,",
      "-SUM(R.Performance) Performance,",
      "-R.EOC",
      "+SELECT S.WBS_ID WBS, R.SubP, SUM(R.Performance) Performance, R.EOC",
      " FROM",
      " DS04_schedule S",
      " INNER JOIN (",
      "-SELECT task_ID, EOC, SUM(actual_dollars) Performance",
      "+SELECT task_ID, ISNULL(subproject_ID,'') SubP, EOC, SUM(actual_dollars) Performance",
      " FROM DS06_schedule_resources",
      " WHERE upload_ID = @upload_ID AND schedule_type = 'FC'",
      "-GROUP BY task_ID, EOC",
      "-) R ON S.task_ID = R.task_ID",
      "+GROUP BY task_ID, EOC, ISNULL(subproject_ID,'')",
      "+) R ON S.task_ID = R.task_ID AND ISNULL(S.subproject_ID,'') = R.SubP",
      " WHERE",
      " S.upload_ID = @upload_ID",
      " AND S.schedule_type = 'FC'",
      "-GROUP BY S.WBS_ID, R.EOC",
      "+GROUP BY S.WBS_ID, R.EOC, R.SubP",
      " HAVING SUM(R.Performance) > 0",
      " ), FlagsByWBS as (",
      "-SELECT",
      "-S.WBS,",
      "-S.EOC",
      "-FROM",
      "-ScheduleWBS S INNER JOIN  CostWBS C ON C.EOC = S.EOC",
      "+SELECT S.WBS, S.EOC, S.SubP",
      "+FROM ScheduleWBS S INNER JOIN  CostWBS C ON C.EOC = S.EOC",
      " AND C.WBS = S.WBS",
      " ), FlagsByTask as (",
      "-SELECT S.task_ID, F.EOC",
      "-FROM DS04_schedule S INNER JOIN FlagsByWBS F ON S.WBS_ID = F.WBS",
      "+SELECT S.task_ID, F.EOC, F.SubP",
      "+FROM DS04_schedule S INNER JOIN FlagsByWBS F ON S.WBS_ID = F.WBS AND ISNULL(S.subproject_ID,'') = F.SubP",
      " WHERE upload_ID = @upload_ID AND schedule_type = 'FC'",
      " )",
      " SELECT",
      " R.*",
      " FROM",
      " DS06_schedule_resources R INNER JOIN FlagsByTask F \tON R.task_ID = F.task_ID",
      "+AND ISNULL(R.subproject_ID,'') = F.SubP",
      " AND R.EOC = F.EOC",
      " WHERE",
      " R.upload_id = @upload_ID"
    ]
  },
  {
    "UID": "1040139",
    "Original DIQ Name": "fnDIQ_DS04_Sched_IsActivityMissingEVT",
    "Match Type": "Name matched",
    "Diff": [
      "--- \n",
      "+++ \n",
      "@@ -11,5 +11,6 @@\n",
      " WHERE",
      " upload_id = @upload_ID",
      " AND type NOT IN ('SM','FM','WS')",
      "+AND ISNULL(subtype,'') NOT IN ('SVT','ZBA')",
      " AND TRIM(ISNULL(EVT,'')) = ''",
      " )"
    ]
  },
  {
    "UID": "1060246",
    "Original DIQ Name": "fnDIQ_DS06_Res_DoLaborDatesOverlap",
    "Match Type": "Name matched",
    "Diff": [
      "--- \n",
      "+++ \n",
      "@@ -5,25 +5,23 @@\n",
      " AS RETURN",
      " (",
      " with Flags as (",
      "-SELECT R1.task_ID, R1.resource_ID, R1.schedule_type",
      "+SELECT R1.task_ID, R1.resource_ID, R1.schedule_type, ISNULL(R1.subproject_ID,'') SubP",
      " FROM DS06_schedule_resources R1 INNER JOIN DS06_schedule_resources R2 ON R1.schedule_type = R2.schedule_type",
      " AND R1.resource_ID = R2.resource_ID",
      "-WHERE",
      "-R1.upload_ID = @upload_ID",
      "+AND ISNULL(R1.subproject_ID, '') = ISNULL(R2.subproject_ID, '')",
      "+AND R1.task_ID <> R2.task_ID",
      "+AND R1.start_date <= R2.finish_date",
      "+AND R2.start_date <= R1.finish_date",
      "+WHERE\tR1.upload_ID = @upload_ID",
      " AND R2.upload_ID = @upload_ID",
      " AND (R1.EOC = 'Labor' OR R1.[type] = 'Labor')",
      " AND (R2.EOC = 'Labor' OR R2.[type] = 'Labor')",
      "-AND R1.task_ID <> R2.task_ID",
      "-AND R1.start_date <= R2.finish_date",
      "-AND R2.start_date <= R1.finish_date",
      "-GROUP BY R1.task_ID, R1.resource_ID, R1.schedule_type",
      "+GROUP BY R1.task_ID, R1.resource_ID, R1.schedule_type, ISNULL(R1.subproject_ID,'')",
      " )",
      "-SELECT",
      "-R.*",
      "-FROM",
      "-DS06_schedule_resources R INNER JOIN Flags F ON R.schedule_type = F.schedule_type",
      "+SELECT R.*",
      "+FROM DS06_schedule_resources R INNER JOIN Flags F ON R.schedule_type = F.schedule_type",
      " AND R.task_ID = F.task_ID",
      " AND R.resource_ID = F.resource_ID",
      "-WHERE",
      "-upload_ID = @upload_ID AND (EOC = 'Labor' OR [type] = 'Labor')",
      "+AND ISNULL(R.subproject_ID, '') = F.SubP",
      "+WHERE upload_ID = @upload_ID AND (EOC = 'Labor' OR [type] = 'Labor')",
      " )"
    ]
  },
  {
    "UID": "1040603",
    "Original DIQ Name": "fnDIQ_DS04_Sched_IsHighFloatJustificationMissingBL",
    "Match Type": "Name matched",
    "Diff": [
      "--- \n",
      "+++ \n",
      "@@ -15,8 +15,8 @@\n",
      " DS04_schedule",
      " WHERE",
      " upload_id = @upload_ID",
      "-AND schedule_type = 'BL'",
      "-AND float_total_days / NULLIF((SELECT TOP 1 RemDur FROM RemDur),0) >= .1",
      "-AND TRIM(ISNULL(justification_float_high,''))=''",
      "-AND (SELECT TOP 1 RemDur FROM RemDur) > 0",
      "+AND schedule_type = 'BL' --BL tasks only",
      "+AND float_total_days / NULLIF((SELECT TOP 1 RemDur FROM RemDur),0) >= .1 --float > 10% of remaining duration",
      "+AND TRIM(ISNULL(justification_float_high,''))='' --no justification",
      "+AND (SELECT TOP 1 RemDur FROM RemDur) > 0 -- remaining duration > 0 days",
      " )"
    ]
  },
  {
    "UID": "1010018",
    "Original DIQ Name": "fnDIQ_DS01_WBS_IsExitCriteriaMissing",
    "Match Type": "Name matched",
    "Diff": [
      "--- \n",
      "+++ \n",
      "@@ -10,5 +10,5 @@\n",
      " DS01_WBS",
      " WHERE",
      " upload_ID = @upload_ID",
      "-AND (TRIM(exit_criteria)='' OR exit_criteria IS NULL)",
      "+AND TRIM(ISNULL(exit_criteria,''))=''",
      " )"
    ]
  },
  {
    "UID": "9060292",
    "Original DIQ Name": "fnDIQ_DS06_Res_DoNonLaborSHoursExistWithDS03LaborSHours",
    "Match Type": "Name matched",
    "Diff": [
      "--- \n",
      "+++ \n",
      "@@ -7,36 +7,37 @@\n",
      " with CostWBS as (",
      " SELECT WBS_ID_WP WBS",
      " FROM DS03_cost",
      "-WHERE upload_ID = @upload_ID AND EOC = 'Labor'",
      "+WHERE upload_ID = @upload_ID AND EOC = 'Labor' AND ISNULL(is_indirect,'') <> 'Y'",
      " GROUP BY WBS_ID_WP",
      " HAVING SUM(BCWSi_hours) > 0",
      " ), ScheduleWBS as (",
      "-SELECT S.WBS_ID WBS",
      "-FROM DS04_schedule S INNER JOIN DS06_schedule_resources R ON S.task_ID = R.task_ID",
      "-WHERE",
      "-S.upload_ID = @upload_ID",
      "+SELECT S.WBS_ID WBS, ISNULL(S.subproject_ID, '') SubP",
      "+FROM DS04_schedule S INNER JOIN DS06_schedule_resources R ON S.task_ID = R.task_ID AND ISNULL(S.subproject_ID, '') = ISNULL(R.subproject_ID, '')",
      "+WHERE\tS.upload_ID = @upload_ID",
      " AND R.upload_ID = @upload_ID",
      " AND R.schedule_type = 'BL'",
      " AND S.schedule_type = 'BL'",
      " AND R.[type] <> 'labor'",
      "+AND R.EOC <> 'Labor'",
      " AND R.UOM = 'h'",
      "-GROUP BY S.WBS_ID",
      "+GROUP BY S.WBS_ID, ISNULL(S.subproject_ID, '')",
      " HAVING SUM(R.budget_units) > 0",
      " ), FlagsByWBS as (",
      "-SELECT S.WBS",
      "+SELECT S.WBS, S.SubP",
      " FROM ScheduleWBS S INNER JOIN CostWBS C ON C.WBS = S.WBS",
      " ), FlagsByTask as (",
      "-SELECT S.task_ID",
      "-FROM DS04_schedule S INNER JOIN FlagsByWBS F ON S.WBS_ID = F.WBS",
      "+SELECT S.task_ID, F.SubP",
      "+FROM DS04_schedule S INNER JOIN FlagsByWBS F ON S.WBS_ID = F.WBS AND ISNULL(S.subproject_ID, '') = F.SubP",
      " WHERE upload_ID = @upload_ID AND schedule_type = 'BL'",
      " )",
      " SELECT",
      " R.*",
      " FROM",
      "-DS06_schedule_resources R INNER JOIN FlagsByTask F ON R.task_ID = F.task_ID",
      "-WHERE",
      "-R.upload_id = @upload_ID",
      "+DS06_schedule_resources R INNER JOIN FlagsByTask F ON R.task_ID = F.task_ID AND ISNULL(R.subproject_ID, '') = F.SubP",
      "+WHERE\tR.upload_id = @upload_ID",
      " AND R.schedule_type = 'BL'",
      " AND R.[type] <> 'labor'",
      "+AND R.EOC <> 'Labor'",
      " AND R.UOM = 'h'",
      "+AND R.budget_units > 0",
      " )"
    ]
  },
  {
    "UID": "1030046",
    "Original DIQ Name": "fnDIQ_DS03_Cost_AreBCWSiAndETCiIncommensurate",
    "Match Type": "Name matched",
    "Diff": [
      "--- \n",
      "+++ \n",
      "@@ -4,19 +4,20 @@\n",
      " RETURNS TABLE",
      " AS RETURN",
      " (",
      "+with Rollup as (",
      "+SELECT WBS_ID_CA, WBS_ID_WP, period_date, EOC",
      "+FROM CostRollupByEOC_Get(@upload_ID)",
      "+WHERE (ISNULL(bcwsi_dollars,0) = 0 AND ABS(ISNULL(BCWSi_dollars,0) - ISNULL(ETCi_dollars,0)) > 1000)",
      "+OR \tABS((ISNULL(BCWSi_dollars,0) - ISNULL(ETCi_dollars,0)) / NULLIF(BCWSi_dollars,0)) > .5",
      "+)",
      " SELECT",
      " C.*",
      " FROM",
      "-DS03_Cost C INNER JOIN CostRollupByEOC_Get(@upload_ID) R ON C.PERIOD_DATE = R.PERIOD_DATE",
      "+DS03_Cost C INNER JOIN Rollup R ON C.PERIOD_DATE = R.PERIOD_DATE",
      " AND C.WBS_ID_CA = R.WBS_ID_CA",
      " AND ISNULL(C.WBS_ID_WP,'') = R.WBS_ID_WP",
      " AND C.EOC = R.EOC",
      "-WHERE",
      "-upload_ID = @upload_ID",
      "+WHERE\tupload_ID = @upload_ID",
      " AND C.period_date > C.CPP_status_date",
      " AND R.period_date > C.CPP_status_date",
      "-AND (",
      "-(ISNULL(R.bcwsi_dollars,0) = 0 AND ABS(ISNULL(R.BCWSi_dollars,0) - ISNULL(R.ETCi_dollars,0)) > 1000)",
      "-OR \tABS((ISNULL(R.BCWSi_dollars,0) - ISNULL(R.ETCi_dollars,0)) / NULLIF(R.BCWSi_dollars,0)) > .5",
      " )",
      "-)"
    ]
  },
  {
    "UID": "9040196",
    "Original DIQ Name": "fnDIQ_DS04_Sched_IsMSResourceLoaded",
    "Match Type": "Name matched",
    "Diff": [
      "--- \n",
      "+++ \n",
      "@@ -5,7 +5,7 @@\n",
      " AS RETURN",
      " (",
      " with Resources as (",
      "-SELECT task_ID, schedule_type",
      "+SELECT task_ID, schedule_type, ISNULL(subproject_ID,'') SubP",
      " FROM DS06_schedule_resources",
      " WHERE upload_ID = @upload_ID",
      " )",
      "@@ -14,6 +14,7 @@\n",
      " FROM",
      " DS04_schedule S INNER JOIN Resources R ON S.task_ID = R.task_ID",
      " AND S.schedule_type = R.schedule_type",
      "+AND ISNULL(S.subproject_ID,'') = R.SubP",
      " WHERE",
      " S.upload_id = @upload_ID",
      " AND S.type IN ('SM','FM')"
    ]
  },
  {
    "UID": "9060301",
    "Original DIQ Name": "fnDIQ_DS06_Res_IsTaskMissingInDS04",
    "Match Type": "Name matched",
    "Diff": [
      "--- \n",
      "+++ \n",
      "@@ -5,17 +5,15 @@\n",
      " AS RETURN",
      " (",
      " with Tasks as (",
      "-SELECT schedule_type, task_ID",
      "+SELECT schedule_type, task_ID, ISNULL(subproject_ID,'') SubP",
      " FROM DS04_schedule",
      " WHERE upload_ID = @upload_ID",
      " )",
      "-SELECT",
      "-R.*",
      "-FROM",
      "-DS06_schedule_resources R LEFT OUTER JOIN Tasks T ON R.schedule_type = T.schedule_type",
      "+SELECT R.*",
      "+FROM DS06_schedule_resources R LEFT OUTER JOIN Tasks T ON R.schedule_type = T.schedule_type",
      " AND R.task_ID = T.task_ID",
      "-WHERE",
      "-R.upload_id = @upload_ID",
      "+AND ISNULL(R.subproject_ID,'') = T.SubP",
      "+WHERE \tR.upload_id = @upload_ID",
      " AND TRIM(ISNULL(R.task_ID,'')) <> ''",
      " AND T.task_ID IS NULL",
      " )"
    ]
  },
  {
    "UID": "1030074",
    "Original DIQ Name": "fnDIQ_DS03_Cost_Is0To100BCWSInMoreThanAPeriod",
    "Match Type": "Name matched",
    "Diff": [
      "--- \n",
      "+++ \n",
      "@@ -8,30 +8,32 @@\n",
      " SELECT",
      " WBS_ID_WP,",
      " period_date [Period],",
      "-LEAD(period_date,1) OVER (PARTITION BY WBS_ID_WP, EOC ORDER BY period_date) AS NextPeriod,",
      "+LEAD(period_date,1) OVER (PARTITION BY WBS_ID_WP, EOC, ISNULL(is_indirect,'') ORDER BY period_date) AS NextPeriod,",
      " BCWSi_dollars s_dollars,",
      " BCWSi_hours s_hours,",
      " BCWSi_FTEs s_ftes,",
      "-ISNULL(LEAD(BCWSi_dollars,1) OVER (PARTITION BY WBS_ID_WP, EOC ORDER by period_date),0) AS NextS_dollars,",
      "-ISNULL(LEAD(BCWSi_hours,1) OVER (PARTITION BY WBS_ID_WP, EOC ORDER by period_date),0) AS NextS_hours,",
      "-ISNULL(LEAD(BCWSi_ftes,1) OVER (PARTITION BY WBS_ID_WP, EOC ORDER by period_date),0) AS NextS_ftes,",
      "-EOC",
      "+ISNULL(LEAD(BCWSi_dollars,1) OVER (PARTITION BY WBS_ID_WP, EOC, ISNULL(is_indirect,'') ORDER by period_date),0) AS NextS_dollars,",
      "+ISNULL(LEAD(BCWSi_hours,1) OVER (PARTITION BY WBS_ID_WP, EOC, ISNULL(is_indirect,'') ORDER by period_date),0) AS NextS_hours,",
      "+ISNULL(LEAD(BCWSi_ftes,1) OVER (PARTITION BY WBS_ID_WP, EOC, ISNULL(is_indirect,'') ORDER by period_date),0) AS NextS_ftes,",
      "+EOC,",
      "+ISNULL(is_indirect,'') IsInd",
      " FROM DS03_cost",
      " WHERE upload_ID = @upload_ID AND EVT = 'F'",
      "-),",
      "-Flags as (",
      "-SELECT WBS_ID_WP, [period], NextPeriod",
      "+), Flags as (",
      "+SELECT WBS_ID_WP, [period], NextPeriod, EOC, IsInd",
      " FROM SSpread",
      " WHERE",
      " (s_dollars > 0 AND NextS_dollars > 0) OR",
      " (s_hours > 0 AND NextS_hours > 0) OR",
      " (s_ftes > 0 AND NextS_ftes > 0)",
      "-GROUP BY WBS_ID_WP, [Period], NextPeriod",
      "+GROUP BY WBS_ID_WP, [Period], NextPeriod, EOC, IsInd",
      " )",
      " SELECT",
      " C.*",
      " FROM",
      " DS03_Cost C INNER JOIN Flags F \tON C.WBS_ID_WP = F.WBS_ID_WP",
      "+AND C.EOC = F.EOC",
      "+AND ISNULL(C.is_indirect,'') = F.IsInd",
      " AND (C.period_date = F.[Period] OR C.period_date = F.NextPeriod)",
      " WHERE",
      " upload_ID = @upload_ID"
    ]
  },
  {
    "UID": "1030097",
    "Original DIQ Name": "fnDIQ_DS03_Cost_IsSPAECumEqualToZero",
    "Match Type": "Name matched",
    "Diff": [
      "--- \n",
      "+++ \n",
      "@@ -5,23 +5,20 @@\n",
      " AS RETURN",
      " (",
      " with ToTest AS (",
      "-SELECT",
      "-WBS_ID_CA CAID, WBS_ID_WP WPID, EOC",
      "+SELECT WBS_ID_CA CAID, ISNULL(WBS_ID_WP,'') WPID, EOC, ISNULL(is_indirect,'') IsInd",
      " FROM DS03_cost",
      " WHERE upload_ID = @upload_ID",
      "-GROUP BY WBS_ID_CA, WBS_ID_WP, EOC",
      "+GROUP BY WBS_ID_CA, ISNULL(WBS_ID_WP,''), EOC, ISNULL(is_indirect,'')",
      " HAVING",
      " SUM(BCWSi_Dollars) = 0 AND SUM(BCWSi_hours) = 0 AND SUM(BCWSi_FTEs) = 0 AND",
      " SUM(BCWPi_Dollars) = 0 AND SUM(BCWPi_hours) = 0 AND SUM(BCWPi_FTEs) = 0 AND",
      " SUM(ACWPi_Dollars) = 0 AND SUM(ACWPi_hours) = 0 AND SUM(ACWPi_FTEs) = 0 AND",
      " SUM(ETCi_Dollars) = 0 AND SUM(ETCi_hours) = 0 AND SUM(ETCi_FTEs) = 0",
      " )",
      "-SELECT",
      "-C.*",
      "-FROM",
      "-DS03_Cost C INNER JOIN ToTest T ON C.WBS_ID_CA = T.CAID",
      "-AND C.WBS_ID_WP = T.WPID",
      "+SELECT C.*",
      "+FROM DS03_Cost C INNER JOIN ToTest T ON C.WBS_ID_CA = T.CAID",
      "+AND ISNULL(C.WBS_ID_WP,'') = T.WPID",
      " AND C.EOC = T.EOC",
      "-WHERE",
      "-upload_ID = @upload_ID",
      "+AND ISNULL(C.is_indirect,'') = T.IsInd",
      "+WHERE upload_ID = @upload_ID",
      " )"
    ]
  },
  {
    "UID": "1040202",
    "Original DIQ Name": "fnDIQ_DS04_Sched_IsPlannedCompletionAlignedWithEndOfPMB",
    "Match Type": "Name matched",
    "Diff": [
      "--- \n",
      "+++ \n",
      "@@ -13,7 +13,7 @@\n",
      " FROM DS04_schedule",
      " WHERE upload_ID = @upload_ID AND milestone_level = 175",
      " ), ToFlag as (",
      "-SELECT P.task_ID 'CompTask', P.task_ID 'EOPTask', P.schedule_type",
      "+SELECT P.task_ID 'CompTask', E.task_ID 'EOPTask', P.schedule_type",
      " FROM PCompl P INNER JOIN EOPMB E ON P.schedule_type = E.schedule_type",
      " WHERE P.ES_date <> E.ES_date OR P.EF_date <> E.EF_date",
      " )"
    ]
  },
  {
    "UID": "9040200",
    "Original DIQ Name": "fnDIQ_DS04_Sched_DoesWBSSummaryHaveLogic",
    "Match Type": "Name matched",
    "Diff": [
      "--- \n",
      "+++ \n",
      "@@ -9,6 +9,7 @@\n",
      " FROM",
      " DS04_schedule S INNER JOIN DS05_schedule_logic L ON S.task_ID = L.task_ID",
      " AND S.schedule_type = L.schedule_type",
      "+AND ISNULL(S.subproject_ID,'') = ISNULL(L.subproject_ID,'')",
      " WHERE",
      " S.upload_ID = @upload_ID",
      " AND L.upload_ID = @upload_ID"
    ]
  },
  {
    "UID": "9060283",
    "Original DIQ Name": "fnDIQ_DS06_Res_IsCAOrWBSResourceLoaded",
    "Match Type": "Name matched",
    "Diff": [
      "--- \n",
      "+++ \n",
      "@@ -5,19 +5,11 @@\n",
      " AS RETURN",
      " (",
      " with Task as (",
      "-SELECT WBS_ID, task_ID, schedule_type",
      "+SELECT WBS_ID, task_ID, schedule_type, ISNULL(subproject_ID,'') SubP",
      " FROM DS04_schedule",
      "-WHERE upload_ID = @upload_ID",
      "-), WBS as (",
      "-SELECT WBS_ID",
      "-FROM DS01_WBS",
      "-WHERE upload_ID = @upload_ID AND type IN ('CA','WBS')",
      "+WHERE upload_ID = @upload_ID AND WBS_ID IN (SELECT WBS_ID FROM DS01_WBS WHERE upload_ID = @upload_id AND type IN ('CA','WBS'))",
      " )",
      "-SELECT",
      "-R.*",
      "-FROM",
      "-DS06_schedule_resources R \tINNER JOIN Task T ON R.task_ID = T.task_ID AND R.schedule_type = T.schedule_type",
      "-INNER JOIN WBS W ON T.WBS_ID = W.WBS_ID",
      "-WHERE",
      "-upload_id = @upload_ID",
      "+SELECT R.*",
      "+FROM DS06_schedule_resources R INNER JOIN Task T ON R.task_ID = T.task_ID AND R.schedule_type = T.schedule_type AND ISNULL(R.subproject_ID,'') = T.SubP",
      "+WHERE upload_id = @upload_ID",
      " )"
    ]
  },
  {
    "UID": "1040220",
    "Original DIQ Name": "fnDIQ_DS04_Sched_IsWBSIdMisalignedBtwFCAndBL",
    "Match Type": "Name matched",
    "Diff": [
      "--- \n",
      "+++ \n",
      "@@ -5,19 +5,15 @@\n",
      " AS RETURN",
      " (",
      " with Tasks as (",
      "-SELECT schedule_type, WBS_ID, task_ID",
      "+SELECT schedule_type, WBS_ID, task_ID, ISNULL(subproject_ID,'') SubP",
      " FROM DS04_schedule",
      " WHERE upload_ID = @upload_ID",
      " ), Flags as (",
      "-SELECT F.task_ID",
      "-FROM Tasks F INNER JOIN Tasks B ON F.task_ID = B.task_ID AND F.WBS_ID <> B.WBS_ID",
      "+SELECT F.task_ID, F.SubP",
      "+FROM Tasks F INNER JOIN Tasks B ON F.task_ID = B.task_ID AND F.SubP = B.SubP AND F.WBS_ID <> B.WBS_ID",
      " WHERE F.schedule_type = 'FC' AND B.schedule_type = 'BL'",
      " )",
      "-SELECT",
      "-*",
      "-FROM",
      "-DS04_schedule",
      "-WHERE",
      "-upload_id = @upload_ID",
      "-AND task_ID IN (SELECT task_ID FROM Flags)",
      "+SELECT S.*",
      "+FROM DS04_schedule S INNER JOIN Flags F ON S.task_ID = F.task_ID AND ISNULL(subproject_ID,'') = F.SubP",
      "+WHERE upload_id = @upload_ID",
      " )"
    ]
  },
  {
    "UID": "9040223",
    "Original DIQ Name": "fnDIQ_DS04_Sched_IsWBSMissingInDS03",
    "Match Type": "Name matched",
    "Diff": [
      "--- \n",
      "+++ \n",
      "@@ -4,12 +4,14 @@\n",
      " RETURNS TABLE",
      " AS RETURN",
      " (",
      "-SELECT",
      "-*",
      "-FROM",
      "-DS04_schedule",
      "-WHERE",
      "-upload_id = @upload_ID",
      "-AND TRIM(ISNULL(subtype,'')) = ''",
      "-AND WBS_ID NOT IN (SELECT WBS_ID_WP FROM DS03_cost WHERE upload_ID = @upload_ID)",
      "+WITH Cost_WBS AS (",
      "+SELECT DISTINCT WBS_ID_WP",
      "+FROM DS03_cost",
      "+WHERE upload_ID = @upload_ID",
      " )",
      "+SELECT S.*",
      "+FROM DS04_schedule AS S LEFT JOIN Cost_WBS AS C ON S.WBS_ID = C.WBS_ID_WP",
      "+WHERE \tS.upload_id = @upload_ID",
      "+AND TRIM(ISNULL(S.subtype,'')) = ''",
      "+AND C.WBS_ID_WP IS NULL",
      "+)"
    ]
  },
  {
    "UID": "9040187",
    "Original DIQ Name": "fnDIQ_DS04_Sched_IsLOELogicIncorrect",
    "Match Type": "Name matched",
    "Diff": [
      "--- \n",
      "+++ \n",
      "@@ -5,30 +5,39 @@\n",
      " AS RETURN",
      " (",
      " with Tasks as (",
      "-SELECT schedule_type, task_ID, type, EVT",
      "+SELECT schedule_type, task_ID, type, ISNULL(EVT,'') EVT, ISNULL(subproject_ID,'') SubP",
      " FROM DS04_schedule",
      " WHERE upload_ID = @upload_ID",
      "+), Logic as (",
      "+SELECT schedule_type, task_ID, predecessor_task_ID, type, ISNULL(subproject_ID,'') SubP, ISNULL(predecessor_subproject_ID,'') PSubP FROM DS05_schedule_logic WHERE upload_ID = @upload_id",
      " ), LOELogic as (",
      " SELECT L.*",
      "-FROM DS05_schedule_logic L INNER JOIN Tasks LOE ON L.schedule_type = LOE.schedule_type",
      "+FROM Logic L INNER JOIN Tasks LOE ON L.schedule_type = LOE.schedule_type",
      " AND L.task_ID = LOE.task_ID",
      "-WHERE upload_ID = @upload_ID AND (LOE.[type] = 'LOE' OR LOE.EVT = 'A')",
      "-), Logic as (",
      "-SELECT L.*",
      "+AND L.SubP = LOE.SubP",
      "+WHERE LOE.[type] = 'LOE' OR LOE.EVT IN ('A', 'J', 'M')",
      "+), LOEsWithDisPreds as (",
      "+SELECT L.schedule_type, L.task_ID, L.SubP, STRING_AGG(L.type, ',') WITHIN GROUP (ORDER BY L.type) Type",
      " FROM LOELogic L INNER JOIN Tasks Discrete ON L.schedule_type = Discrete.schedule_type",
      "-AND L.predecessor_task_ID = Discrete.task_ID",
      "-WHERE upload_ID = @upload_ID AND Discrete.type <> 'LOE' AND Discrete.EVT NOT IN ('A','K','M')",
      "-), LogicAgg as (",
      "-SELECT schedule_type, task_ID, STRING_AGG(type, ',') WITHIN GROUP (ORDER BY type) Type",
      "-FROM Logic",
      "-GROUP BY schedule_type, task_ID",
      "+AND L.predecessor_task_ID = Discrete.task_ID --join to predecessor task id",
      "+AND L.PSubP = Discrete.SubP -- join to predecessor subproject id",
      "+WHERE Discrete.Type IN ('TD', 'RD') AND Discrete.EVT NOT IN ('A','J','M')",
      "+GROUP BY L.schedule_type, L.task_ID, L.SubP",
      " )",
      "-SELECT",
      "-S.*",
      "-FROM",
      "-DS04_schedule S INNER JOIN LogicAgg L ON S.schedule_type = L.schedule_type",
      "+SELECT S.*",
      "+FROM DS04_schedule S LEFT OUTER JOIN LOEsWithDisPreds L \tON S.schedule_type = L.schedule_type",
      " AND S.task_ID = L.task_ID",
      "-WHERE",
      "-upload_id = @upload_ID",
      "-AND (L.[Type] NOT LIKE '%SS%FF%' OR\tL.[Type] NOT LIKE '%FF%SS%')",
      "+AND ISNULL(S.subproject_ID,'') = L.SubP",
      "+WHERE upload_id = @upload_ID",
      "+AND (S.type = 'LOE' or S.EVT IN ('A', 'J', 'M'))",
      "+AND (",
      "+L.[Type] NOT LIKE '%SS%FF%' AND L.[Type] NOT LIKE '%FF%SS%' OR --#1",
      "+L.task_ID IS NULL --#3",
      " )",
      "+UNION",
      "+SELECT S.*",
      "+FROM DS04_schedule S INNER JOIN LOELogic L ON S.schedule_type = L.schedule_type",
      "+AND S.task_ID = L.predecessor_task_ID",
      "+AND ISNULL(S.subproject_ID,'') = L.PSubP",
      "+WHERE S.upload_id = @upload_ID AND (S.[type] = 'LOE' OR S.EVT IN ('A', 'J', 'M'))",
      "+)"
    ]
  },
  {
    "UID": "1060256",
    "Original DIQ Name": "fnDIQ_DS06_Res_AreLaborTypeAndEOCMismatched",
    "Match Type": "Name matched",
    "Diff": [
      "--- \n",
      "+++ \n",
      "@@ -4,12 +4,7 @@\n",
      " RETURNS TABLE",
      " AS RETURN",
      " (",
      "-SELECT",
      "-*",
      "-FROM",
      "-DS06_schedule_resources",
      "-WHERE",
      "-upload_id = @upload_ID",
      "-AND type = 'Labor'",
      "-AND EOC NOT IN ('Labor','Overhead')",
      "+SELECT *",
      "+FROM DS06_schedule_resources",
      "+WHERE upload_id = @upload_ID AND type = 'Labor' AND (EOC IS NULL OR EOC NOT IN ('Labor','Indirect'))",
      " )"
    ]
  },
  {
    "UID": "1050236",
    "Original DIQ Name": "fnDIQ_DS05_Logic_PK",
    "Match Type": "Name matched",
    "Diff": [
      "--- \n",
      "+++ \n",
      "@@ -5,18 +5,17 @@\n",
      " AS RETURN",
      " (",
      " with Dupes as (",
      "-SELECT schedule_type, task_ID, predecessor_task_ID",
      "+SELECT schedule_type, task_ID, predecessor_task_ID, ISNULL(subproject_ID,'') SubP, ISNULL(predecessor_subproject_ID,'') PSubP",
      " FROM DS05_schedule_logic",
      " WHERE upload_ID = @upload_ID",
      "-GROUP BY schedule_type, task_ID, predecessor_task_ID",
      "+GROUP BY schedule_type, task_ID, predecessor_task_ID, ISNULL(subproject_ID,''), ISNULL(predecessor_subproject_ID,'')",
      " HAVING COUNT(*) > 1",
      " )",
      "-SELECT",
      "-L.*",
      "-FROM",
      "-DS05_schedule_logic L INNER JOIN Dupes D ON L.schedule_type = D.schedule_type",
      "+SELECT L.*",
      "+FROM DS05_schedule_logic L INNER JOIN Dupes D ON L.schedule_type = D.schedule_type",
      " AND L.task_ID = D.task_ID",
      " AND L.predecessor_task_ID = D.predecessor_task_ID",
      "-WHERE",
      "-upload_id = @upload_ID",
      "+AND ISNULL(L.subproject_ID,'') = D.SubP",
      "+AND ISNULL(L.predecessor_subproject_ID,'') = D.PSubP",
      "+WHERE upload_id = @upload_ID",
      " )"
    ]
  },
  {
    "UID": "1040193",
    "Original DIQ Name": "fnDIQ_DS04_Sched_IsMSLaterThanAppFinishProj",
    "Match Type": "Name matched",
    "Diff": [
      "--- \n",
      "+++ \n",
      "@@ -5,7 +5,7 @@\n",
      " AS RETURN",
      " (",
      " with MS199 as (",
      "-SELECT EF_Date, schedule_type",
      "+SELECT EF_Date, schedule_type, ISNULL(subproject_ID,'') SubP",
      " FROM DS04_schedule",
      " WHERE upload_ID = @upload_ID AND milestone_level = 199",
      " )",
      "@@ -13,6 +13,7 @@\n",
      " S.*",
      " FROM",
      " DS04_schedule S INNER JOIN MS199 M \tON S.schedule_type = M.schedule_type",
      "+AND ISNULL(S.subproject_ID,'') = M.SubP",
      " AND S.EF_date > M.EF_date",
      " WHERE",
      " upload_id = @upload_ID"
    ]
  },
  {
    "UID": "1060259",
    "Original DIQ Name": "fnDIQ_DS06_Res_PK",
    "Match Type": "Name matched",
    "Diff": [
      "--- \n",
      "+++ \n",
      "@@ -5,19 +5,18 @@\n",
      " AS RETURN",
      " (",
      " with Dupes as (",
      "-SELECT schedule_type, task_ID, ISNULL(resource_ID,'') resource_ID, ISNULL(role_id,'') role_id",
      "+SELECT schedule_type, task_ID, ISNULL(EOC,'') EOC, ISNULL(resource_ID,'') resource_ID, ISNULL(role_id,'') role_id, ISNULL(subproject_ID,'') SubP",
      " FROM DS06_schedule_resources",
      " WHERE upload_id = @upload_ID",
      "-GROUP BY schedule_type, task_ID, ISNULL(resource_ID,''), ISNULL(role_id,'')",
      "+GROUP BY schedule_type, task_ID, ISNULL(EOC,''), ISNULL(resource_ID,''), ISNULL(role_id,''), ISNULL(subproject_ID,'')",
      " HAVING COUNT(*) > 1",
      " )",
      "-SELECT",
      "-R.*",
      "-FROM",
      "-DS06_schedule_resources R INNER JOIN Dupes D ON R.schedule_type = D.schedule_type",
      "+SELECT R.*",
      "+FROM DS06_schedule_resources R INNER JOIN Dupes D \tON R.schedule_type = D.schedule_type",
      " AND R.task_ID = D.task_ID",
      " AND ISNULL(R.resource_ID,'') = D.resource_ID",
      " AND ISNULL(R.role_id,'') = D.role_id",
      "-WHERE",
      "-upload_id = @upload_ID",
      "+AND ISNULL(R.subproject_ID,'') = D.SubP",
      "+AND ISNULL(R.EOC,'') = D.EOC",
      "+WHERE upload_id = @upload_ID",
      " )"
    ]
  },
  {
    "UID": "9060287",
    "Original DIQ Name": "fnDIQ_DS06_Res_AreLaborPUnitsMisalignedWithDS03LaborPHours",
    "Match Type": "Name matched",
    "Diff": [
      "--- \n",
      "+++ \n",
      "@@ -7,33 +7,29 @@\n",
      " with CostWBS as (",
      " SELECT WBS_ID_WP WBS, SUM(BCWPi_hours) BCWP",
      " FROM DS03_cost",
      "-WHERE upload_ID = @upload_ID AND EOC = 'Labor'",
      "+WHERE upload_ID = @upload_ID AND EOC = 'Labor' AND ISNULL(is_indirect,'') <> 'Y'",
      " GROUP BY WBS_ID_WP",
      " ), ScheduleWBS as (",
      "-SELECT",
      "-S.WBS_ID WBS,",
      "-SUM(R.actual_units) Performance",
      "-FROM",
      "-DS04_schedule S INNER JOIN DS06_schedule_resources R ON S.task_ID = R.task_ID",
      "-WHERE",
      "-S.upload_ID = @upload_ID",
      "+SELECT S.WBS_ID WBS, ISNULL(S.subproject_ID,'') SubP, SUM(R.actual_units) Performance",
      "+FROM DS04_schedule S INNER JOIN DS06_schedule_resources R ON S.task_ID = R.task_ID AND ISNULL(S.subproject_ID,'') = ISNULL(R.subproject_ID,'')",
      "+WHERE\tS.upload_ID = @upload_ID",
      " AND R.upload_ID = @upload_ID",
      " AND R.schedule_type = 'FC'",
      " AND S.schedule_type = 'FC'",
      " AND (R.EOC = 'Labor' Or R.[type] = 'Labor')",
      "-GROUP BY S.WBS_ID",
      "+GROUP BY S.WBS_ID, ISNULL(S.subproject_ID,'')",
      " ), FlagsByWBS as (",
      "-SELECT S.WBS",
      "+SELECT S.WBS, S.SubP",
      " FROM ScheduleWBS S INNER JOIN CostWBS C ON C.WBS = S.WBS AND C.BCWP <> S.Performance",
      " ), FlagsByTask as (",
      "-SELECT S.task_ID",
      "-FROM DS04_schedule S INNER JOIN FlagsByWBS F ON S.WBS_ID = F.WBS",
      "+SELECT S.task_ID, F.SubP",
      "+FROM DS04_schedule S INNER JOIN FlagsByWBS F ON S.WBS_ID = F.WBS AND ISNULL(S.subproject_ID,'') = F.SubP",
      " WHERE upload_ID = @upload_ID AND schedule_type = 'FC'",
      " )",
      " SELECT",
      " R.*",
      " FROM",
      "-DS06_schedule_resources R INNER JOIN FlagsByTask F ON F.task_ID = R.task_ID",
      "+DS06_schedule_resources R INNER JOIN FlagsByTask F ON R.task_ID = F.task_ID AND ISNULL(R.subproject_ID,'') = F.SubP",
      " WHERE",
      " R.upload_id = @upload_ID",
      " AND R.schedule_type = 'FC'"
    ]
  },
  {
    "UID": "9040216",
    "Original DIQ Name": "fnDIQ_DS04_Sched_IsTaskMissingLogic",
    "Match Type": "Name matched",
    "Diff": [
      "--- \n",
      "+++ \n",
      "@@ -5,7 +5,7 @@\n",
      " AS RETURN",
      " (",
      " with Logic as (",
      "-SELECT schedule_type, task_ID",
      "+SELECT schedule_type, task_ID, subproject_ID",
      " FROM DS05_schedule_logic",
      " WHERE upload_ID = @upload_ID",
      " )",
      "@@ -14,6 +14,7 @@\n",
      " FROM",
      " DS04_schedule S LEFT OUTER JOIN Logic L ON S.schedule_type = L.schedule_type",
      " AND S.task_ID = L.task_ID",
      "+AND ISNULL(S.subproject_ID,'') = ISNULL(L.subproject_ID,'')",
      " WHERE",
      " S.upload_id = @upload_ID",
      " AND ISNULL(S.milestone_level,0) <> 100"
    ]
  },
  {
    "UID": "9040219",
    "Original DIQ Name": "fnDIQ_DS04_Sched_IsUnitsPCTypeResourcedWithNonMaterialEOC",
    "Match Type": "Name matched",
    "Diff": [
      "--- \n",
      "+++ \n",
      "@@ -5,16 +5,13 @@\n",
      " AS RETURN",
      " (",
      " with NonMatRes as (",
      "-SELECT schedule_type, task_ID",
      "+SELECT schedule_type, task_ID, ISNULL(subproject_ID,'') SubP",
      " FROM DS06_schedule_resources",
      "-WHERE upload_ID = @upload_ID AND EOC <> 'material'",
      "+WHERE upload_ID = @upload_ID AND ISNULL(EOC,'') <> 'material'",
      " )",
      "-SELECT",
      "-S.*",
      "-FROM",
      "-DS04_schedule S INNER JOIN NonMatRes R \tON S.task_ID = R.task_ID",
      "+SELECT S.*",
      "+FROM DS04_schedule S INNER JOIN NonMatRes R ON S.task_ID = R.task_ID",
      " AND S.schedule_type = R.schedule_type",
      "-WHERE",
      "-upload_id = @upload_ID",
      "-AND PC_type = 'units'",
      "+AND ISNULL(S.subproject_ID,'') = R.SubP",
      "+WHERE upload_id = @upload_ID AND PC_type = 'units'",
      " )"
    ]
  },
  {
    "UID": "1040176",
    "Original DIQ Name": "fnDIQ_DS04_Sched_IsEVTJustificationMissing",
    "Match Type": "Name matched",
    "Diff": [
      "--- \n",
      "+++ \n",
      "@@ -11,5 +11,5 @@\n",
      " WHERE",
      " upload_id = @upload_ID",
      " AND EVT in ('B', 'G', 'H', 'J', 'L', 'M', 'N', 'O', 'P')",
      "-AND TRIM(ISNULL(justification_EVT,'')) = ''",
      "+AND (TRIM(ISNULL(justification_EVT,'')) = '' OR CHARINDEX(' ',TRIM([justification_float_high])) = 0)",
      " )"
    ]
  },
  {
    "UID": "9040222",
    "Original DIQ Name": "fnDIQ_DS04_Sched_IsWBSMissingInDS01",
    "Match Type": "Name matched",
    "Diff": [
      "--- \n",
      "+++ \n",
      "@@ -4,11 +4,11 @@\n",
      " RETURNS TABLE",
      " AS RETURN",
      " (",
      "-SELECT",
      "-*",
      "-FROM",
      "-DS04_schedule",
      "-WHERE",
      "-upload_id = @upload_ID",
      "-AND WBS_ID NOT IN (SELECT WBS_ID FROM DS01_WBS WHERE upload_ID = @upload_ID)",
      "+with DS01 as (",
      "+SELECT DISTINCT WBS_ID FROM DS01_WBS WHERE upload_ID = @upload_ID",
      " )",
      "+SELECT S.*",
      "+FROM DS04_schedule S LEFT JOIN DS01 ON S.WBS_ID = DS01.WBS_ID",
      "+WHERE \tupload_id = @upload_ID",
      "+AND DS01.WBS_ID IS NULL",
      "+)"
    ]
  },
  {
    "UID": "1040184",
    "Original DIQ Name": "fnDIQ_DS04_Sched_IsHighFloatJustificationMissingFC",
    "Match Type": "Name matched",
    "Diff": [
      "--- \n",
      "+++ \n",
      "@@ -15,8 +15,8 @@\n",
      " DS04_schedule",
      " WHERE",
      " upload_id = @upload_ID",
      "-AND schedule_type = 'FC'",
      "-AND float_total_days / NULLIF((SELECT TOP 1 RemDur FROM RemDur),0) >= .1",
      "-AND TRIM(ISNULL(justification_float_high,''))=''",
      "-AND (SELECT TOP 1 RemDur FROM RemDur) > 0",
      "+AND schedule_type = 'FC' --FC tasks only",
      "+AND float_total_days / NULLIF((SELECT TOP 1 RemDur FROM RemDur),0) >= .1 --float > 10% of remaining duration",
      "+AND TRIM(ISNULL(justification_float_high,''))='' --no justification",
      "+AND (SELECT TOP 1 RemDur FROM RemDur) > 0 -- remaining duration > 0 days",
      " )"
    ]
  },
  {
    "UID": "9070362",
    "Original DIQ Name": "fnDIQ_DS07_IPMR_AreEACPMLikelyAndDS08BudgetsIncommensurate",
    "Match Type": "Name matched",
    "Diff": [
      "--- \n",
      "+++ \n",
      "@@ -9,7 +9,7 @@\n",
      " ISNULL(budget_labor_dollars,0) +",
      " ISNULL(budget_material_dollars,0) +",
      " ISNULL(budget_ODC_dollars,0) +",
      "-ISNULL(budget_overhead_dollars,0) +",
      "+ISNULL(budget_indirect_dollars,0) +",
      " ISNULL(budget_subcontract_dollars,0)",
      " ) BAC",
      " FROM DS08_WAD"
    ]
  },
  {
    "UID": "9200596",
    "Original DIQ Name": "fnDIQ_DS20_Sched_CAL_Excpt_IsCalNameMissingInDS19",
    "Match Type": "Name matched",
    "Diff": [
      "--- \n",
      "+++ \n",
      "@@ -4,14 +4,11 @@\n",
      " RETURNS TABLE",
      " AS RETURN",
      " (",
      "-SELECT",
      "-*",
      "-FROM DS20_schedule_calendar_exception",
      "+SELECT Exc.*",
      "+FROM DS20_schedule_calendar_exception Exc LEFT OUTER JOIN DS19_schedule_calendar_std Std ON Exc.calendar_name = Std.calendar_name",
      "+AND ISNULL(Exc.subproject_ID,'') = ISNULL(Std.subproject_ID,'')",
      " WHERE",
      "-upload_ID = @upload_ID",
      "-AND calendar_name NOT IN (",
      "-SELECT calendar_name",
      "-FROM DS19_schedule_calendar_std",
      "-WHERE upload_ID = @upload_ID",
      "+Exc.upload_ID = @upload_ID",
      "+AND Std.upload_ID = @upload_ID",
      "+AND Std.calendar_name IS NULL --return only missed joins",
      " )",
      "-)"
    ]
  },
  {
    "UID": "1040107",
    "Original DIQ Name": "fnDIQ_DS04_Sched_Are1xxMSsOutOfOrder",
    "Match Type": "Name matched",
    "Diff": [
      "--- \n",
      "+++ \n",
      "@@ -5,34 +5,50 @@\n",
      " AS RETURN",
      " (",
      " with MSList as (",
      "-SELECT ES_date, LEAD(ES_date,1) OVER (PARTITION BY schedule_type ORDER BY milestone_level) as NextES, schedule_type, task_ID",
      "+SELECT \tES_date,",
      "+LEAD(ES_date,1) OVER (PARTITION BY schedule_type ORDER BY milestone_level) as NextES,",
      "+schedule_type,",
      "+task_ID,",
      "+milestone_level,",
      "+LEAD(milestone_level,1) OVER (PARTITION BY schedule_type ORDER BY milestone_level) as NextMilestoneLevel,",
      "+ISNULL(subproject_ID,'') SubP",
      " FROM DS04_schedule",
      "-WHERE",
      "-upload_ID = @upload_ID",
      "+WHERE upload_ID = @upload_ID",
      " AND (",
      " milestone_level BETWEEN 100 AND 139",
      " OR milestone_level = 150",
      " OR milestone_level BETWEEN 170 AND 199",
      " )",
      " UNION",
      "-SELECT ES_date, LEAD(ES_date,1) OVER (PARTITION BY schedule_type ORDER BY milestone_level) as NextES, schedule_type, task_ID",
      "+SELECT \tES_date,",
      "+LEAD(ES_date,1) OVER (PARTITION BY schedule_type ORDER BY milestone_level) as NextES,",
      "+schedule_type,",
      "+task_ID,",
      "+milestone_level,",
      "+LEAD(milestone_level,1) OVER (PARTITION BY schedule_type ORDER BY milestone_level) as NextMilestoneLevel,",
      "+ISNULL(subproject_ID,'') SubP",
      " FROM DS04_schedule",
      "+WHERE upload_ID = @upload_ID AND milestone_level BETWEEN 140 AND 145",
      "+UNION",
      "+SELECT \tES_date,",
      "+LEAD(ES_date,1) OVER (PARTITION BY schedule_type ORDER BY milestone_level) as NextES,",
      "+schedule_type,",
      "+task_ID,",
      "+milestone_level,",
      "+LEAD(milestone_level,1) OVER (PARTITION BY schedule_type ORDER BY milestone_level) as NextMilestoneLevel,",
      "+ISNULL(subproject_ID,'') SubP",
      "+FROM DS04_schedule",
      "+WHERE upload_ID = @upload_ID AND milestone_level BETWEEN 160 AND 165",
      "+), Flags as (",
      "+SELECT *",
      "+FROM MSList",
      " WHERE",
      "-upload_ID = @upload_ID",
      "-AND milestone_level BETWEEN 140 AND 145",
      "-UNION",
      "-SELECT ES_date, LEAD(ES_date,1) OVER (PARTITION BY schedule_type ORDER BY milestone_level) as NextES, schedule_type, task_ID",
      "-FROM DS04_schedule",
      "-WHERE",
      "-upload_ID = @upload_ID",
      "-AND milestone_level BETWEEN 160 AND 165",
      "+milestone_level = 170 AND NextMilestoneLevel = 175 AND ES_date > NextES",
      "+OR \t((milestone_level <> 170 OR NextMilestoneLevel <> 175) AND milestone_level <> NextMilestoneLevel AND ES_date >= NextES)",
      " )",
      "-SELECT",
      "-S.*",
      "-FROM",
      "-DS04_schedule S INNER JOIN MSList M ON S.task_ID = M.task_ID",
      "-AND S.schedule_type = M.schedule_type",
      "-AND M.ES_date >= M.NextES",
      "-WHERE",
      "-upload_id = @upload_ID",
      "+SELECT S.*",
      "+FROM DS04_schedule S INNER JOIN Flags F ON S.task_ID = F.task_ID",
      "+AND S.schedule_type = F.schedule_type",
      "+AND ISNULL(S.subproject_ID,'') = F.SubP",
      "+WHERE upload_id = @upload_ID",
      " )"
    ]
  },
  {
    "UID": "1040145",
    "Original DIQ Name": "fnDIQ_DS04_Sched_IsBLTaskMissingInFC",
    "Match Type": "Name matched",
    "Diff": [
      "--- \n",
      "+++ \n",
      "@@ -4,16 +4,17 @@\n",
      " RETURNS TABLE",
      " AS RETURN",
      " (",
      "-SELECT",
      "-*",
      "-FROM",
      "-DS04_schedule",
      "-WHERE",
      "-upload_id = @upload_ID",
      "-AND schedule_type = 'BL'",
      "-AND task_ID NOT IN (",
      "-SELECT task_ID",
      "+with FCTasks as (",
      "+SELECT task_ID, ISNULL(subproject_ID,'') SubP",
      " FROM DS04_schedule",
      " WHERE upload_ID = @upload_ID AND schedule_type = 'FC'",
      " )",
      "+SELECT",
      "+B.*",
      "+FROM",
      "+DS04_schedule B LEFT OUTER JOIN FCTasks F ON B.task_ID = F.task_ID AND ISNULL(B.subproject_ID,'') = F.SubP",
      "+WHERE",
      "+upload_id = @upload_ID",
      "+AND schedule_type = 'BL' -- Baseline Tasks",
      "+AND F.task_ID IS NULL --Any missed joins fail",
      " )"
    ]
  },
  {
    "UID": "9030072",
    "Original DIQ Name": "fnDIQ_DS03_Cost_IsWPOrPPMissingInDS04FC",
    "Match Type": "Name matched",
    "Diff": [
      "--- \n",
      "+++ \n",
      "@@ -4,15 +4,8 @@\n",
      " RETURNS TABLE",
      " AS RETURN",
      " (",
      "-SELECT",
      "-*",
      "-FROM",
      "-DS03_Cost C",
      "-WHERE",
      "-C.upload_ID = @upload_ID",
      "-AND C.WBS_ID_WP NOT IN (",
      "-SELECT WBS_ID",
      "-FROM DS04_schedule",
      "-WHERE upload_ID = @upload_ID AND schedule_type = 'FC'",
      "+SELECT C.*",
      "+FROM DS03_Cost C",
      "+LEFT JOIN DS04_schedule S ON C.WBS_ID_WP = S.WBS_ID AND S.upload_ID = @upload_ID AND S.schedule_type = 'FC'",
      "+WHERE C.upload_ID = @upload_ID AND S.WBS_ID IS NULL",
      " )",
      "-)"
    ]
  },
  {
    "UID": "1050234",
    "Original DIQ Name": "fnDIQ_DS05_Logic_IsSSorFFRelTypeImproperlyLinked",
    "Match Type": "Name matched",
    "Diff": [
      "--- \n",
      "+++ \n",
      "@@ -5,18 +5,16 @@\n",
      " AS RETURN",
      " (",
      " with Flags as (",
      "-SELECT schedule_type, predecessor_task_ID, STRING_AGG(type, ',') WITHIN GROUP (ORDER BY type) Type",
      "+SELECT schedule_type, predecessor_task_ID, ISNULL(predecessor_subproject_ID,'') PSubP, STRING_AGG(type, ',') WITHIN GROUP (ORDER BY type) Type",
      " FROM DS05_schedule_logic",
      " WHERE upload_ID = @upload_ID",
      "-GROUP BY schedule_type, predecessor_task_ID",
      "+GROUP BY schedule_type, predecessor_task_ID, ISNULL(predecessor_subproject_ID,'')",
      " )",
      "-SELECT",
      "-L.*",
      "-FROM",
      "-DS05_schedule_logic L INNER JOIN Flags F ON L.schedule_type = F.schedule_type",
      "+SELECT L.*",
      "+FROM DS05_schedule_logic L INNER JOIN Flags F \tON L.schedule_type = F.schedule_type",
      " AND L.predecessor_task_ID = F.predecessor_task_ID",
      "-WHERE",
      "-upload_ID = @upload_ID",
      "+AND ISNULL(L.predecessor_subproject_ID,'') = F.PSubP",
      "+WHERE upload_ID = @upload_ID",
      " AND (",
      " F.[Type] LIKE '%SS%FS%'",
      " OR\tF.[Type] LIKE '%FS%SS%'"
    ]
  },
  {
    "UID": "1060261",
    "Original DIQ Name": "fnDIQ_DS06_Res_IsFCResourceMissingInBL",
    "Match Type": "Name matched",
    "Diff": [
      "--- \n",
      "+++ \n",
      "@@ -5,7 +5,7 @@\n",
      " AS RETURN",
      " (",
      " with BLRes as (",
      "-SELECT task_ID, TRIM(ISNULL(resource_ID,'')) ResID, TRIM(ISNULL(role_ID,'')) RoleID, EOC",
      "+SELECT task_ID, ISNULL(subproject_ID,'') SubP, TRIM(ISNULL(resource_ID,'')) ResID, TRIM(ISNULL(role_ID,'')) RoleID, EOC",
      " FROM DS06_schedule_resources",
      " WHERE upload_id = @upload_ID AND schedule_type = 'BL'",
      " )",
      "@@ -13,6 +13,7 @@\n",
      " FCR.*",
      " FROM",
      " DS06_schedule_resources FCR LEFT OUTER JOIN BLRes ON FCR.task_ID = BLRes.task_ID",
      "+AND ISNULL(FCR.subproject_ID,'') = BLRes.SubP",
      " AND TRIM(ISNULL(FCR.resource_ID,'')) = BLRes.ResID",
      " AND TRIM(ISNULL(FCR.role_ID,'')) = BLRes.RoleID",
      " AND FCR.EOC = BLRes.EOC"
    ]
  },
  {
    "UID": "9030100",
    "Original DIQ Name": "fnDIQ_DS03_Cost_IsWorkMissingResourcesInDS06",
    "Match Type": "Name matched",
    "Diff": [
      "--- \n",
      "+++ \n",
      "@@ -6,22 +6,19 @@\n",
      " (",
      " with Resources As (",
      " SELECT S.WBS_ID, R.EOC",
      "-FROM DS04_schedule S INNER JOIN DS06_schedule_resources R ON S.task_ID = R.task_ID",
      "-WHERE",
      "-S.upload_ID = @upload_ID",
      "+FROM DS04_schedule S INNER JOIN DS06_schedule_resources R ON S.task_ID = R.task_ID AND ISNULL(S.subproject_ID,'') = ISNULL(R.subproject_ID,'')",
      "+WHERE\tS.upload_ID = @upload_ID",
      " AND R.upload_ID = @upload_ID",
      " AND S.schedule_type = 'BL'",
      " AND R.schedule_type = 'BL'",
      " AND (R.budget_dollars > 0 OR R.budget_units > 0)",
      " GROUP BY S.WBS_ID, R.EOC",
      " )",
      "-SELECT",
      "-C.*",
      "-FROM",
      "-DS03_Cost C LEFT OUTER JOIN Resources R ON C.WBS_ID_WP = R.WBS_ID",
      "-AND C.EOC = R.EOC",
      "+SELECT C.*",
      "+FROM DS03_Cost C LEFT OUTER JOIN Resources R ON C.WBS_ID_WP = R.WBS_ID",
      "+AND CASE WHEN ISNULL(C.is_indirect,'') = 'Y' THEN 'Indirect' ELSE C.EOC END = R.EOC",
      " WHERE",
      " upload_ID = @upload_ID",
      " AND (BCWSi_dollars <> 0 OR BCWSi_FTEs <> 0 AND BCWSi_hours <> 0)",
      "-AND R.wbs_ID IS NULL",
      "+AND R.wbs_ID IS NULL -- Any missing joins are our failed rows",
      " )"
    ]
  },
  {
    "UID": "9210602",
    "Original DIQ Name": "fnDIQ_DS21_Rates_IsWBSAndEOCComboMissingInDS06",
    "Match Type": "Name matched",
    "Diff": [
      "--- \n",
      "+++ \n",
      "@@ -4,12 +4,9 @@\n",
      " RETURNS TABLE",
      " AS RETURN",
      " (",
      "-SELECT",
      "-R.*",
      "-FROM",
      "-DS21_rates R LEFT OUTER JOIN DS06_schedule_resources Res ON R.resource_ID = Res.resource_ID AND R.EOC = Res.EOC",
      "-WHERE",
      "-R.upload_ID = @upload_ID",
      "+SELECT R.*",
      "+FROM DS21_rates R LEFT OUTER JOIN DS06_schedule_resources Res ON R.resource_ID = Res.resource_ID AND R.EOC = Res.EOC",
      "+WHERE \tR.upload_ID = @upload_ID",
      " AND Res.upload_ID = @upload_ID",
      " AND Res.schedule_type = 'FC'",
      " AND Res.resource_ID IS NULL"
    ]
  },
  {
    "UID": "9010015",
    "Original DIQ Name": "fnDIQ_DS01_WBS_IsWBSMissingInDS04FC",
    "Match Type": "Name matched",
    "Diff": [
      "--- \n",
      "+++ \n",
      "@@ -5,15 +5,11 @@\n",
      " AS RETURN",
      " (",
      " SELECT",
      "-*",
      "+W.*",
      " FROM",
      "-DS01_WBS",
      "+DS01_WBS W LEFT JOIN DS04_schedule S on W.WBS_ID = S.WBS_ID AND S.schedule_type = 'FC' AND S.upload_ID = @upload_ID",
      " WHERE",
      "-upload_ID = @upload_ID",
      "-AND type in ('WP', 'PP')",
      "-AND WBS_ID NOT IN (",
      "-SELECT WBS_ID",
      "-FROM DS04_schedule",
      "-WHERE upload_ID = @upload_ID AND schedule_type = 'FC'",
      "+W.upload_ID = @upload_ID",
      "+AND W.[type] in ('WP', 'PP')",
      "+AND S.WBS_ID IS NULL",
      " )",
      "-)"
    ]
  },
  {
    "UID": "9070369",
    "Original DIQ Name": "fnDIQ_DS07_IPMR_ArePMBAndMRNotEqToCBB",
    "Match Type": "Name matched",
    "Diff": [
      "--- \n",
      "+++ \n",
      "@@ -9,7 +9,7 @@\n",
      " SUM(ISNULL(budget_labor_dollars,0) +",
      " ISNULL(budget_material_dollars,0) +",
      " ISNULL(budget_ODC_dollars,0) +",
      "-ISNULL(budget_overhead_dollars,0) +",
      "+ISNULL(budget_indirect_dollars,0) +",
      " ISNULL(budget_subcontract_dollars,0)",
      " ) as BAC",
      " FROM DS08_WAD"
    ]
  },
  {
    "UID": "1060260",
    "Original DIQ Name": "fnDIQ_DS06_Res_IsBLResourceMissingInFC",
    "Match Type": "Name matched",
    "Diff": [
      "--- \n",
      "+++ \n",
      "@@ -5,14 +5,13 @@\n",
      " AS RETURN",
      " (",
      " with FCRes as (",
      "-SELECT task_ID, TRIM(ISNULL(resource_ID,'')) ResID, TRIM(ISNULL(role_ID,'')) RoleID, EOC",
      "+SELECT task_ID, ISNULL(subproject_ID,'') SubP, TRIM(ISNULL(resource_ID,'')) ResID, TRIM(ISNULL(role_ID,'')) RoleID, EOC",
      " FROM DS06_schedule_resources",
      " WHERE upload_id = @upload_ID AND schedule_type = 'FC'",
      " )",
      "-SELECT",
      "-BLR.*",
      "-FROM",
      "-DS06_schedule_resources BLR LEFT OUTER JOIN FCRes ON BLR.task_ID = FCRes.task_ID",
      "+SELECT BLR.*",
      "+FROM DS06_schedule_resources BLR LEFT OUTER JOIN FCRes \tON BLR.task_ID = FCRes.task_ID",
      "+AND ISNULL(BLR.subproject_ID,'') = FCRes.SubP",
      " AND TRIM(ISNULL(BLR.resource_ID,'')) = FCRes.ResID",
      " AND TRIM(ISNULL(BLR.role_ID,'')) = FCRes.RoleID",
      " AND BLR.EOC = FCRes.EOC"
    ]
  },
  {
    "UID": "9180588",
    "Original DIQ Name": "fnDIQ_DS18_Sched_EU_IsEUMaxLtDS04OrigDur",
    "Match Type": "Name matched",
    "Diff": [
      "--- \n",
      "+++ \n",
      "@@ -4,12 +4,12 @@\n",
      " RETURNS TABLE",
      " AS RETURN",
      " (",
      "-SELECT",
      "-E.*",
      "-FROM",
      "-DS18_schedule_EU E INNER JOIN DS04_schedule S ON E.task_ID = S.task_ID AND E.schedule_type = S.schedule_type",
      "+SELECT E.*",
      "+FROM DS18_schedule_EU E INNER JOIN DS04_schedule S \tON E.task_ID = S.task_ID",
      "+AND E.schedule_type = S.schedule_type",
      "+AND ISNULL(E.subproject_ID,'') = ISNULL(S.subproject_ID,'')",
      "+AND EU_max_days < duration_original_days",
      " WHERE",
      " E.upload_ID = @upload_ID",
      " AND S.upload_ID = @upload_ID",
      "-AND EU_max_days < duration_original_days",
      " )"
    ]
  },
  {
    "UID": "9040224",
    "Original DIQ Name": "fnDIQ_DS04_Sched_IsWBSSummaryResourceLoaded",
    "Match Type": "Name matched",
    "Diff": [
      "--- \n",
      "+++ \n",
      "@@ -5,14 +5,16 @@\n",
      " AS RETURN",
      " (",
      " with Rsrcs as (",
      "-SELECT task_ID, schedule_type",
      "+SELECT task_ID, schedule_type, ISNULL(subproject_ID,'') SubP",
      " FROM DS06_schedule_resources",
      " WHERE upload_ID = @upload_ID",
      " )",
      " SELECT",
      " S.*",
      " FROM",
      "-DS04_schedule S INNER JOIN Rsrcs R ON S.task_ID = R.task_ID AND S.schedule_type = R.schedule_type",
      "+DS04_schedule S INNER JOIN Rsrcs R \tON S.task_ID = R.task_ID",
      "+AND S.schedule_type = R.schedule_type",
      "+AND ISNULL(S.subproject_ID,'') = R.SubP",
      " WHERE",
      " upload_id = @upload_ID",
      " AND type = 'WS'"
    ]
  },
  {
    "UID": "1040215",
    "Original DIQ Name": "fnDIQ_DS04_Sched_PK",
    "Match Type": "Name matched",
    "Diff": [
      "--- \n",
      "+++ \n",
      "@@ -5,10 +5,10 @@\n",
      " AS RETURN",
      " (",
      " with Dupes as (",
      "-SELECT task_ID, schedule_type",
      "+SELECT task_ID, schedule_type, ISNULL(subproject_ID,'') SubP",
      " FROM DS04_schedule",
      " WHERE upload_ID = @upload_ID",
      "-GROUP BY task_ID, schedule_type",
      "+GROUP BY task_ID, schedule_type, ISNULL(subproject_ID,'')",
      " HAVING COUNT(*) > 1",
      " )",
      " SELECT",
      "@@ -16,6 +16,7 @@\n",
      " FROM",
      " DS04_schedule S INNER JOIN Dupes D \tON S.task_ID = D.task_ID",
      " AND S.schedule_type = D.schedule_type",
      "+AND ISNULL(S.subproject_ID,'') = D.SubP",
      " WHERE",
      " upload_id = @upload_ID",
      " )"
    ]
  },
  {
    "UID": "1060237",
    "Original DIQ Name": "fnDIQ_DS06_Res_IsBudgetEqToZero",
    "Match Type": "Name matched",
    "Diff": [
      "--- \n",
      "+++ \n",
      "@@ -10,5 +10,8 @@\n",
      " DS06_schedule_resources",
      " WHERE",
      " upload_id = @upload_ID",
      "-AND (budget_dollars = 0 OR budget_units = 0)",
      "+AND (",
      "+budget_dollars = 0 OR",
      "+budget_units = 0 AND EOC <> 'Indirect'",
      " )",
      "+)"
    ]
  },
  {
    "UID": "1030108",
    "Original DIQ Name": "fnDIQ_DS03_Cost_PK",
    "Match Type": "Name matched",
    "Diff": [
      "--- \n",
      "+++ \n",
      "@@ -5,20 +5,18 @@\n",
      " AS RETURN",
      " (",
      " with Dupes as (",
      "-SELECT period_date, WBS_ID_CA, ISNULL(WBS_ID_WP,'') WBS_ID_WP, EOC, ISNULL(EVT,'') EVT",
      "+SELECT period_date, WBS_ID_CA, ISNULL(WBS_ID_WP,'') WBS_ID_WP, EOC, ISNULL(EVT,'') EVT, ISNULL(is_indirect,'') IsInd",
      " FROM DS03_cost",
      " WHERE upload_ID = @upload_ID",
      "-GROUP BY period_date, WBS_ID_CA, ISNULL(WBS_ID_WP,''), EOC, ISNULL(EVT,'')",
      "+GROUP BY period_date, WBS_ID_CA, ISNULL(WBS_ID_WP,''), EOC, ISNULL(EVT,''), ISNULL(is_indirect,'')",
      " HAVING COUNT(*) > 1",
      " )",
      "-SELECT",
      "-C.*",
      "-FROM",
      "-DS03_Cost C INNER JOIN Dupes D \tON C.period_date = D.period_date",
      "+SELECT C.*",
      "+FROM DS03_Cost C INNER JOIN Dupes D ON C.period_date = D.period_date",
      " AND C.WBS_ID_CA = D.WBS_ID_CA",
      " AND ISNULL(C.WBS_ID_WP,'') = D.WBS_ID_WP",
      " AND C.EOC = D.EOC",
      " AND ISNULL(C.EVT,'') = D.EVT",
      "-WHERE",
      "-upload_ID = @upload_ID",
      "+AND ISNULL(C.is_indirect,'') = D.IsInd",
      "+WHERE upload_ID = @upload_ID",
      " )"
    ]
  },
  {
    "UID": "1040160",
    "Original DIQ Name": "fnDIQ_DS04_Sched_IsCDOrBCPDuplicated",
    "Match Type": "Name matched",
    "Diff": [
      "--- \n",
      "+++ \n",
      "@@ -5,22 +5,21 @@\n",
      " AS RETURN",
      " (",
      " with Fails AS (",
      "-SELECT schedule_type, milestone_level",
      "+SELECT schedule_type, milestone_level, ISNULL(subproject_ID,'') SubP",
      " FROM DS04_schedule",
      " WHERE",
      " upload_ID = @upload_ID",
      " AND\tmilestone_level BETWEEN 100 AND 199",
      " AND milestone_level NOT IN (138,139)",
      "-GROUP BY schedule_type, milestone_level",
      "+GROUP BY schedule_type, milestone_level, ISNULL(subproject_ID,'')",
      " HAVING COUNT(*) > 1",
      " )",
      " SELECT",
      " S.*",
      " FROM",
      "-DS04_schedule S,",
      "-Fails F",
      "+DS04_schedule S INNER JOIN Fails F  ON S.schedule_type = F.schedule_type",
      "+AND S.milestone_level = F.milestone_level",
      "+AND ISNULL(S.subproject_ID,'') = F.SubP",
      " WHERE",
      " upload_ID = @upload_ID",
      "-AND S.schedule_type = F.schedule_type",
      "-AND S.milestone_level = F.milestone_level",
      " )"
    ]
  },
  {
    "UID": "9040214",
    "Original DIQ Name": "fnDIQ_DS04_Sched_IsSVTOrZBAResourceLoaded",
    "Match Type": "Name matched",
    "Diff": [
      "--- \n",
      "+++ \n",
      "@@ -5,7 +5,7 @@\n",
      " AS RETURN",
      " (",
      " with Resources as (",
      "-SELECT schedule_type, task_ID",
      "+SELECT schedule_type, task_ID, ISNULL(subproject_ID,'') SubP",
      " FROM DS06_schedule_resources",
      " WHERE upload_ID = @upload_ID",
      " )",
      "@@ -14,7 +14,8 @@\n",
      " FROM",
      " DS04_schedule S INNER JOIN Resources R ON S.schedule_type = R.schedule_type",
      " AND S.task_ID = R.task_ID",
      "+AND ISNULL(S.subproject_ID,'') = R.SubP",
      " WHERE",
      " upload_id = @upload_ID",
      "-AND TRIM(ISNULL(subtype,'')) <> ''",
      "+AND subtype IN ('SVT', 'ZBA')",
      " )"
    ]
  },
  {
    "UID": "9050282",
    "Original DIQ Name": "fnDIQ_DS05_Logic_IsTaskMissingInDS04",
    "Match Type": "Name matched",
    "Diff": [
      "--- \n",
      "+++ \n",
      "@@ -5,18 +5,17 @@\n",
      " AS RETURN",
      " (",
      " with Tasks as (",
      "-SELECT schedule_type, task_ID",
      "+SELECT schedule_type, task_ID, ISNULL(subproject_ID,'') SubP",
      " FROM DS04_schedule",
      " WHERE upload_ID = @upload_ID",
      " )",
      " SELECT",
      "-*",
      "+L.*",
      " FROM",
      "-DS05_schedule_logic",
      "+DS05_schedule_logic L LEFT OUTER JOIN Tasks T ON L.schedule_type = T.schedule_type",
      "+AND L.task_ID = T.task_ID",
      "+AND ISNULL(L.subproject_ID,'') = ISNULL(T.SubP,'')",
      " WHERE",
      " upload_id = @upload_ID",
      "-AND (",
      "-schedule_type = 'FC' and task_ID NOT IN (SELECT task_ID FROM Tasks WHERE schedule_type = 'FC')",
      "-OR schedule_type = 'BL' and task_ID NOT IN (SELECT task_ID FROM Tasks WHERE schedule_type = 'BL')",
      "+AND T.task_ID IS NULL --missed joins means that a task is missing in DS04 for this piece of logic",
      " )",
      "-)"
    ]
  },
  {
    "UID": "9060285",
    "Original DIQ Name": "fnDIQ_DS06_Res_AreDS03ADollarsMissingResourcePDollars",
    "Match Type": "Name matched",
    "Diff": [
      "--- \n",
      "+++ \n",
      "@@ -5,34 +5,35 @@\n",
      " AS RETURN",
      " (",
      " with CostWBS as (",
      "-SELECT WBS_ID_WP WBS, EOC, SUM(ACWPi_dollars) ACWP",
      "+SELECT WBS_ID_WP WBS, CASE WHEN ISNULL(is_indirect,'') = 'Y' THEN 'Indirect' ELSE EOC END as EOC, SUM(ACWPi_dollars) ACWP",
      " FROM DS03_cost",
      " WHERE upload_ID = @upload_ID",
      "-GROUP BY WBS_ID_WP, EOC",
      "+GROUP BY WBS_ID_WP, CASE WHEN ISNULL(is_indirect,'') = 'Y' THEN 'Indirect' ELSE EOC END",
      " HAVING SUM(ACWPi_dollars) > 0",
      " ), Resources as (",
      "-SELECT task_ID, EOC, SUM(ISNULL(actual_dollars,0)) Performance",
      "+SELECT task_ID, EOC, ISNULL(subproject_ID,'') SubP, SUM(ISNULL(actual_dollars,0)) Performance",
      " FROM DS06_schedule_resources",
      " WHERE upload_ID = @upload_ID AND schedule_type = 'FC'",
      "-GROUP BY task_ID, EOC",
      "-HAVING SUM(ISNULL(actual_dollars,0)) = 0",
      "+GROUP BY task_ID, EOC, ISNULL(subproject_ID,'')",
      " ), ScheduleWBS as (",
      "-SELECT S.WBS_ID WBS, R.EOC",
      "-FROM DS04_schedule S INNER JOIN Resources R ON S.task_ID = R.task_ID",
      "+SELECT S.WBS_ID WBS, R.EOC, R.SubP",
      "+FROM DS04_schedule S INNER JOIN Resources R ON S.task_ID = R.task_ID AND ISNULL(S.subproject_ID,'') = R.SubP",
      " WHERE S.upload_ID = @upload_ID AND S.schedule_type = 'FC'",
      "-GROUP BY S.WBS_ID, R.EOC",
      "+GROUP BY S.WBS_ID, R.EOC, R.SubP",
      "+HAVING SUM(R.Performance) = 0",
      " ), FlagsByWBS as (",
      "-SELECT S.WBS,S.EOC",
      "+SELECT S.WBS, S.EOC, S.SubP",
      " FROM ScheduleWBS S INNER JOIN CostWBS C ON C.EOC = S.EOC AND C.WBS = S.WBS",
      " ), FlagsByTaskID as (",
      "-SELECT S.task_ID, F.EOC",
      "-FROM FlagsByWBS F INNER JOIN DS04_schedule S ON F.WBS = S.WBS_ID",
      "+SELECT S.task_ID, F.EOC, F.SubP",
      "+FROM FlagsByWBS F INNER JOIN DS04_schedule S ON F.WBS = S.WBS_ID AND F.SubP = ISNULL(S.subproject_ID,'')",
      " WHERE S.upload_ID = @upload_ID AND S.schedule_type = 'FC'",
      " )",
      " SELECT",
      " R.*",
      " FROM",
      " DS06_schedule_resources R INNER JOIN FlagsByTaskID F ON R.task_ID = F.task_ID",
      "+AND ISNULL(subproject_ID,'') = F.SubP",
      " AND R.EOC = F.EOC",
      " WHERE",
      " R.upload_id = @upload_ID"
    ]
  },
  {
    "UID": "1040167",
    "Original DIQ Name": "fnDIQ_DS04_Sched_IsDPASDateEarlierThanESDate",
    "Match Type": "Name matched",
    "Diff": [
      "--- \n",
      "+++ \n",
      "@@ -4,14 +4,18 @@\n",
      " RETURNS TABLE",
      " AS RETURN",
      " (",
      "+with BLDPTasks as (",
      "+SELECT task_ID, ES_Date, ISNULL(subproject_ID, '') SubP",
      "+FROM DS04_schedule",
      "+WHERE upload_ID = @upload_ID AND schedule_type = 'BL' AND driving_path = 'Y'",
      "+)",
      " SELECT",
      " F.*",
      " FROM",
      "-DS04_schedule F,",
      "-(SELECT task_ID, ES_Date FROM DS04_schedule WHERE upload_ID = @upload_ID AND schedule_type = 'BL' AND driving_path = 'Y') B",
      "+DS04_schedule F INNER JOIN BLDPTasks B  ON F.task_ID = B.task_ID",
      "+AND ISNULL(F.subproject_ID,'') = B.SubP",
      "+AND F.AS_date < B.ES_date",
      " WHERE",
      " upload_id = @upload_ID",
      "-AND F.task_ID = B.task_ID",
      " AND schedule_type = 'FC'",
      "-AND F.AS_date < B.ES_date",
      " )"
    ]
  },
  {
    "UID": "9010029",
    "Original DIQ Name": "fnDIQ_DS01_WBS_IsSubprojectIDMissingInDS04",
    "Match Type": "Name matched",
    "Diff": [
      "--- \n",
      "+++ \n",
      "@@ -4,13 +4,15 @@\n",
      " RETURNS TABLE",
      " AS RETURN",
      " (",
      "-SELECT",
      "-*",
      "-FROM",
      "-DS01_WBS W",
      "-WHERE",
      "-upload_ID = @upload_ID",
      "-AND type in ('WP','PP','SLPP')",
      "-AND TRIM(ISNULL(subproject_ID,'')) <> ''",
      "-AND subproject_ID NOT IN (SELECT TRIM(ISNULL(subproject_ID,'')) FROM DS04_Schedule WHERE upload_ID = @upload_ID)",
      "+WITH DS04SubPs AS (",
      "+SELECT DISTINCT TRIM(ISNULL(subproject_ID,'')) AS SubP",
      "+FROM DS04_Schedule",
      "+WHERE upload_ID = @upload_ID",
      " )",
      "+SELECT W.*",
      "+FROM DS01_WBS W LEFT JOIN DS04SubPs S ON W.subproject_ID = S.SubP",
      "+WHERE W.upload_ID = @upload_ID",
      "+AND W.type in ('WP','PP','SLPP')",
      "+AND TRIM(ISNULL(W.subproject_ID,'')) <> ''",
      "+AND S.SubP IS NULL",
      "+)"
    ]
  },
  {
    "UID": "1060247",
    "Original DIQ Name": "fnDIQ_DS06_Res_IsResourceNameDuplicated",
    "Match Type": "Name matched",
    "Diff": [
      "--- \n",
      "+++ \n",
      "@@ -4,30 +4,25 @@\n",
      " RETURNS TABLE",
      " AS RETURN",
      " (",
      "-with Flags as (",
      "-SELECT BLName1.resource_ID, BLName1.resource_name, BLName1.schedule_type",
      "-FROM",
      "-(SELECT resource_ID, resource_name, schedule_type FROM DS06_schedule_resources WHERE upload_ID = @upload_ID AND schedule_type = 'BL' GROUP BY schedule_type, resource_ID, resource_name) BLName1,",
      "-(SELECT resource_ID, resource_name, schedule_type FROM DS06_schedule_resources WHERE upload_ID = @upload_ID AND schedule_type = 'BL' GROUP BY schedule_type, resource_ID, resource_name) BLName2",
      "-WHERE",
      "-BLName1.resource_name = BLName2.resource_name",
      "-AND BLName1.resource_ID <> BLName2.resource_ID",
      "+with Resources as (",
      "+SELECT resource_ID, resource_name, schedule_type, ISNULL(subproject_ID,'') SubP",
      "+FROM DS06_schedule_resources",
      "+WHERE upload_ID = @upload_ID",
      "+), BL as (",
      "+SELECT * FROM Resources WHERE schedule_type = 'BL' GROUP BY schedule_type, resource_ID, resource_name, SubP",
      "+), FC as (",
      "+SELECT * FROM Resources WHERE schedule_type = 'FC' GROUP BY schedule_type, resource_ID, resource_name, SubP",
      "+), Flags as (",
      "+SELECT BLName1.*",
      "+FROM BL BLName1 INNER JOIN BL BLName2 ON BLName1.resource_name = BLName2.resource_name AND BLName1.SubP = BLName2.SubP AND BLName1.resource_ID <> BLName2.resource_ID",
      " UNION",
      "-SELECT FCName1.resource_ID, FCName1.resource_name, FCName1.schedule_type",
      "-FROM",
      "-(SELECT resource_ID, resource_name, schedule_type FROM DS06_schedule_resources WHERE upload_ID = @upload_ID AND schedule_type = 'FC' GROUP BY schedule_type, resource_ID, resource_name) FCName1,",
      "-(SELECT resource_ID, resource_name, schedule_type FROM DS06_schedule_resources WHERE upload_ID = @upload_ID AND schedule_type = 'FC' GROUP BY schedule_type, resource_ID, resource_name) FCName2",
      "-WHERE",
      "-FCName1.resource_name = FCName2.resource_name",
      "-AND FCName1.resource_ID <> FCName2.resource_ID",
      "+SELECT FCName1.*",
      "+FROM FC FCName1 INNER JOIN FC FCName2 ON FCName1.resource_name = FCName2.resource_name AND FCName1.SubP = FCName2.SubP AND FCName1.resource_ID <> FCName2.resource_ID",
      " )",
      "-SELECT",
      "-R.*",
      "-FROM",
      "-DS06_schedule_resources R",
      "-INNER JOIN Flags F \tON R.schedule_type = F.schedule_type",
      "+SELECT R.*",
      "+FROM DS06_schedule_resources R \tINNER JOIN Flags F \tON R.schedule_type = F.schedule_type",
      " AND R.resource_ID = F.resource_ID",
      " AND R.resource_name = F.resource_name",
      "-WHERE",
      "-upload_id = @upload_ID",
      "+AND ISNULL(R.subproject_ID,'') = F.SubP",
      "+WHERE upload_id = @upload_ID",
      " )"
    ]
  },
  {
    "UID": "1070270",
    "Original DIQ Name": "fnDIQ_DS07_IPMR_IsEACPMLikelyDollarsGtCBBWithoutOTBOTSDate",
    "Match Type": "Name matched",
    "Diff": [
      "--- \n",
      "+++ \n",
      "@@ -4,12 +4,9 @@\n",
      " RETURNS TABLE",
      " AS RETURN",
      " (",
      "-SELECT",
      "-*",
      "-FROM",
      "-DS07_IPMR_header",
      "-WHERE",
      "-upload_ID = @upload_ID",
      "+SELECT *",
      "+FROM DS07_IPMR_header",
      "+WHERE \tupload_ID = @upload_ID",
      " AND EAC_PM_likely_dollars > CBB_dollars",
      " AND OTB_OTS_date IS NULL",
      " )"
    ]
  },
  {
    "UID": "9060284",
    "Original DIQ Name": "fnDIQ_DS06_Res_ArePDollarsMisalignedWithDS03",
    "Match Type": "Name matched",
    "Diff": [
      "--- \n",
      "+++ \n",
      "@@ -5,27 +5,27 @@\n",
      " AS RETURN",
      " (",
      " with CostWBS as (",
      "-SELECT WBS_ID_WP WBS, EOC, SUM(BCWPi_dollars) BCWP",
      "+SELECT WBS_ID_WP WBS, CASE WHEN ISNULL(is_indirect,'') = 'Y' THEN 'Indirect' ELSE EOC END as EOC, SUM(BCWPi_dollars) BCWP",
      " FROM DS03_cost",
      " WHERE upload_ID = @upload_ID",
      "-GROUP BY WBS_ID_WP, EOC",
      "+GROUP BY WBS_ID_WP, CASE WHEN ISNULL(is_indirect,'') = 'Y' THEN 'Indirect' ELSE EOC END",
      " ), Resources as (",
      "-SELECT task_ID, EOC, SUM(actual_dollars) Performance",
      "+SELECT task_ID, EOC, SUM(actual_dollars) Performance, ISNULL(subproject_ID,'') SubP",
      " FROM DS06_schedule_resources",
      " WHERE upload_ID = @upload_ID AND schedule_type = 'FC'",
      "-GROUP BY task_ID, EOC",
      "+GROUP BY task_ID, EOC, ISNULL(subproject_ID,'')",
      " ), ScheduleWBS as (",
      "-SELECT S.WBS_ID WBS, SUM(R.Performance) Performance, R.EOC",
      "-FROM DS04_schedule S INNER JOIN Resources R ON S.task_ID = R.task_ID",
      "+SELECT S.WBS_ID WBS, SUM(R.Performance) Performance, R.EOC, R.SubP",
      "+FROM DS04_schedule S INNER JOIN Resources R ON S.task_ID = R.task_ID AND ISNULL(S.subproject_ID,'') = R.SubP",
      " WHERE S.upload_ID = @upload_ID AND S.schedule_type = 'FC'",
      "-GROUP BY S.WBS_ID, R.EOC",
      "+GROUP BY S.WBS_ID, R.EOC, R.SubP",
      " ), FlagsByWBS as (",
      "-SELECT S.WBS, S.EOC",
      "+SELECT S.WBS, S.EOC, S.SubP",
      " FROM ScheduleWBS S INNER JOIN CostWBS C ON C.EOC = S.EOC",
      " AND C.WBS = S.WBS",
      " AND C.BCWP <> S.Performance",
      " ), FlagsByTask as (",
      "-SELECT S.task_ID, F.EOC",
      "+SELECT S.task_ID, F.EOC, F.SubP",
      " FROM DS04_schedule S INNER JOIN FlagsByWBS F ON S.WBS_ID = F.WBS",
      " WHERE upload_ID = @upload_ID AND schedule_type = 'FC'",
      " )",
      "@@ -34,6 +34,7 @@\n",
      " FROM",
      " DS06_schedule_resources R INNER JOIN FlagsByTask F \tON R.task_ID = F.task_ID",
      " AND R.EOC = F.EOC",
      "+AND ISNULL(R.subproject_ID,'') = F.SubP",
      " WHERE",
      " R.upload_id = @upload_ID",
      " AND R.schedule_type = 'FC'"
    ]
  },
  {
    "UID": "9040134",
    "Original DIQ Name": "fnDIQ_DS04_Sched_DoesSVTHaveLogic",
    "Match Type": "Name matched",
    "Diff": [
      "--- \n",
      "+++ \n",
      "@@ -5,15 +5,17 @@\n",
      " AS RETURN",
      " (",
      " with Logic as (",
      "-SELECT schedule_type, task_ID",
      "+SELECT schedule_type, task_ID, ISNULL(subproject_ID,'') SubP",
      " FROM DS05_schedule_logic",
      "-WHERE upload_ID = @upload_ID)",
      "+WHERE upload_ID = @upload_ID",
      "+)",
      " SELECT",
      " S.*",
      " FROM",
      " DS04_schedule S INNER JOIN Logic L \tON S.schedule_type = L.schedule_type",
      " AND S.task_ID = L.task_ID",
      "+AND ISNULL(S.subproject_ID,'') = L.SubP",
      " WHERE",
      " upload_id = @upload_ID",
      "-AND ISNULL(subtype,'') = 'SVT'",
      "+AND subtype = 'SVT'",
      " )"
    ]
  },
  {
    "UID": "1040321",
    "Original DIQ Name": "fnDIQ_DS04_Sched_AreCD4DatesMisalignedBtwFCAndBL",
    "Match Type": "Name matched",
    "Diff": [
      "--- \n",
      "+++ \n",
      "@@ -5,20 +5,23 @@\n",
      " AS RETURN",
      " (",
      " with MS190 as (",
      "-SELECT WBS_ID, task_ID, ES_date, EF_date, schedule_type",
      "+SELECT WBS_ID, task_ID, ISNULL(subproject_ID,'') SubP, ES_date, EF_date, schedule_type",
      " FROM DS04_schedule",
      " WHERE upload_ID = @upload_ID AND milestone_level = 190",
      " ),Fails as (",
      "-SELECT F.WBS_ID, F.task_id",
      "+SELECT F.WBS_ID, F.task_id, F.SubP",
      " FROM MS190 F INNER JOIN MS190 B ON F.WBS_ID = B.WBS_ID",
      " AND F.task_ID = B.task_ID",
      "-WHERE\tF.schedule_type = 'FC' AND B.schedule_type = 'BL'",
      "-AND (COALESCE(F.ES_date,F.EF_Date) <> COALESCE(B.ES_date,B.EF_date))",
      "+AND F.SubP = B.SubP",
      "+WHERE",
      "+F.schedule_type = 'FC'",
      "+AND B.schedule_type = 'BL'",
      "+AND (F.ES_date <> B.ES_date OR F.EF_date <> B.EF_date)",
      " )",
      " SELECT",
      " S.*",
      " FROM",
      "-DS04_schedule S INNER JOIN Fails F ON S.task_ID = F.task_ID AND S.WBS_ID = F.WBS_ID",
      "+DS04_schedule S INNER JOIN Fails F ON S.task_ID = F.task_ID AND S.WBS_ID = F.WBS_ID AND ISNULL(S.subproject_ID,'') = F.SubP",
      " WHERE",
      " S.upload_ID = @upload_ID",
      " )"
    ]
  },
  {
    "UID": "9010014",
    "Original DIQ Name": "fnDIQ_DS01_WBS_IsWBSMissingInDS03CA",
    "Match Type": "Name matched",
    "Diff": [
      "--- \n",
      "+++ \n",
      "@@ -4,16 +4,15 @@\n",
      " RETURNS TABLE",
      " AS RETURN",
      " (",
      "-SELECT",
      "-*",
      "-FROM",
      "-DS01_WBS",
      "-WHERE",
      "-upload_ID = @upload_ID",
      "-AND type in ('CA', 'SLPP')",
      "-AND WBS_ID NOT IN (",
      "-SELECT WBS_ID_CA",
      "+WITH DS03 AS (",
      "+SELECT DISTINCT WBS_ID_CA",
      " FROM DS03_cost",
      " WHERE upload_ID = @upload_ID AND (BCWSi_dollars > 0 OR BCWSi_FTEs > 0 OR BCWSi_hours > 0)",
      " )",
      "+SELECT DS01.*",
      "+FROM DS01_WBS AS DS01 LEFT JOIN DS03 ON DS01.WBS_ID = DS03.WBS_ID_CA",
      "+WHERE   DS01.upload_ID = @upload_ID",
      "+AND DS01.type in ('CA', 'SLPP')",
      "+AND DS01.[external] = 'N'",
      "+AND DS03.WBS_ID_CA IS NULL",
      " )"
    ]
  },
  {
    "UID": "1030075",
    "Original DIQ Name": "fnDIQ_DS03_Cost_Is5050BCWSImproperlySpread",
    "Match Type": "Name matched",
    "Diff": [
      "--- \n",
      "+++ \n",
      "@@ -7,37 +7,40 @@\n",
      " with SSpread as (",
      " SELECT",
      " WBS_ID_WP,",
      "-LAG(period_date,1) OVER (PARTITION BY WBS_ID_WP, EOC ORDER BY period_date) AS PrevPeriod,",
      "+LAG(period_date,1) OVER (PARTITION BY WBS_ID_WP, EOC, ISNULL(is_indirect,'') ORDER BY period_date) AS PrevPeriod,",
      " period_date [Period],",
      "-LEAD(period_date,1) OVER (PARTITION BY WBS_ID_WP, EOC ORDER BY period_date) AS NextPeriod,",
      "+LEAD(period_date,1) OVER (PARTITION BY WBS_ID_WP, EOC, ISNULL(is_indirect,'') ORDER BY period_date) AS NextPeriod,",
      " BCWSi_dollars s_dollars,",
      " BCWSi_hours s_hours,",
      " BCWSi_FTEs s_ftes,",
      "-ISNULL(LEAD(BCWSi_dollars,1) OVER (PARTITION BY WBS_ID_WP, EOC ORDER by period_date),0) AS NextS_dollars,",
      "-ISNULL(LAG(BCWPi_dollars,1) OVER (PARTITION BY WBS_ID_WP, EOC ORDER by period_date),0) AS PrevS_dollars,",
      "-ISNULL(LEAD(BCWSi_hours,1) OVER (PARTITION BY WBS_ID_WP, EOC ORDER by period_date),0) AS NextS_hours,",
      "-ISNULL(LAG(BCWPi_hours,1) OVER (PARTITION BY WBS_ID_WP, EOC ORDER by period_date),0) AS PrevS_hours,",
      "-ISNULL(LEAD(BCWSi_ftes,1) OVER (PARTITION BY WBS_ID_WP, EOC ORDER by period_date),0) AS NextS_ftes,",
      "-ISNULL(LAG(BCWPi_ftes,1) OVER (PARTITION BY WBS_ID_WP, EOC ORDER by period_date),0) AS PrevS_ftes,",
      "-EOC",
      "+ISNULL(LEAD(BCWSi_dollars,1) OVER (PARTITION BY WBS_ID_WP, EOC, ISNULL(is_indirect,'') ORDER by period_date),0) AS NextS_dollars,",
      "+ISNULL(LAG(BCWPi_dollars,1) OVER (PARTITION BY WBS_ID_WP, EOC, ISNULL(is_indirect,'') ORDER by period_date),0) AS PrevS_dollars,",
      "+ISNULL(LEAD(BCWSi_hours,1) OVER (PARTITION BY WBS_ID_WP, EOC, ISNULL(is_indirect,'') ORDER by period_date),0) AS NextS_hours,",
      "+ISNULL(LAG(BCWPi_hours,1) OVER (PARTITION BY WBS_ID_WP, EOC, ISNULL(is_indirect,'') ORDER by period_date),0) AS PrevS_hours,",
      "+ISNULL(LEAD(BCWSi_ftes,1) OVER (PARTITION BY WBS_ID_WP, EOC, ISNULL(is_indirect,'') ORDER by period_date),0) AS NextS_ftes,",
      "+ISNULL(LAG(BCWPi_ftes,1) OVER (PARTITION BY WBS_ID_WP, EOC, ISNULL(is_indirect,'') ORDER by period_date),0) AS PrevS_ftes,",
      "+EOC,",
      "+ISNULL(is_indirect,'') IsInd",
      " FROM DS03_cost",
      " WHERE upload_ID = @upload_ID AND EVT = 'E'",
      " ),",
      " Flags as (",
      "-SELECT WBS_ID_WP, [period], EOC",
      "+SELECT WBS_ID_WP, [period], EOC, IsInd",
      " FROM SSpread",
      " WHERE",
      "-(ABS(s_dollars) > 100 OR ABS(s_hours) > 1 OR s_ftes > 0) --Get only rows where BCWSi > 0 (with threshold of $100/1hr)",
      "+(ABS(s_dollars) > 100 OR ABS(s_hours) > 1 OR s_ftes > 0) --Get only rows where |BCWSi| > 100 (threshold of $100/1hr)",
      " AND ((",
      " (ABS(PrevS_dollars) > 100 AND ABS(NextS_dollars) > 100) OR -- Are the prev & next $ amounts both > $100? (Both provided)",
      " (ABS(PrevS_dollars) < 100 AND ABS(NextS_dollars) < 100) -- Are the prev & next $ amounts both < $100? (Both missing)",
      " ) OR (",
      " (ABS(PrevS_hours) > 1 AND ABS(s_hours) > 1) OR -- Are the prev & next hours both > 1? (Both provided)",
      " (ABS(PrevS_hours) < 1 AND ABS(s_hours) < 1) -- Are the prev & next hours both < 1? (Both missing)",
      "-) OR (",
      "+)",
      "+OR (",
      " (PrevS_ftes = 0 AND NextS_ftes = 0) OR --Are prev/next FTEs both = 0?",
      " (PrevS_ftes > 0 AND NextS_ftes > 0) --Are prev/next FTEs both > 0?",
      "-) OR (",
      "+)",
      "+OR (",
      " DATEDIFF(day, PrevPeriod, [period]) >= 45 OR DATEDIFF(day, [period], NextPeriod) >= 45 --Are the prev/next periods > 45 days from the current?",
      " ) OR (",
      " ABS(s_dollars - PrevS_dollars) > 100 OR ABS(s_dollars - NextS_dollars) > 100 OR --Is there more than a $100 delta between current period and prev/next?",
      "@@ -51,7 +54,9 @@\n",
      " DS03_Cost C INNER JOIN Flags F \tON C.WBS_ID_WP = F.WBS_ID_WP",
      " AND C.period_date = F.period",
      " AND C.EOC = F.EOC",
      "+AND ISNULL(C.is_indirect,'') = F.IsInd",
      " WHERE",
      " upload_ID = @upload_ID",
      " AND EVT = 'E'",
      "+AND TRIM(ISNULL(C.WBS_ID_WP,'')) <> ''",
      " )"
    ]
  },
  {
    "UID": "1030088",
    "Original DIQ Name": "fnDIQ_DS03_Cost_IsLaborMissingACWPDollarsHoursOrFTEs",
    "Match Type": "Name matched",
    "Diff": [
      "--- \n",
      "+++ \n",
      "@@ -10,7 +10,9 @@\n",
      " DS03_Cost",
      " WHERE",
      " upload_ID = @upload_ID",
      "-AND EOC = 'Labor'",
      "+AND",
      "+EOC = 'Labor'",
      "+AND ISNULL(is_indirect,'') <> 'Y'",
      " AND (ACWPi_dollars <> 0 OR ACWPi_FTEs <> 0 OR ACWPi_hours <> 0)",
      " AND (ACWPi_dollars = 0 OR ACWPi_FTEs = 0 OR ACWPi_hours = 0)",
      " )"
    ]
  },
  {
    "UID": "9040217",
    "Original DIQ Name": "fnDIQ_DS04_Sched_IsTaskMissingResources",
    "Match Type": "Name matched",
    "Diff": [
      "--- \n",
      "+++ \n",
      "@@ -5,7 +5,7 @@\n",
      " AS RETURN",
      " (",
      " with Resources as (",
      "-SELECT task_ID, schedule_type",
      "+SELECT task_ID, schedule_type, ISNULL(subproject_ID,'') SubP",
      " FROM DS06_schedule_resources",
      " WHERE upload_ID = @upload_ID",
      " )",
      "@@ -14,6 +14,7 @@\n",
      " FROM",
      " DS04_schedule S LEFT OUTER JOIN Resources R ON S.schedule_type = R.schedule_type",
      " AND S.task_ID = R.task_ID",
      "+AND ISNULL(S.subproject_ID,'') = R.SubP",
      " WHERE",
      " S.upload_id = @upload_ID",
      " AND ISNULL(subtype,'') NOT IN ('SVT', 'ZBA')"
    ]
  },
  {
    "UID": "1040192",
    "Original DIQ Name": "fnDIQ_DS04_Sched_IsMSEarlierThanAppStartProj",
    "Match Type": "Name matched",
    "Diff": [
      "--- \n",
      "+++ \n",
      "@@ -5,7 +5,7 @@\n",
      " AS RETURN",
      " (",
      " with MS100 as (",
      "-SELECT ES_Date, schedule_type",
      "+SELECT ES_Date, schedule_type, ISNULL(subproject_ID,'') SubP",
      " FROM DS04_schedule",
      " WHERE upload_ID = @upload_ID AND milestone_level = 100",
      " )",
      "@@ -13,6 +13,7 @@\n",
      " S.*",
      " FROM",
      " DS04_schedule S INNER JOIN MS100 M \tON S.schedule_type = M.schedule_type",
      "+AND ISNULL(S.subproject_ID,'') = M.SubP",
      " AND S.ES_date < M.ES_date",
      " WHERE",
      " upload_id = @upload_ID"
    ]
  },
  {
    "UID": "1030081",
    "Original DIQ Name": "fnDIQ_DS03_Cost_IsBCWSMissing",
    "Match Type": "Name matched",
    "Diff": [
      "--- \n",
      "+++ \n",
      "@@ -10,8 +10,10 @@\n",
      " DS03_Cost",
      " WHERE",
      " upload_ID = @upload_ID",
      "-AND (",
      "+AND ( -- BCWS dollars = 0 or non-indirect labor BSWS FTEs or Hours are missing",
      " BCWSi_dollars = 0 OR",
      "-(EOC = 'Labor' AND (BCWSi_FTEs = 0 OR BCWSi_hours = 0))",
      "+(EOC = 'Labor' AND ISNULL(is_indirect,'') <> 'Y' AND (BCWSi_FTEs = 0 OR BCWSi_hours = 0))",
      " )",
      "+AND NOT (is_indirect = 'Y' AND EOC = 'Indirect' AND ACWPi_dollars > 0)",
      "+AND TRIM(ISNULL(WBS_ID_WP,'')) <> ''",
      " )"
    ]
  },
  {
    "UID": "9140541",
    "Original DIQ Name": "fnDIQ_DS14_HDV_CI_IsEquipMissingDS06SubKOrMatEOCBL",
    "Match Type": "Name matched",
    "Diff": [
      "--- \n",
      "+++ \n",
      "@@ -7,7 +7,7 @@\n",
      " with SubKResources as (",
      " SELECT S.subK_ID",
      " FROM DS13_subK S INNER JOIN DS06_schedule_resources R ON S.task_ID = R.task_ID",
      "-WHERE S.upload_ID = @upload_ID AND R.task_ID = @upload_ID",
      "+WHERE S.upload_ID = @upload_ID AND R.upload_ID = @upload_ID",
      " AND R.schedule_type = 'BL' AND R.EOC IN ('Material','Subcontract')",
      " GROUP BY S.subK_ID",
      " )"
    ]
  },
  {
    "UID": "1200595",
    "Original DIQ Name": "fnDIQ_DS20_Sched_CAL_Excpt_PK",
    "Match Type": "Name matched",
    "Diff": [
      "--- \n",
      "+++ \n",
      "@@ -5,16 +5,17 @@\n",
      " AS RETURN",
      " (",
      " with Dupes as (",
      "-SELECT calendar_name, exception_date",
      "+SELECT calendar_name, ISNULL(subproject_ID,'') SubP, exception_date",
      " FROM DS20_schedule_calendar_exception",
      " WHERE upload_ID = @upload_ID",
      "-GROUP BY calendar_name, exception_date",
      "+GROUP BY calendar_name, ISNULL(subproject_ID,''), exception_date",
      " HAVING COUNT(*) > 1",
      " )",
      " SELECT",
      " S.*",
      " FROM",
      " DS20_schedule_calendar_exception S INNER JOIN Dupes D ON S.calendar_name = D.calendar_name",
      "+AND ISNULL(S.subproject_ID,'') = D.SubP",
      " AND S.exception_date = D.exception_date",
      " WHERE",
      " upload_ID = @upload_ID"
    ]
  },
  {
    "UID": "1020040",
    "Original DIQ Name": "fnDIQ_DS02_OBS_DoesTitleContainOBSID",
    "Match Type": "Name matched",
    "Diff": [
      "--- \n",
      "+++ \n",
      "@@ -10,5 +10,5 @@\n",
      " DS02_OBS",
      " WHERE",
      " upload_ID = @upload_ID",
      "-AND Title like '%' + OBS_ID + '%'",
      "+AND Title COLLATE Latin1_General_BIN like '%' + OBS_ID + '%'",
      " )"
    ]
  },
  {
    "UID": "9010013",
    "Original DIQ Name": "fnDIQ_DS01_WBS_IsWBSMissingInDS03WP",
    "Match Type": "Name matched",
    "Diff": [
      "--- \n",
      "+++ \n",
      "@@ -4,16 +4,15 @@\n",
      " RETURNS TABLE",
      " AS RETURN",
      " (",
      "-SELECT",
      "-*",
      "-FROM",
      "-DS01_WBS",
      "-WHERE",
      "-upload_ID = @upload_ID",
      "-AND type in ('WP', 'PP')",
      "-AND WBS_ID NOT IN (",
      "-SELECT WBS_ID_WP",
      "+WITH DS03WBS AS (",
      "+SELECT DISTINCT WBS_ID_WP WBS",
      " FROM DS03_cost",
      " WHERE upload_ID = @upload_ID AND (BCWSi_dollars > 0 OR BCWSi_FTEs > 0 OR BCWSi_hours > 0)",
      " )",
      "+SELECT W.*",
      "+FROM DS01_WBS AS W LEFT JOIN DS03WBS AS C ON W.WBS_ID = C.WBS",
      "+WHERE   W.upload_ID = @upload_ID",
      "+AND W.type in ('WP', 'PP')",
      "+AND W.[external] = 'N'",
      "+AND C.WBS IS NULL",
      " )"
    ]
  },
  {
    "UID": "9060294",
    "Original DIQ Name": "fnDIQ_DS06_Res_IsEOCComboMisalignedWithDS03",
    "Match Type": "Name matched",
    "Diff": [
      "--- \n",
      "+++ \n",
      "@@ -5,39 +5,41 @@\n",
      " AS RETURN",
      " (",
      " with CostEOCs as (",
      "-SELECT C.WBS, STRING_AGG (C.EOC, ',') WITHIN GROUP (ORDER BY C.EOC) AS EOC",
      "+SELECT C.WBS, EOC",
      " FROM (",
      "-SELECT WBS_ID_WP WBS, EOC",
      "+SELECT WBS_ID_WP WBS, CASE WHEN ISNULL(is_indirect,'') = 'Y' THEN 'Indirect' ELSE EOC END as EOC",
      " FROM DS03_cost",
      " WHERE upload_ID = @upload_ID",
      "-GROUP BY WBS_ID_WP, EOC",
      "+GROUP BY WBS_ID_WP, CASE WHEN ISNULL(is_indirect,'') = 'Y' THEN 'Indirect' ELSE EOC END",
      " ) C",
      "-GROUP BY C.WBS",
      "+GROUP BY C.WBS, C.EOC",
      " ), ScheduleEOCs as (",
      "-SELECT S.WBS, STRING_AGG (S.EOC, ',') WITHIN GROUP (ORDER BY S.EOC) AS EOC",
      "+SELECT S.WBS, SubP, S.EOC",
      " FROM (",
      "-SELECT S.WBS_ID WBS, R.EOC",
      "-FROM DS04_schedule S INNER JOIN DS06_schedule_resources R ON S.task_ID = R.task_ID",
      "-WHERE",
      "-S.upload_ID = @upload_ID",
      "+SELECT S.WBS_ID WBS, ISNULL(R.EOC,'') EOC, ISNULL(S.subproject_ID,'') SubP",
      "+FROM DS04_schedule S INNER JOIN DS06_schedule_resources R ON S.task_ID = R.task_ID AND ISNULL(S.subproject_ID,'') = ISNULL(R.subproject_ID,'')",
      "+WHERE \tS.upload_ID = @upload_ID",
      " AND R.upload_ID = @upload_ID",
      " AND R.schedule_type = 'BL'",
      " AND S.schedule_type = 'BL'",
      "-GROUP BY S.WBS_ID, R.EOC",
      "+GROUP BY S.WBS_ID, R.EOC, ISNULL(S.subproject_ID,'')",
      " ) S",
      "-GROUP BY S.WBS",
      "+GROUP BY S.WBS, SubP, S.EOC",
      " ), FlagsByWBS as (",
      "-SELECT S.WBS",
      "-FROM ScheduleEOCs S INNER JOIN CostEOCs C ON S.WBS = C.WBS AND S.EOC <> C.EOC",
      "+SELECT S.WBS, S.SubP, S.EOC",
      "+FROM ScheduleEOCs S",
      "+WHERE NOT EXISTS (",
      "+SELECT 1 FROM CostEOCs C WHERE S.WBS = C.WBS AND S.EOC = C.EOC",
      "+)",
      " ), FlagsByTask as (",
      "-SELECT S.task_ID",
      "-FROM DS04_schedule S INNER JOIN FlagsByWBS F ON S.WBS_ID = F.WBS",
      "+SELECT S.task_ID, F.SubP, F.EOC",
      "+FROM DS04_schedule S INNER JOIN FlagsByWBS F ON S.WBS_ID = F.WBS AND ISNULL(S.subproject_ID,'') = F.SubP",
      " WHERE upload_ID = @upload_ID AND schedule_type = 'BL'",
      " )",
      " SELECT",
      " R.*",
      " FROM",
      "-DS06_schedule_resources R INNER JOIN FlagsByTask F ON R.task_ID = F.task_ID",
      "+DS06_schedule_resources R INNER JOIN FlagsByTask F ON R.task_ID = F.task_ID AND ISNULL(R.EOC,'') = F.EOC AND ISNULL(R.subproject_ID,'') = F.SubP",
      " WHERE",
      " R.upload_id = @upload_ID",
      " AND R.schedule_type = 'BL'"
    ]
  },
  {
    "UID": "9050280",
    "Original DIQ Name": "fnDIQ_DS05_Logic_IsLagMissingJustification",
    "Match Type": "Name matched",
    "Diff": [
      "--- \n",
      "+++ \n",
      "@@ -7,13 +7,12 @@\n",
      " SELECT",
      " L.*",
      " FROM",
      "-DS05_schedule_logic L,",
      "-DS04_schedule S",
      "+DS05_schedule_logic L INNER JOIN DS04_schedule S ON L.schedule_type = S.schedule_type",
      "+AND L.task_ID = S.task_ID",
      "+AND ISNULL(L.subproject_ID,'') = ISNULL(S.subproject_ID,'')",
      " WHERE",
      " L.upload_id = @upload_ID",
      " AND S.upload_ID = @upload_ID",
      "-AND L.schedule_type = S.schedule_type",
      "-AND L.task_ID = S.task_ID",
      " AND lag_days <> 0",
      "-AND ISNULL(justification_lag,'')=''",
      "+AND TRIM(ISNULL(justification_lag,''))=''",
      " )"
    ]
  },
  {
    "UID": "9060298",
    "Original DIQ Name": "fnDIQ_DS06_Res_AreRemUnitsMisalignedWithDS03BCWRHours",
    "Match Type": "Name matched",
    "Diff": [
      "--- \n",
      "+++ \n",
      "@@ -7,34 +7,33 @@\n",
      " with CostWBS as (",
      " SELECT WBS_ID_WP WBS, SUM(BCWSi_hours) - SUM(BCWPi_hours) BCWR",
      " FROM DS03_cost",
      "-WHERE upload_ID = @upload_ID AND EOC = 'Labor'",
      "+WHERE upload_ID = @upload_ID AND EOC = 'Labor' AND ISNULL(is_indirect,'') <> 'Y'",
      " GROUP BY WBS_ID_WP",
      " ), ScheduleWBS as (",
      "-SELECT S.WBS_ID WBS, SUM(R.RemUnits) RemUnits",
      "+SELECT S.WBS_ID WBS, SubP, SUM(R.RemUnits) RemUnits",
      " FROM",
      " DS04_schedule S INNER JOIN",
      " (",
      "-SELECT task_ID, SUM(remaining_units) RemUnits",
      "+SELECT task_ID, ISNULL(subproject_ID,'') SubP, SUM(remaining_units) RemUnits",
      " FROM DS06_schedule_resources",
      " WHERE upload_ID = @upload_ID AND schedule_type = 'FC' AND (EOC = 'Labor' OR type = 'Labor')",
      "-GROUP BY task_ID",
      "-) R ON S.task_ID = R.task_ID",
      "-WHERE",
      "-S.upload_ID = @upload_ID",
      "+GROUP BY task_ID, ISNULL(subproject_ID,'')",
      "+) R ON S.task_ID = R.task_ID AND ISNULL(S.subproject_ID,'') = SubP",
      "+WHERE\tS.upload_ID = @upload_ID",
      " AND S.schedule_type = 'FC'",
      "-GROUP BY S.WBS_ID",
      "+GROUP BY S.WBS_ID, SubP",
      " ), FlagsByWBS as (",
      "-SELECT S.WBS",
      "+SELECT S.WBS, S.SubP",
      " FROM ScheduleWBS S INNER JOIN CostWBS C ON C.WBS = S.WBS AND C.BCWR <> S.RemUnits",
      " ), FlagsByTask as (",
      "-SELECT S.task_ID",
      "-FROM DS04_schedule S INNER JOIN FlagsByWBS F ON S.WBS_ID = F.WBS",
      "+SELECT S.task_ID, F.SubP",
      "+FROM DS04_schedule S INNER JOIN FlagsByWBS F ON S.WBS_ID = F.WBS AND ISNULL(S.subproject_ID,'') = F.SubP",
      " WHERE upload_ID = @upload_ID AND schedule_type = 'FC'",
      " )",
      " SELECT",
      " R.*",
      " FROM",
      "-DS06_schedule_resources R INNER JOIN FlagsByTask F ON R.task_ID = F.task_ID",
      "+DS06_schedule_resources R INNER JOIN FlagsByTask F ON R.task_ID = F.task_ID AND ISNULL(R.subproject_ID,'') = F.SubP",
      " WHERE",
      " R.upload_id = @upload_ID",
      " AND R.schedule_type = 'FC'"
    ]
  },
  {
    "UID": "9050283",
    "Original DIQ Name": "fnDIQ_DS05_Logic_IsLOESuccessorRelEqToFF",
    "Match Type": "Name matched",
    "Diff": [
      "--- \n",
      "+++ \n",
      "@@ -17,14 +17,8 @@\n",
      " FROM Tasks",
      " WHERE [type] <> 'LOE' AND EVT <> 'A'",
      " )",
      "-SELECT",
      "-L.*",
      "-FROM",
      "-DS05_schedule_logic L INNER JOIN NonLOESucc Succ ON L.schedule_type = Succ.schedule_type",
      "-AND L.task_ID = Succ.task_ID",
      "-INNER JOIN LOEPred Pred   ON L.schedule_type = Pred.schedule_type",
      "-AND L.predecessor_task_ID = Pred.task_ID",
      "-WHERE",
      "-L.upload_ID = @upload_ID",
      "-AND L.type = 'FF'",
      "+SELECT L.*",
      "+FROM DS05_schedule_logic L  INNER JOIN NonLOESucc Succ ON L.schedule_type = Succ.schedule_type AND L.task_ID = Succ.task_ID",
      "+INNER JOIN LOEPred Pred   ON L.schedule_type = Pred.schedule_type AND L.predecessor_task_ID = Pred.task_ID",
      "+WHERE L.upload_ID = @upload_ID AND L.type = 'FF'",
      " )"
    ]
  },
  {
    "UID": "9060289",
    "Original DIQ Name": "fnDIQ_DS06_Res_AreDS03LaborAHoursMissingResourceLaborPUnits",
    "Match Type": "Name matched",
    "Diff": [
      "--- \n",
      "+++ \n",
      "@@ -7,31 +7,32 @@\n",
      " with CostWBS as (",
      " SELECT WBS_ID_WP WBS",
      " FROM DS03_cost",
      "-WHERE upload_ID = @upload_ID AND EOC = 'Labor'",
      "+WHERE upload_ID = @upload_ID AND EOC = 'Labor' AND ISNULL(is_indirect,'') <> 'Y'",
      " GROUP BY WBS_ID_WP",
      " HAVING SUM(ACWPi_hours) > 0",
      " ), Resources as (",
      "-SELECT task_ID, SUM(ISNULL(actual_units,0)) ResLbrUnits",
      "+SELECT task_ID, ISNULL(subproject_ID,'') SubP, SUM(ISNULL(actual_units,0)) ResLbrUnits",
      " FROM DS06_schedule_resources",
      " WHERE upload_ID = @upload_id AND schedule_type = 'FC' AND (EOC = 'Labor' Or [type] = 'Labor')",
      "-GROUP BY task_ID",
      "+GROUP BY task_ID, ISNULL(subproject_ID,'')",
      " ), ScheduleWBS as (",
      "-SELECT S.WBS_ID WBS",
      "-FROM DS04_schedule S LEFT OUTER JOIN Resources R ON S.task_ID = R.task_ID",
      "-WHERE S.upload_ID = @upload_id AND S.schedule_type = 'FC' AND (ResLbrUnits = 0 OR R.task_ID IS NULL)",
      "-GROUP BY S.WBS_ID",
      "+SELECT S.WBS_ID WBS, ISNULL(S.subproject_ID,'') SubP, SUM(ISNULL(ResLbrUnits,0)) LbrUnits",
      "+FROM DS04_schedule S LEFT OUTER JOIN Resources R ON S.task_ID = R.task_ID AND ISNULL(S.subproject_ID,'') = R.SubP",
      "+WHERE S.upload_ID = @upload_id AND S.schedule_type = 'FC'",
      "+GROUP BY S.WBS_ID, ISNULL(S.subproject_ID,'')",
      " ), FlagsByWBS as (",
      "-SELECT S.WBS",
      "+SELECT S.WBS, S.SubP",
      " FROM ScheduleWBS S INNER JOIN CostWBS C ON C.WBS = S.WBS",
      "+WHERE S.LbrUnits = 0",
      " ), FlagsByTaskID as (",
      "-SELECT S.task_ID",
      "-FROM DS04_schedule S INNER JOIN FlagsByWBS F ON S.WBS_ID = F.WBS",
      "+SELECT S.task_ID, F.SubP",
      "+FROM DS04_schedule S INNER JOIN FlagsByWBS F ON S.WBS_ID = F.WBS AND ISNULL(S.subproject_ID,'') = F.SubP",
      " WHERE upload_ID = @upload_ID AND schedule_type = 'FC'",
      " )",
      " SELECT",
      " R.*",
      " FROM",
      "-DS06_schedule_resources R INNER JOIN FlagsByTaskID F ON R.task_ID = F.task_ID",
      "+DS06_schedule_resources R INNER JOIN FlagsByTaskID F ON R.task_ID = F.task_ID AND ISNULL(R.subproject_ID,'') = F.SubP",
      " WHERE",
      " R.upload_id = @upload_ID",
      " AND R.schedule_type = 'FC'"
    ]
  },
  {
    "UID": "1190593",
    "Original DIQ Name": "fnDIQ_DS19_Sched_CAL_Std_PK",
    "Match Type": "Name matched",
    "Diff": [
      "--- \n",
      "+++ \n",
      "@@ -4,17 +4,14 @@\n",
      " RETURNS TABLE",
      " AS RETURN",
      " (",
      "-SELECT",
      "-*",
      "-FROM",
      "-DS19_schedule_calendar_std",
      "-WHERE",
      "-upload_ID = @upload_ID",
      "-AND calendar_name IN (",
      "-SELECT calendar_name",
      "+with Dupes as (",
      "+SELECT calendar_name, ISNULL(subproject_ID, '') SubP",
      " FROM DS19_schedule_calendar_std",
      " WHERE upload_ID = @upload_ID",
      "-GROUP BY calendar_name",
      "+GROUP BY calendar_name, ISNULL(subproject_ID, '')",
      " HAVING COUNT(*) > 1",
      " )",
      "+SELECT std.*",
      "+FROM DS19_schedule_calendar_std std INNER JOIN Dupes d ON std.calendar_name = d.calendar_name AND ISNULL(std.subproject_ID,'') = d.SubP",
      "+WHERE upload_ID = @upload_ID",
      " )"
    ]
  },
  {
    "UID": "9080395",
    "Original DIQ Name": "fnDIQ_DS08_WAD_AreOverheadDollarsMisalignedWithDS03WP",
    "Match Type": "Name matched",
    "Diff": [
      "--- \n",
      "+++ \n",
      "@@ -14,7 +14,7 @@\n",
      " W.*",
      " FROM",
      " DS08_WAD W INNER JOIN OverheadWP C \tON W.WBS_ID_WP = C.WBS_ID_WP",
      "-AND budget_overhead_dollars <> C.BCWSc",
      "+AND budget_indirect_dollars <> C.BCWSc",
      " WHERE",
      " upload_ID = @upload_ID",
      " )"
    ]
  },
  {
    "UID": "9140542",
    "Original DIQ Name": "fnDIQ_DS14_HDV_CI_IsEquipMissingDS06SubKOrMatEOCFC",
    "Match Type": "Name matched",
    "Diff": [
      "--- \n",
      "+++ \n",
      "@@ -7,7 +7,7 @@\n",
      " with SubKResources as (",
      " SELECT S.subK_ID",
      " FROM DS13_subK S INNER JOIN DS06_schedule_resources R ON S.task_ID = R.task_ID",
      "-WHERE S.upload_ID = @upload_ID AND R.task_ID = @upload_ID",
      "+WHERE S.upload_ID = @upload_ID AND R.upload_ID = @upload_ID",
      " AND R.schedule_type = 'FC' AND R.EOC IN ('Material','Subcontract')",
      " GROUP BY S.subK_ID",
      " )"
    ]
  },
  {
    "UID": "1030091",
    "Original DIQ Name": "fnDIQ_DS03_Cost_IsLaborMissingETCDollarsHoursOrFTEs",
    "Match Type": "Name matched",
    "Diff": [
      "--- \n",
      "+++ \n",
      "@@ -11,6 +11,7 @@\n",
      " WHERE",
      " upload_ID = @upload_ID",
      " AND EOC = 'Labor'",
      "+AND ISNULL(is_indirect,'') <> 'Y'",
      " AND (ETCi_dollars <> 0 OR ETCi_FTEs <> 0 OR ETCi_hours <> 0)",
      " AND (ETCi_dollars = 0 OR ETCi_FTEs = 0 OR ETCi_hours = 0)",
      " )"
    ]
  },
  {
    "UID": "9080394",
    "Original DIQ Name": "fnDIQ_DS08_WAD_AreOverheadDollarsMisalignedWithDS03CA",
    "Match Type": "Name matched",
    "Diff": [
      "--- \n",
      "+++ \n",
      "@@ -14,7 +14,7 @@\n",
      " W.*",
      " FROM",
      " DS08_WAD W INNER JOIN OverheadCA C \tON W.WBS_ID = C.WBS_ID_CA",
      "-AND budget_overhead_dollars <> C.BCWSc",
      "+AND budget_indirect_dollars <> C.BCWSc",
      " WHERE",
      " upload_ID = @upload_ID",
      " AND TRIM(ISNULL(W.WBS_ID_WP,'')) = ''"
    ]
  },
  {
    "UID": "1040166",
    "Original DIQ Name": "fnDIQ_DS04_Sched_IsDPAFDateEarlierThanEFDate",
    "Match Type": "Name matched",
    "Diff": [
      "--- \n",
      "+++ \n",
      "@@ -5,7 +5,7 @@\n",
      " AS RETURN",
      " (",
      " with BLDPTask as (",
      "-SELECT task_ID, EF_Date",
      "+SELECT task_ID, EF_Date, ISNULL(subproject_ID,'') SubP",
      " FROM DS04_schedule",
      " WHERE upload_ID = @upload_ID AND schedule_type = 'BL' AND driving_path = 'Y'",
      " )",
      "@@ -13,6 +13,7 @@\n",
      " F.*",
      " FROM",
      " DS04_schedule F INNER JOIN BLDPTask B ON F.task_ID = B.task_ID",
      "+AND ISNULL(F.subproject_ID,'') = B.SubP",
      " AND F.AF_date < B.EF_date",
      " WHERE",
      " F.upload_id = @upload_ID"
    ]
  },
  {
    "UID": "9060293",
    "Original DIQ Name": "fnDIQ_DS06_Res_IsCalendarMissingInDS19",
    "Match Type": "Name matched",
    "Diff": [
      "--- \n",
      "+++ \n",
      "@@ -5,16 +5,13 @@\n",
      " AS RETURN",
      " (",
      " with CALs as (",
      "-SELECT calendar_name",
      "+SELECT calendar_name CName, ISNULL(subproject_ID,'') SubP",
      " FROM DS19_schedule_calendar_std",
      " WHERE upload_ID = @upload_ID",
      " )",
      "-SELECT",
      "-*",
      "-FROM",
      "-DS06_schedule_resources",
      "-WHERE",
      "-upload_id = @upload_ID",
      "-AND calendar_name NOT IN (SELECT calendar_name FROM CALs)",
      "-AND (SELECT COUNT(*) FROM CALs) > 0 --run only if there are any calendars in DS19",
      "+SELECT R.*",
      "+FROM DS06_schedule_resources R LEFT OUTER JOIN CALs C ON R.calendar_name = C.CName AND ISNULL(R.subproject_ID,'') = C.SubP",
      "+WHERE \tupload_id = @upload_ID",
      "+AND C.CName IS NULL",
      "+AND EXISTS (SELECT 1 FROM CALs) --run only if there are any calendars in DS19",
      " )"
    ]
  },
  {
    "UID": "9060300",
    "Original DIQ Name": "fnDIQ_DS06_Res_IsStartDateEarlierThanDS04ESDate",
    "Match Type": "Name matched",
    "Diff": [
      "--- \n",
      "+++ \n",
      "@@ -5,16 +5,14 @@\n",
      " AS RETURN",
      " (",
      " with BLTasks as (",
      "-SELECT task_ID, ES_date",
      "+SELECT task_ID, ISNULL(subproject_ID,'') SubP, ES_date",
      " FROM DS04_schedule",
      " WHERE upload_ID = @upload_ID AND schedule_type = 'BL'",
      " )",
      "-SELECT",
      "-R.*",
      "-FROM",
      "-DS06_schedule_resources R INNER JOIN BLTasks S ON R.task_ID = S.task_ID",
      "-WHERE",
      "-R.upload_id = @upload_ID",
      "+SELECT R.*",
      "+FROM DS06_schedule_resources R INNER JOIN BLTasks S ON R.task_ID = S.task_ID",
      "+AND ISNULL(R.subproject_ID, '') = S.SubP",
      "+AND R.start_date < S.ES_date",
      "+WHERE \tR.upload_id = @upload_ID",
      " AND R.schedule_type = 'BL'",
      "-AND R.start_date < S.ES_date",
      " )"
    ]
  },
  {
    "UID": "9040203",
    "Original DIQ Name": "fnDIQ_DS04_Sched_IsPlannedCompletionAndEndOfPMBDeltaLtEqToUB",
    "Match Type": "Name matched",
    "Diff": [
      "--- \n",
      "+++ \n",
      "@@ -25,5 +25,5 @@\n",
      " upload_id = @upload_ID",
      " AND schedule_type = 'BL'",
      " AND milestone_level IN (170, 175)",
      "-AND (SELECT TOP 1 Delta FROM Delta) <= (SELECT TOP 1 UB FROM UBBgtDays)",
      "+AND (SELECT TOP 1 Delta FROM Delta) <> (SELECT TOP 1 UB FROM UBBgtDays)",
      " )"
    ]
  },
  {
    "UID": "9180591",
    "Original DIQ Name": "fnDIQ_DS18_Sched_EU_IsTaskIDMissingInDS04",
    "Match Type": "Name matched",
    "Diff": [
      "--- \n",
      "+++ \n",
      "@@ -4,11 +4,10 @@\n",
      " RETURNS TABLE",
      " AS RETURN",
      " (",
      "-SELECT",
      "-E.*",
      "-FROM",
      "-DS18_schedule_EU E LEFT OUTER JOIN DS04_schedule S \tON E.task_ID = S.task_ID",
      "+SELECT E.*",
      "+FROM DS18_schedule_EU E LEFT OUTER JOIN DS04_schedule S ON E.task_ID = S.task_ID",
      " AND E.schedule_type = S.schedule_type",
      "+AND ISNULL(E.subproject_ID,'') = ISNULL(S.subproject_ID,'')",
      " WHERE",
      " E.upload_ID = @upload_ID",
      " AND S.upload_ID = @upload_ID"
    ]
  },
  {
    "UID": "1040178",
    "Original DIQ Name": "fnDIQ_DS04_Sched_IsFCTaskMissingInBL",
    "Match Type": "Name matched",
    "Diff": [
      "--- \n",
      "+++ \n",
      "@@ -4,16 +4,17 @@\n",
      " RETURNS TABLE",
      " AS RETURN",
      " (",
      "-SELECT",
      "-*",
      "-FROM",
      "-DS04_schedule",
      "-WHERE",
      "-upload_id = @upload_ID",
      "-AND schedule_type = 'FC'",
      "-AND task_ID NOT IN (",
      "-SELECT task_ID",
      "+with BLTasks as (",
      "+SELECT task_ID, ISNULL(subproject_ID,'') SubP",
      " FROM DS04_schedule",
      " WHERE upload_ID = @upload_ID AND schedule_type = 'BL'",
      " )",
      "+SELECT",
      "+F.*",
      "+FROM",
      "+DS04_schedule F LEFT OUTER JOIN BLTasks B ON F.task_ID = B.task_ID AND ISNULL(F.subproject_ID,'') = B.SubP",
      "+WHERE",
      "+upload_id = @upload_ID",
      "+AND schedule_type = 'FC' -- Forecast Tasks",
      "+AND B.task_ID IS NULL --Any missed joins fail",
      " )"
    ]
  },
  {
    "UID": "9080421",
    "Original DIQ Name": "fnDIQ_DS08_WAD_IsOverheadBudgetMissingInDS03CA",
    "Match Type": "Name matched",
    "Diff": [
      "--- \n",
      "+++ \n",
      "@@ -22,5 +22,5 @@\n",
      " WHERE",
      " upload_ID = @upload_ID",
      " AND TRIM(ISNULL(W.WBS_ID_WP,'')) = ''",
      "-AND budget_overhead_dollars <> 0",
      "+AND budget_indirect_dollars <> 0",
      " )"
    ]
  },
  {
    "UID": "9060290",
    "Original DIQ Name": "fnDIQ_DS06_Res_AreSDollarsMisalignedWithDS03SDollars",
    "Match Type": "Name matched",
    "Diff": [
      "--- \n",
      "+++ \n",
      "@@ -5,37 +5,33 @@\n",
      " AS RETURN",
      " (",
      " with CostWBS as (",
      "-SELECT WBS_ID_WP WBS, EOC, SUM(BCWSi_dollars) DB",
      "+SELECT WBS_ID_WP WBS, CASE WHEN ISNULL(is_indirect,'') = 'Y' THEN 'Indirect' ELSE EOC END as EOC, SUM(BCWSi_dollars) DB",
      " FROM DS03_cost",
      " WHERE upload_ID = @upload_ID",
      "-GROUP BY WBS_ID_WP, EOC",
      "+GROUP BY WBS_ID_WP, CASE WHEN ISNULL(is_indirect,'') = 'Y' THEN 'Indirect' ELSE EOC END",
      " ), ScheduleWBS as (",
      "-SELECT",
      "-S.WBS_ID WBS,",
      "-R.EOC,",
      "-SUM(R.budget_dollars) Budget",
      "-FROM",
      "-DS04_schedule S INNER JOIN DS06_schedule_resources R ON S.task_ID = R.task_ID",
      "-WHERE",
      "-S.upload_ID = @upload_ID",
      "+SELECT S.WBS_ID WBS, R.EOC, ISNULL(S.subproject_ID,'') SubP, SUM(R.budget_dollars) Budget",
      "+FROM \tDS04_schedule S INNER JOIN DS06_schedule_resources R ON S.task_ID = R.task_ID AND ISNULL(S.task_ID,'') = ISNULL(R.task_ID,'') AND ISNULL(S.subproject_ID,'') = ISNULL(R.subproject_ID,'')",
      "+WHERE \tS.upload_ID = @upload_ID",
      " AND R.upload_ID = @upload_ID",
      " AND R.schedule_type = 'BL'",
      " AND S.schedule_type = 'BL'",
      "-GROUP BY S.WBS_ID, R.EOC",
      "+GROUP BY S.WBS_ID, R.EOC, ISNULL(S.subproject_ID,'')",
      " ), FlagsByWBS as (",
      "-SELECT S.WBS, S.EOC",
      "+SELECT S.WBS, S.EOC, S.SubP",
      " FROM ScheduleWBS S INNER JOIN CostWBS C ON C.WBS = S.WBS",
      " AND C.EOC = S.EOC",
      " AND C.DB <> S.Budget",
      " ), FlagsByTask as (",
      "-SELECT S.task_ID, F.EOC",
      "-FROM DS04_schedule S INNER JOIN FlagsByWBS F ON S.WBS_ID = F.WBS",
      "+SELECT S.task_ID, F.EOC, F.SubP",
      "+FROM DS04_schedule S INNER JOIN FlagsByWBS F ON S.WBS_ID = F.WBS AND ISNULL(S.subproject_ID,'') = F.SubP",
      " WHERE upload_ID = @upload_ID AND schedule_type = 'BL'",
      " )",
      " SELECT",
      " R.*",
      " FROM",
      " DS06_schedule_resources R INNER JOIN FlagsByTask F \tON R.task_ID = F.task_ID",
      "+AND ISNULL(R.subproject_ID,'') = F.SubP",
      " AND R.EOC = F.EOC",
      " WHERE",
      " R.upload_id = @upload_ID"
    ]
  },
  {
    "UID": "9170579",
    "Original DIQ Name": "fnDIQ_DS17_WBS_EU_IsWBSAndEOCComboNotInDS03",
    "Match Type": "Name matched",
    "Diff": [
      "--- \n",
      "+++ \n",
      "@@ -5,10 +5,10 @@\n",
      " AS RETURN",
      " (",
      " with CostWBS as (",
      "-SELECT CONCAT(WBS_ID_WP,'-', EOC) WBSEOC",
      "+SELECT CONCAT(WBS_ID_WP,'-', CASE WHEN ISNULL(is_indirect,'') = 'Y' THEN 'Indirect' ELSE EOC END) WBSEOC",
      " FROM DS03_cost",
      " WHERE upload_ID = @upload_ID AND TRIM(ISNULL(WBS_ID_WP,'')) <> ''",
      "-GROUP BY CONCAT(WBS_ID_WP,'-', EOC)",
      "+GROUP BY CONCAT(WBS_ID_WP,'-', CASE WHEN ISNULL(is_indirect,'') = 'Y' THEN 'Indirect' ELSE EOC END)",
      " )",
      " SELECT",
      " *"
    ]
  },
  {
    "UID": "1080404",
    "Original DIQ Name": "fnDIQ_DS08_WAD_IsBudgetNegativeOrMissing",
    "Match Type": "Name matched",
    "Diff": [
      "--- \n",
      "+++ \n",
      "@@ -14,6 +14,6 @@\n",
      " AND budget_labor_hours <= 0",
      " AND budget_material_dollars <= 0",
      " AND budget_ODC_dollars <= 0",
      "-AND budget_overhead_dollars <= 0",
      "+AND budget_indirect_dollars <= 0",
      " AND budget_subcontract_dollars <= 0",
      " )"
    ]
  },
  {
    "UID": "1060240",
    "Original DIQ Name": "fnDIQ_DS06_Res_IsOverheadUsedUnevenly",
    "Match Type": "Name matched",
    "Diff": [
      "--- \n",
      "+++ \n",
      "@@ -7,7 +7,7 @@\n",
      " with Ovhd as (",
      " SELECT task_ID, schedule_type",
      " FROM DS06_schedule_resources",
      "-WHERE upload_ID = @upload_ID AND EOC = 'Overhead'",
      "+WHERE upload_ID = @upload_ID AND EOC = 'Indirect'",
      " )",
      " SELECT",
      " *"
    ]
  },
  {
    "UID": "9050281",
    "Original DIQ Name": "fnDIQ_DS05_Logic_IsPredMissingInDS04",
    "Match Type": "Name matched",
    "Diff": [
      "--- \n",
      "+++ \n",
      "@@ -5,18 +5,13 @@\n",
      " AS RETURN",
      " (",
      " with Tasks as (",
      "-SELECT schedule_type, task_ID",
      "+SELECT schedule_type, task_ID, ISNULL(subproject_ID,'') SubP",
      " FROM DS04_schedule",
      " WHERE upload_id = @upload_ID",
      " )",
      "-SELECT",
      "-*",
      "-FROM",
      "-DS05_schedule_logic",
      "-WHERE",
      "-upload_id = @upload_ID",
      "-AND (",
      "-schedule_type = 'FC' AND predecessor_task_ID NOT IN (SELECT task_ID FROM Tasks WHERE schedule_type = 'FC')",
      "-OR schedule_type = 'BL' AND predecessor_task_ID NOT IN (SELECT task_ID FROM Tasks WHERE schedule_type = 'BL')",
      "+SELECT L.*",
      "+FROM DS05_schedule_logic L LEFT OUTER JOIN Tasks T \tON L.schedule_type = T.schedule_type",
      "+AND L.predecessor_task_ID = T.task_ID",
      "+AND ISNULL(L.predecessor_subproject_ID,T.SubP) = T.SubP",
      "+WHERE upload_id = @upload_ID AND T.task_ID IS NULL --any missed join is an error",
      " )",
      "-)"
    ]
  },
  {
    "UID": "9080422",
    "Original DIQ Name": "fnDIQ_DS08_WAD_IsOverheadBudgetMissingInDS03WP",
    "Match Type": "Name matched",
    "Diff": [
      "--- \n",
      "+++ \n",
      "@@ -21,5 +21,5 @@\n",
      " DS08_WAD W INNER JOIN NonOverheadWP C ON W.WBS_ID_WP = C.WBS_ID_WP",
      " WHERE",
      " upload_ID = @upload_ID",
      "-AND budget_overhead_dollars <> 0",
      "+AND budget_indirect_dollars <> 0",
      " )"
    ]
  },
  {
    "UID": "9030324",
    "Original DIQ Name": "fnDIQ_DS03_Cost_IsEVTMisalignedWithDS08",
    "Match Type": "Name matched",
    "Diff": [
      "--- \n",
      "+++ \n",
      "@@ -24,7 +24,7 @@\n",
      " SELECT",
      " W.WBS_ID_WP,",
      " CASE",
      "-WHEN EVT IN ('B', 'D', 'E', 'F', 'G', 'H', 'L', 'N', 'O', 'P') THEN 'Discrete'",
      "+WHEN EVT IN ('B', 'C', 'D', 'E', 'F', 'G', 'H', 'L', 'N', 'O', 'P') THEN 'Discrete'",
      " WHEN EVT = 'A' THEN 'LOE'",
      " WHEN EVT IN ('J', 'M') THEN 'Apportioned'",
      " WHEN EVT = 'K' THEN 'PP'"
    ]
  },
  {
    "UID": "9060291",
    "Original DIQ Name": "fnDIQ_DS06_Res_AreLaborSUnitsMisalignedWithDS03LaborSHours",
    "Match Type": "Name matched",
    "Diff": [
      "--- \n",
      "+++ \n",
      "@@ -7,33 +7,30 @@\n",
      " with CostWBS as (",
      " SELECT WBS_ID_WP WBS, SUM(BCWSi_hours) DB",
      " FROM DS03_cost",
      "-WHERE upload_ID = @upload_ID AND EOC = 'Labor'",
      "+WHERE upload_ID = @upload_ID AND EOC = 'Labor' AND ISNULL(is_indirect,'') <> 'Y'",
      " GROUP BY WBS_ID_WP",
      " ), ScheduleWBS as (",
      "-SELECT",
      "-S.WBS_ID WBS,",
      "-SUM(R.budget_units) Budget",
      "-FROM",
      "-DS04_schedule S INNER JOIN DS06_schedule_resources R ON S.task_ID = R.task_ID",
      "+SELECT S.WBS_ID WBS, ISNULL(S.subproject_ID,'') SubP, SUM(R.budget_units) Budget",
      "+FROM  DS04_schedule S INNER JOIN DS06_schedule_resources R ON S.task_ID = R.task_ID AND ISNULL(S.subproject_ID,'') = ISNULL(R.subproject_ID,'')",
      " WHERE",
      " S.upload_ID = @upload_ID",
      " AND R.upload_ID = @upload_ID",
      " AND R.schedule_type = 'BL'",
      " AND S.schedule_type = 'BL'",
      " AND (R.EOC = 'Labor' OR R.[type] = 'Labor')",
      "-GROUP BY S.WBS_ID",
      "+GROUP BY S.WBS_ID, ISNULL(S.subproject_ID,'')",
      " ), FlagsByWBS as (",
      "-SELECT S.WBS",
      "+SELECT S.WBS, S.SubP",
      " FROM ScheduleWBS S INNER JOIN CostWBS C ON C.WBS = S.WBS AND C.DB <> S.Budget",
      " ), FlagsByTask as (",
      "-SELECT S.task_ID",
      "-FROM DS04_schedule S INNER JOIN FlagsByWBS F ON S.WBS_ID = F.WBS",
      "+SELECT S.task_ID, F.SubP",
      "+FROM DS04_schedule S INNER JOIN FlagsByWBS F ON S.WBS_ID = F.WBS AND ISNULL(S.subproject_ID,'') = F.SubP",
      " WHERE upload_ID = @upload_ID AND schedule_type = 'BL'",
      " )",
      " SELECT",
      " R.*",
      " FROM",
      "-DS06_schedule_resources R INNER JOIN FlagsByTask F ON R.task_ID = F.task_ID",
      "+DS06_schedule_resources R INNER JOIN FlagsByTask F ON R.task_ID = F.task_ID AND ISNULL(R.subproject_ID,'') = F.SubP",
      " WHERE",
      " R.upload_id = @upload_ID",
      " AND R.schedule_type = 'BL'"
    ]
  },
  {
    "UID": "9060288",
    "Original DIQ Name": "fnDIQ_DS06_Res_AreLaborPUnitsMissingDS03LaborAHours",
    "Match Type": "Name matched",
    "Diff": [
      "--- \n",
      "+++ \n",
      "@@ -10,29 +10,30 @@\n",
      " WHERE upload_ID = @upload_ID AND EOC = 'Labor'",
      " GROUP BY WBS_ID_WP",
      " ), ScheduleWBS as (",
      "-SELECT S.WBS_ID WBS",
      "+SELECT S.WBS_ID WBS, ISNULL(S.subproject_ID,'') SubP",
      " FROM DS04_schedule S INNER JOIN DS06_schedule_resources R ON S.task_ID = R.task_ID",
      "+AND ISNULL(S.subproject_ID,'') = ISNULL(R.subproject_ID,'')",
      " WHERE",
      " S.upload_ID = @upload_ID",
      " AND R.upload_ID = @upload_ID",
      " AND R.schedule_type = 'FC'",
      " AND S.schedule_type = 'FC'",
      " AND (R.EOC = 'Labor' Or R.[type] = 'Labor')",
      "-GROUP BY S.WBS_ID",
      "+GROUP BY S.WBS_ID, ISNULL(S.subproject_ID,'')",
      " HAVING SUM(R.actual_units) > 0",
      " ), FlagsByWBS as (",
      "-SELECT S.WBS",
      "+SELECT S.WBS, SubP",
      " FROM ScheduleWBS S LEFT OUTER JOIN CostWBS C ON S.WBS = C.WBS",
      " WHERE C.AHours = 0 OR C.WBS IS NULL",
      " ), FlagsByTask as (",
      "-SELECT S.task_ID",
      "-FROM DS04_schedule S INNER JOIN FlagsByWBS F ON S.WBS_ID = F.WBS",
      "+SELECT S.task_ID, F.SubP",
      "+FROM DS04_schedule S INNER JOIN FlagsByWBS F ON S.WBS_ID = F.WBS AND ISNULL(S.subproject_ID,'') = F.SubP",
      " WHERE upload_ID = @upload_ID AND schedule_type = 'FC'",
      " )",
      " SELECT",
      " R.*",
      " FROM",
      "-DS06_schedule_resources R INNER JOIN FlagsByTask F ON R.task_ID = F.task_ID",
      "+DS06_schedule_resources R INNER JOIN FlagsByTask F ON R.task_ID = F.task_ID AND ISNULL(R.subproject_ID,'') = F.SubP",
      " WHERE",
      " R.upload_id = @upload_ID",
      " AND R.schedule_type = 'FC'"
    ]
  },
  {
    "UID": "1040177",
    "Original DIQ Name": "fnDIQ_DS04_Sched_IsEVTMisalignedBtwBLAndFC",
    "Match Type": "Name matched",
    "Diff": [
      "--- \n",
      "+++ \n",
      "@@ -5,19 +5,18 @@\n",
      " AS RETURN",
      " (",
      " with Tasks as (",
      "-SELECT schedule_type, task_ID, EVT",
      "+SELECT schedule_type, task_ID, ISNULL(EVT,'') EVT, ISNULL(subproject_ID,'') SubP",
      " FROM DS04_schedule",
      " WHERE upload_ID = @upload_ID",
      " ), Trips as (",
      "-SELECT F.Task_ID",
      "-FROM Tasks F INNER JOIN Tasks B ON F.task_ID = B.task_ID AND F.EVT <> B.EVT",
      "+SELECT F.Task_ID, F.SubP",
      "+FROM Tasks F INNER JOIN Tasks B ON F.task_ID = B.task_ID AND F.SubP = B.SubP AND F.EVT <> B.EVT",
      " WHERE F.schedule_type = 'FC' AND B.schedule_type = 'BL'",
      " )",
      " SELECT",
      "-*",
      "+S.*",
      " FROM",
      "-DS04_schedule",
      "+DS04_schedule S INNER JOIN Trips T ON S.task_ID = T.task_ID AND ISNULL(S.subproject_ID,'') = T.SubP",
      " WHERE",
      " upload_id = @upload_ID",
      "-AND task_ID IN (SELECT task_ID FROM Trips)",
      " )"
    ]
  },
  {
    "UID": "9030068",
    "Original DIQ Name": "fnDIQ_DS03_Cost_DoesPPStartInFourToSixMonths",
    "New DIQ Name": "fnDIQ_DS03_Cost_DoesPPStartInThreeToSixMonths",
    "Match Type": "UID (Name changed)",
    "Diff": [
      "--- \n",
      "+++ \n",
      "@@ -1,4 +1,4 @@\n",
      "-CREATE FUNCTION [dbo].[fnDIQ_DS03_Cost_DoesPPStartInFourToSixMonths] (",
      "+CREATE FUNCTION [dbo].[fnDIQ_DS03_Cost_DoesPPStartInThreeToSixMonths] (",
      " @upload_id int = 0",
      " )",
      " RETURNS TABLE"
    ]
  }
]
